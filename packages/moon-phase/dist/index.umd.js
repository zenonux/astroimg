(function(Xe,vt){typeof exports=="object"&&typeof module<"u"?vt(exports):typeof define=="function"&&define.amd?define(["exports"],vt):(Xe=typeof globalThis<"u"?globalThis:Xe||self,vt(Xe.Analytics={}))})(this,function(Xe){"use strict";let vt,s={};function $(e){if(!e)return!1;let t=Object.prototype.toString.call(e);return t=="[object Function]"||t=="[object AsyncFunction]"}function pe(){return Date.now&&$(Date.now)?Date.now():new Date().getTime()}s.DEFAULT_SEND_TYPE="image",(function(){let e={function:!0,object:!0},t=e[typeof window]&&window||this,r=t.JSON,i=t.JSON3,n=!1;var a=function l(u,p){u||(u=new t.Object),p||(p=new t.Object);let b=u.Number||t.Number,w=u.String||t.String,L=u.Object||t.Object,B=u.Date||t.Date,ke=u.SyntaxError||t.SyntaxError,q=u.TypeError||t.TypeError,He=u.Math||t.Math,yt=u.JSON||t.JSON;if(typeof yt=="object"&&yt)return p.stringify=yt.stringify,p.parse=yt.parse,p.runInContext=l,p;let ye,ua=L.prototype,Pe=ua.toString,hr=ua.hasOwnProperty;function nt(ve,se){try{ve()}catch{se&&se()}}let Je=new B(-0xc782b5b800cec);function Z(ve){if(Z[ve]!=null)return Z[ve];let se;if(ve=="bug-string-char-index")se=!1;else if(ve=="json")se=Z("json-stringify")&&Z("date-serialization")&&Z("json-parse");else if(ve=="date-serialization"){if(se=Z("json-stringify")&&Je){var f=p.stringify;nt(()=>{se=f(new B(-864e13))=='"-271821-04-20T00:00:00.000Z"'&&f(new B(864e13))=='"+275760-09-13T00:00:00.000Z"'&&f(new B(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&f(new B(-1))=='"1969-12-31T23:59:59.999Z"'})}}else{let H,Ae='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if(ve=="json-stringify"){let x=typeof(f=p.stringify)=="function";x&&((H=function(){return 1}).toJSON=H,nt(()=>{x=f(0)==="0"&&f(new b)==="0"&&f(new w)=='""'&&f(Pe)===ye&&f(ye)===ye&&f()===ye&&f(H)==="1"&&f([H])=="[1]"&&f([ye])=="[null]"&&f(null)=="null"&&f([ye,Pe,null])=="[null,null,null]"&&f({a:[H,!0,!1,null,`\0\b
\f\r	`]})==Ae&&f(null,H)==="1"&&f([1,2],null,1)==`[
 1,
 2
]`},()=>{x=!1})),se=x}if(ve=="json-parse"){let x,E=p.parse;typeof E=="function"&&nt(()=>{E("0")!==0||E(!1)||(H=E(Ae),(x=H.a.length==5&&H.a[0]===1)&&(nt(()=>{x=!E('"	"')}),x&&nt(()=>{x=E("01")!==1}),x&&nt(()=>{x=E("1.")!==1})))},()=>{x=!1}),se=x}}return Z[ve]=!!se}if(nt(()=>{Je=Je.getUTCFullYear()==-109252&&Je.getUTCMonth()===0&&Je.getUTCDate()===1&&Je.getUTCHours()==10&&Je.getUTCMinutes()==37&&Je.getUTCSeconds()==6&&Je.getUTCMilliseconds()==708}),Z["bug-string-char-index"]=Z["date-serialization"]=Z.json=Z["json-stringify"]=Z["json-parse"]=null,!Z("json")){let ve=Z("bug-string-char-index"),se=function(f,H){let Ae,x,E,N=0;for(E in(Ae=function(){this.valueOf=0}).prototype.valueOf=0,x=new Ae)hr.call(x,E)&&N++;return Ae=x=null,N?se=function(U,O){let _,S,F=Pe.call(U)=="[object Function]";for(_ in U)F&&_=="prototype"||!hr.call(U,_)||(S=_==="constructor")||O(_);(S||hr.call(U,_="constructor"))&&O(_)}:(x=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],se=function(U,O){let _,S,F=Pe.call(U)=="[object Function]",R=!F&&typeof U.constructor!="function"&&e[typeof U.hasOwnProperty]&&U.hasOwnProperty||hr;for(_ in U)F&&_=="prototype"||!R.call(U,_)||O(_);for(S=x.length;_=x[--S];)R.call(U,_)&&O(_)}),se(f,H)};if(!Z("json-stringify")&&!Z("date-serialization")){let f={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},H=function(x,E){return`000000${E||0}`.slice(-x)},Ae=function(x){let E,N,U,O,_,S,F,R,v;if(Je)E=function(y){N=y.getUTCFullYear(),U=y.getUTCMonth(),O=y.getUTCDate(),S=y.getUTCHours(),F=y.getUTCMinutes(),R=y.getUTCSeconds(),v=y.getUTCMilliseconds()};else{let y=He.floor,C=[0,31,59,90,120,151,181,212,243,273,304,334],be=function(Fe,de){return C[de]+365*(Fe-1970)+y((Fe-1969+(de=+(de>1)))/4)-y((Fe-1901+de)/100)+y((Fe-1601+de)/400)};E=function(Fe){for(O=y(Fe/864e5),N=y(O/365.2425)+1970-1;be(N+1,0)<=O;N++);for(U=y((O-be(N,0))/30.42);be(N,U+1)<=O;U++);O=1+O-be(N,U),S=y((_=(Fe%864e5+864e5)%864e5)/36e5)%24,F=y(_/6e4)%60,R=y(_/1e3)%60,v=_%1e3}}return(Ae=function(y){return y>-1/0&&y<1/0?(E(y),y=`${N<=0||N>=1e4?(N<0?"-":"+")+H(6,N<0?-N:N):H(4,N)}-${H(2,U+1)}-${H(2,O)}T${H(2,S)}:${H(2,F)}:${H(2,R)}.${H(3,v)}Z`,N=U=O=S=F=R=v=null):y=null,y})(x)};if(Z("json-stringify")&&!Z("date-serialization")){let x=function(N){return Ae(this)},E=p.stringify;p.stringify=function(N,U,O){let _=B.prototype.toJSON;B.prototype.toJSON=x;let S=E(N,U,O);return B.prototype.toJSON=_,S}}else{let x=function(O){let _=O.charCodeAt(0);return f[_]||`\\u00${H(2,_.toString(16))}`},E=/[\x00-\x1F\x22\x5C]/g,N=function(O){return E.lastIndex=0,`"${E.test(O)?O.replace(E,x):O}"`},U=function(O,_,S,F,R,v,y){let C,be,Fe,de,li,mr,Wt,ui,ci;if(nt(()=>{C=_[O]}),typeof C=="object"&&C&&(C.getUTCFullYear&&Pe.call(C)=="[object Date]"&&C.toJSON===B.prototype.toJSON?C=Ae(C):typeof C.toJSON=="function"&&(C=C.toJSON(O))),S&&(C=S.call(_,O,C)),C==ye)return C===ye?C:"null";switch((be=typeof C)=="object"&&(Fe=Pe.call(C)),Fe||be){case"boolean":case"[object Boolean]":return`${C}`;case"number":case"[object Number]":return C>-1/0&&C<1/0?`${C}`:"null";case"string":case"[object String]":return N(`${C}`)}if(typeof C=="object"){for(Wt=y.length;Wt--;)if(y[Wt]===C)throw q();if(y.push(C),de=[],ui=v,v+=R,Fe=="[object Array]"){for(mr=0,Wt=C.length;mr<Wt;mr++)li=U(mr,C,S,F,R,v,y),de.push(li===ye?"null":li);ci=de.length?R?`[
${v}${de.join(`,
${v}`)}
${ui}]`:`[${de.join(",")}]`:"[]"}else se(F||C,da=>{let pa=U(da,C,S,F,R,v,y);pa!==ye&&de.push(`${N(da)}:${R?" ":""}${pa}`)}),ci=de.length?R?`{
${v}${de.join(`,
${v}`)}
${ui}}`:`{${de.join(",")}}`:"{}";return y.pop(),ci}};p.stringify=function(O,_,S){let F,R,v,y;if(e[typeof _]&&_){if((y=Pe.call(_))=="[object Function]")R=_;else if(y=="[object Array]"){v={};for(var C,be=0,Fe=_.length;be<Fe;)C=_[be++],(y=Pe.call(C))!="[object String]"&&y!="[object Number]"||(v[C]=1)}}if(S)if((y=Pe.call(S))=="[object Number]"){if((S-=S%1)>0)for(S>10&&(S=10),F="";F.length<S;)F+=" "}else y=="[object String]"&&(F=S.length<=10?S:S.slice(0,10));return U("",((C={})[""]=O,C),R,v,F,"",[])}}}if(!Z("json-parse")){let f,H,Ae=w.fromCharCode,x={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:`
`,102:"\f",114:"\r"},E=function(){throw f=H=null,ke()},N=function(){for(var _,S,F,R,v,y=H,C=y.length;f<C;)switch(v=y.charCodeAt(f)){case 9:case 10:case 13:case 32:f++;break;case 123:case 125:case 91:case 93:case 58:case 44:return _=ve?y.charAt(f):y[f],f++,_;case 34:for(_="@",f++;f<C;)if((v=y.charCodeAt(f))<32)E();else if(v==92)switch(v=y.charCodeAt(++f)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:_+=x[v],f++;break;case 117:for(S=++f,F=f+4;f<F;f++)(v=y.charCodeAt(f))>=48&&v<=57||v>=97&&v<=102||v>=65&&v<=70||E();_+=Ae(`0x${y.slice(S,f)}`);break;default:E()}else{if(v==34)break;for(v=y.charCodeAt(f),S=f;v>=32&&v!=92&&v!=34;)v=y.charCodeAt(++f);_+=y.slice(S,f)}if(y.charCodeAt(f)==34)return f++,_;E();default:if(S=f,v==45&&(R=!0,v=y.charCodeAt(++f)),v>=48&&v<=57){for(v==48&&(v=y.charCodeAt(f+1))>=48&&v<=57&&E(),R=!1;f<C&&(v=y.charCodeAt(f))>=48&&v<=57;f++);if(y.charCodeAt(f)==46){for(F=++f;F<C&&!((v=y.charCodeAt(F))<48||v>57);F++);F==f&&E(),f=F}if((v=y.charCodeAt(f))==101||v==69){for((v=y.charCodeAt(++f))!=43&&v!=45||f++,F=f;F<C&&!((v=y.charCodeAt(F))<48||v>57);F++);F==f&&E(),f=F}return+y.slice(S,f)}R&&E();var be=y.slice(f,f+4);if(be=="true")return f+=4,!0;if(be=="fals"&&y.charCodeAt(f+4)==101)return f+=5,!1;if(be=="null")return f+=4,null;E()}return"$"},U=function(_){let S,F;if(_=="$"&&E(),typeof _=="string"){if((ve?_.charAt(0):_[0])=="@")return _.slice(1);if(_=="["){for(S=[];(_=N())!="]";)F?_==","?(_=N())=="]"&&E():E():F=!0,_==","&&E(),S.push(U(_));return S}if(_=="{"){for(S={};(_=N())!="}";)F?_==","?(_=N())=="}"&&E():E():F=!0,_!=","&&typeof _=="string"&&(ve?_.charAt(0):_[0])=="@"&&N()==":"||E(),S[_.slice(1)]=U(N());return S}E()}return _},O=function(_,S,F){let R=ca(_,S,F);R===ye?delete _[S]:_[S]=R};var ca=function(_,S,F){let R,v=_[S];if(typeof v=="object"&&v)if(Pe.call(v)=="[object Array]")for(R=v.length;R--;)O(Pe,se,v);else se(v,y=>{O(v,y,F)});return F.call(_,S,v)};p.parse=function(_,S){let F,R;return f=0,H=`${_}`,F=U(N()),N()!="$"&&E(),f=H=null,S&&Pe.call(S)=="[object Function]"?ca(((R={})[""]=F,R),"",S):F}}}return p.runInContext=l,p}(t,t.JSON3={noConflict(){return n||(n=!0,t.JSON=r,t.JSON3=i,r=i=null),a}});t.JSON?(t.JSON.parse=a.parse,t.JSON.stringify=a.stringify):t.JSON={parse:a.parse,stringify:a.stringify}}).call(window),function(e){if(e.atob)try{e.atob(" ")}catch{e.atob=(t=e.atob,(r=function(n){return t(String(n).replace(/[\t\n\f\r ]+/g,""))}).original=t,r)}else{var t,r;let i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=/^(?:[A-Z\d+/]{4})*?(?:[A-Z\d+/]{2}(?:==)?|[A-Z\d+/]{3}=?)?$/i;e.btoa=function(a){a=String(a);for(var l,u,p,b,w="",L=0,B=a.length%3;L<a.length;){if((u=a.charCodeAt(L++))>255||(p=a.charCodeAt(L++))>255||(b=a.charCodeAt(L++))>255)return"";w+=i.charAt((l=u<<16|p<<8|b)>>18&63)+i.charAt(l>>12&63)+i.charAt(l>>6&63)+i.charAt(63&l)}return B?w.slice(0,B-3)+"===".substring(B):w},e.atob=function(a){if(a=String(a).replace(/[\t\n\f\r ]+/g,""),!n.test(a))return"";a+="==".slice(2-(3&a.length));for(var l,u,p,b="",w=0;w<a.length;)l=i.indexOf(a.charAt(w++))<<18|i.indexOf(a.charAt(w++))<<12|(u=i.indexOf(a.charAt(w++)))<<6|(p=i.indexOf(a.charAt(w++))),b+=u===64?String.fromCharCode(l>>16&255):p===64?String.fromCharCode(l>>16&255,l>>8&255):String.fromCharCode(l>>16&255,l>>8&255,255&l);return b}}}(window);let G={setup(e){vt=e},log(){(vt||console&&console.log||function(){}).apply(null,arguments)}};var I={get(e){return window.localStorage.getItem(e)},parse(e){let t;try{t=JSON.parse(I.get(e))||null}catch(r){G.log(r)}return t},set(e,t){try{window.localStorage.setItem(e,t)}catch(r){G.log(r)}},remove(e){window.localStorage.removeItem(e)},isSupport(){let e=!0;try{let t="__local_store_support__",r="testIsSupportStorage";I.set(t,r),I.get(t)!==r&&(e=!1),I.remove(t)}catch{e=!1}return e}};function d(e){return e!=null&&Object.prototype.toString.call(e)=="[object Object]"}let di=function(){let e=new Date().getTime();return function(t){return Math.ceil((e=(9301*e+49297)%233280)/233280*t)}}();function ge(){if(typeof Uint32Array=="function"){let e="";if(typeof crypto<"u"?e=crypto:typeof msCrypto<"u"&&(e=msCrypto),d(e)&&e.getRandomValues){let t=new Uint32Array(1);return e.getRandomValues(t)[0]/2**32}}return di(1e19)/1e19}function te(e){let t=null;try{t=JSON.parse(e)}catch{}return t}function zt(e,t){this.lockGetPrefix=e||"lock-get-prefix",this.lockSetPrefix=t||"lock-set-prefix"}function yr(e){return typeof e=="function"||!(!e||typeof e!="object")&&yr(e.listener)}function Ce(){this._events={}}function Me(e){let t=e;try{t=decodeURIComponent(e)}catch{t=e}return t}function ga(){function e(){}return typeof Object.create!="function"?(e.prototype=null,new e):Object.create(null)}function Xt(e){e=e||"";for(var t=ga(),r=e.substring(1).split("&"),i=0;i<r.length;i++){let n=r[i].indexOf("=");if(n!==-1){let a=r[i].substring(0,n),l=r[i].substring(n+1);a=Me(a),l=Me(l),a!=="__proto__"&&a!=="constructor"&&a!=="prototype"&&(t[a]=l)}}return t}function g(e){return Object.prototype.toString.call(e)=="[object String]"}function we(e){return e.replace(/^\s+|\s+$/g,"")}function vr(e){let t=function(r){this._fields={Username:4,Password:5,Port:7,Protocol:2,Host:6,Path:8,URL:0,QueryString:9,Fragment:10},this._values={},this._regex=/^((\w+):\/\/)?((\w+):?(\w+)?@)?([^/?:]+):?(\d+)?([^?#]+)?\??([^#]+)?#?(\w*)/,r!==void 0&&this._parse(r)};return t.prototype.setUrl=function(r){this._parse(r)},t.prototype._initValues=function(){for(let r in this._fields)this._values[r]=""},t.prototype.addQueryString=function(r){if(typeof r!="object")return!1;let i=this._values.QueryString||"";for(let n in r)i=new RegExp(`${n}[^&]+`).test(i)?i.replace(new RegExp(`${n}[^&]+`),`${n}=${r[n]}`):i.slice(-1)==="&"?`${i+n}=${r[n]}`:i===""?`${n}=${r[n]}`:`${i}&${n}=${r[n]}`;this._values.QueryString=i},t.prototype.getUrl=function(){let r="";return r+=this._values.Origin,r+=this._values.Port?`:${this._values.Port}`:"",r+=this._values.Path,r+=this._values.QueryString?`?${this._values.QueryString}`:"",r+=this._values.Fragment?`#${this._values.Fragment}`:""},t.prototype._parse=function(r){this._initValues();let i=this._regex.exec(r);i||G.log("URLParser::_parse -> Invalid URL");let n=r.split("#"),a=n[0],l=n.slice(1).join("#");for(let u in i=this._regex.exec(a),this._fields)typeof i[this._fields[u]]<"u"&&(this._values[u]=i[this._fields[u]]);this._values.Hostname=this._values.Host.replace(/:\d+$/,""),this._values.Origin=`${this._values.Protocol}://${this._values.Hostname}`,this._values.Fragment=l},new t(e)}function qe(e){let t,r={};if(typeof window.URL=="function"&&function(){try{return new URL("http://modernizr.com/").href==="http://modernizr.com/"}catch{return!1}}())(r=new URL(e)).searchParams||(r.searchParams=(t=Xt(r.search),{get(i){return t[i]}}));else{if(g(e)||(e=String(e)),e=we(e),/^https?:\/\/.+/.test(e)===!1)return void G.log("Invalid URL");let i=vr(e);r.hash=i._values.Fragment,r.host=i._values.Host?i._values.Host+(i._values.Port?`:${i._values.Port}`:""):"",r.href=i._values.URL,r.password=i._values.Password,r.pathname=i._values.Path,r.port=i._values.Port,r.search=i._values.QueryString?`?${i._values.QueryString}`:"",r.username=i._values.Username,r.hostname=i._values.Hostname,r.protocol=i._values.Protocol?`${i._values.Protocol}:`:"",r.origin=i._values.Origin?i._values.Origin+(i._values.Port?`:${i._values.Port}`:""):"",r.searchParams=function(){let n=Xt(`?${i._values.QueryString}`);return{get(a){return n[a]}}}()}return r}zt.prototype.get=function(e,t,r,i){if(!e)throw new Error("key is must");t=t||1e4,r=r||1e3,i=i||function(){};let n=this.lockGetPrefix+e,a=I.get(n),l=String(ge());if(a&&(a=te(a)||{randomNum:0,expireTime:0}).expireTime>pe())return i(null);I.set(n,JSON.stringify({randomNum:l,expireTime:pe()+t})),setTimeout(()=>{(a=te(I.get(n))||{randomNum:0,expireTime:0})&&a.randomNum===l?(i(I.get(e)),I.remove(e),I.remove(n)):i(null)},r)},zt.prototype.set=function(e,t,r,i,n){if(!e||!t)throw new Error("key and val is must");r=r||1e4,i=i||1e3,n=n||function(){};let a=this.lockSetPrefix+e,l=I.get(a),u=String(ge());if(l&&(l=te(l)||{randomNum:0,expireTime:0}).expireTime>pe())return n({status:"fail",reason:"This key is locked"});I.set(a,JSON.stringify({randomNum:u,expireTime:pe()+r})),setTimeout(()=>{(l=te(I.get(a))||{randomNum:0,expireTime:0}).randomNum===u?I.set(e,t)&&n({status:"success"}):n({status:"fail",reason:"This key is locked"})},i)},Ce.prototype.on=function(e,t){if(!e||!t)return!1;if(!yr(t))throw new Error("listener must be a function");this._events[e]=this._events[e]||[];let r=typeof t=="object";return this._events[e].push(r?t:{listener:t,once:!1}),this},Ce.prototype.prepend=function(e,t){if(!e||!t)return!1;if(!yr(t))throw new Error("listener must be a function");this._events[e]=this._events[e]||[];let r=typeof t=="object";return this._events[e].unshift(r?t:{listener:t,once:!1}),this},Ce.prototype.prependOnce=function(e,t){return this.prepend(e,{listener:t,once:!0})},Ce.prototype.once=function(e,t){return this.on(e,{listener:t,once:!0})},Ce.prototype.off=function(e,t){let r=this._events[e];if(!r)return!1;if(typeof t=="number")r.splice(t,1);else if(typeof t=="function")for(let i=0,n=r.length;i<n;i++)r[i]&&r[i].listener===t&&r.splice(i,1);return this},Ce.prototype.emit=function(e,t){let r=this._events[e];if(!r)return!1;for(let i=0;i<r.length;i++){let n=r[i];n&&(n.listener.call(this,t||{}),n.once&&this.off(e,i))}return this},Ce.prototype.removeAllListeners=function(e){e&&this._events[e]?this._events[e]=[]:this._events={}},Ce.prototype.listeners=function(e){return e&&typeof e=="string"?this._events[e]:this._events};let Ye=function(){let e=function(){for(var t=1*new Date,r=0;t==1*new Date;)r++;return t.toString(16)+r.toString(16)};return function(){let t=String(screen.height*screen.width);return t=t&&/\d{5,}/.test(t)?t.toString(16):String(31242*ge()).replace(".","").slice(0,8),`${e()}-${ge().toString(16).replace(".","")}-${function(){let i,n,a=navigator.userAgent,l=[],u=0;function p(b,w){let L,B=0;for(L=0;L<w.length;L++)B|=l[L]<<8*L;return b^B}for(i=0;i<a.length;i++)n=a.charCodeAt(i),l.unshift(255&n),l.length>=4&&(u=p(u,l),l=[]);return l.length>0&&(u=p(u,l)),u.toString(16)}()}-${t}-${e()}`||(String(ge())+String(ge())+String(ge())).slice(2,15)}}();function re(e){return!(!e||e.nodeType!==1)}function Oe(e){return e===void 0}function j(e){return Array.isArray&&$(j)?Array.isArray(e):Object.prototype.toString.call(e)==="[object Array]"}function fe(e){return new pi(e)}var pi=function(e){this.ele=e};let gi=function(e,t){for(var r=[];e;e=e.nextSibling)e.nodeType===1&&e!==t&&r.push(e);return r};function at(e,t,r,i){function n(a){return a&&(a.preventDefault=n.preventDefault,a.stopPropagation=n.stopPropagation,a._getPath=n._getPath),a}n._getPath=function(){return this.path||this.composedPath&&this.composedPath()||fe(this.target).getParents()},n.preventDefault=function(){this.returnValue=!1},n.stopPropagation=function(){this.cancelBubble=!0},(function(a,l,u){if(i===void 0&&l==="click"&&(i=!0),a&&a.addEventListener)a.addEventListener(l,function(p){p._getPath=n._getPath,u.call(this,p)},i);else{let p=`on${l}`,b=a[p];a[p]=function(w,L,B,ke){return function(q){if(!(q=q||n(window.event)))return;q.target=q.srcElement;let He,yt,ye=!0;return typeof B=="function"&&(He=B(q)),yt=L.call(w,q),ke!=="beforeunload"?(He!==!1&&yt!==!1||(ye=!1),ye):void 0}}(a,u,b,l)}}).apply(null,arguments)}function fi(e){let t="pushState"in window.history?"popstate":"hashchange";at(window,t,e)}function _i(e){if(e)return typeof window.XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest?new XMLHttpRequest:typeof XDomainRequest<"u"?new XDomainRequest:null;if(typeof window.XMLHttpRequest<"u")return new XMLHttpRequest;if(window.ActiveXObject)try{return new ActiveXObject("Msxml2.XMLHTTP")}catch{try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(r){G.log(r)}}}function D(e,t,r){if(typeof e=="object"&&typeof e.length=="number"&&e.length>0)if(Array.prototype.forEach&&e.forEach)e.forEach(t,r);else for(let i=0;i<e.length;i++)t.call(r,e[i],i,e);else if(Object.prototype.toString.call(e)==="[object Object]")for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(r,e[i],i,e)}function P(e){for(let t=1;t<arguments.length;t++){let r=arguments[t];if(Object.prototype.toString.call(r)==="[object Object]")for(let i in r)Object.prototype.hasOwnProperty.call(r,i)&&r[i]!==void 0&&(e[i]=r[i])}return e}function hi(e){function t(l){if(!l)return"";try{return JSON.parse(l)}catch{return{}}}e.timeout=e.timeout||2e4,e.credentials=typeof e.credentials>"u"||e.credentials;let r=_i(e.cors);if(!r)return!1;e.type||(e.type=e.data?"POST":"GET");let i,n=(e=P({success(){},error(){}},e)).success,a=e.error;e.success=function(l){n(l),i&&(clearTimeout(i),i=null)},e.error=function(l){a(l),i&&(clearTimeout(i),i=null)},i=setTimeout(()=>{(function(){try{r&&typeof r=="object"&&r.abort&&r.abort()}catch(l){G.log(l)}i&&(clearTimeout(i),i=null,e.error&&e.error(),r.onreadystatechange=null,r.onload=null,r.onerror=null)})()},e.timeout),typeof XDomainRequest<"u"&&r instanceof XDomainRequest&&(r.onload=function(){e.success&&e.success(t(r.responseText)),r.onreadystatechange=null,r.onload=null,r.onerror=null},r.onerror=function(){e.error&&e.error(t(r.responseText),r.status),r.onreadystatechange=null,r.onerror=null,r.onload=null}),r.onreadystatechange=function(){try{r.readyState==4&&(r.status>=200&&r.status<300||r.status==304?e.success(t(r.responseText)):e.error(t(r.responseText),r.status),r.onreadystatechange=null,r.onload=null)}catch{r.onreadystatechange=null,r.onload=null}},r.open(e.type,e.url,!0);try{e.credentials&&(r.withCredentials=!0),d(e.header)&&D(e.header,(l,u)=>{r.setRequestHeader&&r.setRequestHeader(u,l)}),e.data&&(e.cors||r.setRequestHeader&&r.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.contentType==="application/json"?r.setRequestHeader&&r.setRequestHeader("Content-type","application/json; charset=UTF-8"):r.setRequestHeader&&r.setRequestHeader("Content-type","application/x-www-form-urlencoded"))}catch(l){G.log(l)}r.send(e.data||null)}function mi(e,t){let r=[];return e==null?r:Array.prototype.map&&e.map===Array.prototype.map?e.map(t):(D(e,(i,n,a)=>{r.push(t(i,n,a))}),r)}function bt(e){let t=[];try{t=mi(atob(e).split(""),r=>`%${`00${r.charCodeAt(0).toString(16)}`.slice(-2)}`)}catch{t=[]}try{return decodeURIComponent(t.join(""))}catch{return t.join("")}}function Dt(e){let t="";try{t=btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(r,i)=>String.fromCharCode(`0x${i}`)))}catch{t=e}return t}function fa(e,t){t=t||window;let r=!1,i=!0,n=t.document,a=n.documentElement,l=n.addEventListener,u=l?"addEventListener":"attachEvent",p=l?"removeEventListener":"detachEvent",b=l?"":"on",w=function(B){B.type=="readystatechange"&&n.readyState!="complete"||((B.type=="load"?t:n)[p](b+B.type,w,!1),!r&&(r=!0)&&e.call(t,B.type||B))},L=function(){try{a.doScroll("left")}catch{return void setTimeout(L,50)}w("poll")};if(n.readyState=="complete")e.call(t,"lazy");else{if(!l&&a.doScroll){try{i=!t.frameElement}catch(B){G.log(B)}i&&L()}n[u](`${b}DOMContentLoaded`,w,!1),n[u](`${b}readystatechange`,w,!1),t[u](`${b}load`,w,!1)}}pi.prototype={addClass(e){return!` ${this.ele.className} `.includes(` ${e} `)&&(this.ele.className=this.ele.className+(this.ele.className===""?"":" ")+e),this},removeClass(e){let t=` ${this.ele.className} `;return t.includes(` ${e} `)&&(this.ele.className=t.replace(` ${e} `," ").slice(1,-1)),this},hasClass(e){return` ${this.ele.className} `.includes(` ${e} `)},attr(e,t){return typeof e=="string"&&Oe(t)?this.ele.getAttribute(e):(typeof e=="string"&&(t=String(t),this.ele.setAttribute(e,t)),this)},offset(){let e=this.ele.getBoundingClientRect();if(e.width||e.height){let t=this.ele.ownerDocument.documentElement;return{top:e.top+window.pageYOffset-t.clientTop,left:e.left+window.pageXOffset-t.clientLeft}}return{top:0,left:0}},getSize(){if(!window.getComputedStyle)return{width:this.ele.offsetWidth,height:this.ele.offsetHeight};try{let e=this.ele.getBoundingClientRect();return{width:e.width,height:e.height}}catch{return{width:0,height:0}}},getStyle(e){return this.ele.currentStyle?this.ele.currentStyle[e]:this.ele.ownerDocument.defaultView.getComputedStyle(this.ele,null).getPropertyValue(e)},wrap(e){let t=document.createElement(e);return this.ele.parentNode.insertBefore(t,this.ele),t.appendChild(this.ele),fe(t)},getCssStyle(e){let t=this.ele.style.getPropertyValue(e);if(t)return t;let r=null;if(typeof window.getMatchedCSSRules=="function"&&(r=window.getMatchedCSSRules(this.ele)),!r||!j(r))return null;for(let i=r.length-1;i>=0;i--)if(t=r[i].style.getPropertyValue(e))return t},sibling(e,t){for(;(e=e[t])&&e.nodeType!==1;);return e},next(){return this.sibling(this.ele,"nextSibling")},prev(){return this.sibling(this.ele,"previousSibling")},siblings(){return gi((this.ele.parentNode||{}).firstChild,this.ele)},children(){return gi(this.ele.firstChild)},parent(){let e=this.ele.parentNode;return fe(e=e&&e.nodeType!==11?e:null)},previousElementSibling(){let e=this.ele;if("previousElementSibling"in document.documentElement)return fe(e.previousElementSibling);for(;e=e.previousSibling;)if(e.nodeType===1)return fe(e);return fe(null)},getSameTypeSiblings(){for(var e=this.ele,t=e.parentNode,r=e.tagName.toLowerCase(),i=[],n=0;n<t.children.length;n++){let a=t.children[n];a.nodeType===1&&a.tagName.toLowerCase()===r&&i.push(t.children[n])}return i},getParents(){try{let e=this.ele;if(!re(e))return[];let t=[e];if(e===null||e.parentElement===null)return[];for(;e.parentElement!==null;)e=e.parentElement,t.push(e);return t}catch{return[]}}};let st={get(e){for(let r=`${e}=`,i=document.cookie.split(";"),n=0;n<i.length;n++){for(var t=i[n];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(r)==0)return Me(t.substring(r.length,t.length))}return null},set(e,t,r,i,n,a){let l=a,u="",p="",b="";if((r=r??73e3)!==0){let q=new Date;String(r).slice(-1)==="s"?q.setTime(q.getTime()+1e3*Number(String(r).slice(0,-1))):q.setTime(q.getTime()+24*r*60*60*1e3),u=`; expires=${q.toGMTString()}`}function w(q){return!!q&&q.replace(/\r\n/g,"")}i&&i!==""&&(b=`; SameSite=${i}`),n&&(p="; secure");let L="",B="",ke="";e&&(L=w(e)),t&&(B=w(t)),l&&(ke=w(l)),L&&B&&(document.cookie=`${L}=${encodeURIComponent(B)}${u}; path=/${ke}${b}${p}`)},remove(e,t){this.set(e,"1",-1,t)},isSupport(e,t,r,i,n){e=e||"cookie_support_test",t=t||"1";let a=this;return navigator.cookieEnabled&&(a.set(e,t,r,i,n),a.get(e)===t&&(a.remove(e),!0))}};function yi(e){return D(Array.prototype.slice.call(arguments,1),t=>{for(let r in t)t[r]!==void 0&&e[r]===void 0&&(e[r]=t[r])}),e}function wt(e){let t=e;try{t=decodeURI(e)}catch{t=e}return t}function _a(e){let t="t6KJCZa5pDdQ9khoEM3Tj70fbP2eLSyc4BrsYugARqFIw1mzlGNVXOHiWvxUn8",r=t.length-1,i={},n=0;for(n=0;n<t.length;n++)i[t.charAt(n)]=t.charAt(r-n);let a="";for(n=0;n<e.length;n++)e.charAt(n)in i?a+=i[e.charAt(n)]:a+=e.charAt(n);return a}function Pt(e){return Object.prototype.toString.call(e)=="[object Date]"}function br(e){function t(r){return r<10?`0${r}`:r}return`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())} ${t(e.getHours())}:${t(e.getMinutes())}:${t(e.getSeconds())}.${t(e.getMilliseconds())}`}function vi(e){return D(e,(t,r)=>{Pt(t)?e[r]=br(t):d(t)&&(e[r]=vi(t))}),e}function bi(e){return D(Array.prototype.slice.call(arguments,1),t=>{for(let r in t)t[r]!==void 0&&(d(t[r])&&d(e[r])?P(e[r],t[r]):e[r]=t[r])}),e}function wi(e,t,r){let i=Object.prototype.hasOwnProperty;if(e.filter)return e.filter(t);for(var n=[],a=0;a<e.length;a++)if(i.call(e,a)){let l=e[a];t.call(r,l,a,e)&&n.push(l)}return n}function ha(e){try{return JSON.stringify(e,null,"  ")}catch{return JSON.stringify(e)}}function ma(e){return typeof e=="string"&&e.match(/^[a-z0-9\u4E00-\u9FA5\-.]+$/i)?e:""}function wr(e,t,r){t=t||"domain_test";let i=ma(e=e||location.hostname),n=i.split(".");if(j(n)&&n.length>=2&&!/^(\d+\.)+\d+$/.test(i)){for(let a=`.${n.splice(n.length-1,1)}`;n.length>0;)if(a=`.${n.splice(n.length-1,1)}${a}`,st.set(t,"true",0,null,r,`; domain=${a}`),document.cookie.includes(`${t}=true`))return st.set(t,"true","-1s",null,r,`; domain=${a}`),a}return""}function Yt(e){if(!g(e))return null;let t,r=e.split(">");return(t=function i(n){let a,l=r.shift();if(!l)return n;try{a=function(u,p){let b;if((u=we(u))==="body")return document.getElementsByTagName("body")[0];if(u.indexOf("#")===0)u=u.slice(1),b=document.getElementById(u);else if(u.includes(":nth-of-type")){let w=u.split(":nth-of-type");if(!w[0]||!w[1])return null;let L=w[0],B=w[1].match(/\((\d+)\)/);if(!B||!B[1])return null;let ke=Number(B[1]);if(!(re(p)&&p.children&&p.children.length>0))return null;for(let q=p.children,He=0;He<q.length;He++)if(re(q[He])&&q[He].tagName.toLowerCase()===L&&--ke==0){b=q[He];break}if(ke>0)return null}return b||null}(l,n)}catch(u){G.log(u)}return a&&re(a)?i(a):null}())&&re(t)?t:null}function Si(e,t){let r="",i="";return e.textContent?r=we(e.textContent):e.innerText&&(r=we(e.innerText)),r&&(r=r.replace(/[\r\n]/g," ").replace(/ +/g," ").substring(0,255)),i=r||"",t!=="input"&&t!=="INPUT"||(i=e.value||""),i}function Te(e,t){t&&typeof t=="string"||(t="hostname解析异常");let r=null;try{r=qe(e).hostname}catch{G.log("getHostname传入的url参数不合法！")}return r||t}function Sr(){try{let e=navigator.appVersion.match(/OS (\d+)[._](\d+)[._]?(\d+)?/);return e&&e[1]?Number.parseInt(e[1],10):""}catch{return""}}function Ke(e,t){t=t.replace(/\[/,"\\[").replace(/\]/,"\\]"),e=Me(e);let r=new RegExp(`[\\?&]${t}=([^&#]*)`).exec(e);return r===null||r&&typeof r[1]!="string"&&r[1].length?"":Me(r[1])}function At(e){let t={},r=e.split("?")[1]||"";return r&&(t=Xt(`?${r}`)),t}function $i(){return typeof window.matchMedia<"u"||typeof window.msMatchMedia<"u"}function ya(){let e=screen.msOrientation||screen.mozOrientation||(screen.orientation||{}).type,t="未取到值";if(e)t=e.includes("landscape")?"landscape":"portrait";else if($i()){let r=window.matchMedia||window.msMatchMedia;r("(orientation: landscape)").matches?t="landscape":r("(orientation: portrait)").matches&&(t="portrait")}return t}function $r(){let e,t={},r=navigator.userAgent.toLowerCase();return(e=r.match(/ qq\/([\d.]+)/))?t.qqBuildinBrowser=Number(e[1].split(".")[0]):(e=r.match(/mqqbrowser\/([\d.]+)/))?t.qqBrowser=Number(e[1].split(".")[0]):(e=r.match(/opera.([\d.]+)/))?t.opera=Number(e[1].split(".")[0]):(e=r.match(/msie ([\d.]+)/))?t.ie=Number(e[1].split(".")[0]):(e=r.match(/edge.([\d.]+)/))?t.edge=Number(e[1].split(".")[0]):(e=r.match(/firefox\/([\d.]+)/))?t.firefox=Number(e[1].split(".")[0]):(e=r.match(/chrome\/([\d.]+)/))?t.chrome=Number(e[1].split(".")[0]):(e=r.match(/version\/([\d.]+).*safari/))?t.safari=Number(e[1].match(/^\d*.\d*/)):(e=r.match(/trident\/([\d.]+)/))&&(t.ie=11),t}function oe(e){return g(e)?wt(e=we(e)):wt(location.href)}function ot(e){return g(e)?wt(e=we(e)):wt(location.pathname)}function kr(e,t){return e.hasAttribute?e.hasAttribute(t):e.attributes?!(!e.attributes[t]||!e.attributes[t].specified):void 0}function Fr(e,t){if(typeof t=="string")return kr(e,t);if(j(t)){for(var r=!1,i=0;i<t.length;i++)if(kr(e,t[i])){r=!0;break}return r}}function ki(e){if(typeof e!="string")return 0;let t=0;if(e.length==0)return t;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t&=t;return t}function Cr(e){let t=9007199254740992,r=-9007199254740992,i=0;if(e.length>0)for(let n=e.split(""),a=0;a<n.length;a++){let l=n[a].charCodeAt(),u=31*i+l;if(u>t)for(i=r+i;(u=31*i+l)<r;)i=i/2+l;if(u<r)for(i=t+i;(u=31*i+l)>t;)i=i/2+l;i=31*i+l}return i}function ie(e,t){let r=e.indexOf;if(r)return r.call(e,t);for(let i=0;i<e.length;i++)if(t===e[i])return i;return-1}function va(e,t){return e.prototype=new t,e.prototype.constructor=e,e.superclass=t.prototype,e}let ba=Object.prototype.hasOwnProperty;function Fi(e){return!(!e||!ba.call(e,"callee"))}function Ci(e){return Object.prototype.toString.call(e)=="[object Boolean]"}function ne(e){if(d(e)){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}return!1}function Ei(e){return typeof e!="string"?!1:/^https?:\/\/.+/.test(e)!==!1||(G.log("Invalid URL"),!1)}function Di(){return!!navigator.userAgent.match(/iPhone|iPad|iPod/i)}function Zt(e){try{JSON.parse(e)}catch{return!1}return!0}function Le(e){return Object.prototype.toString.call(e)=="[object Number]"&&/[\d.]+/.test(String(e))}function wa(){let e=!1;if(typeof navigator!="object"||typeof navigator.sendBeacon!="function")return e;let t=$r(),r=navigator.userAgent.toLowerCase();if(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)){let i=`${r.match(/os [\d._]*/gi)}`.replace(/[^0-9|_.]/g,"").replace(/_/g,".").split(".");typeof t.safari>"u"&&(t.safari=i[0]),i[0]&&(t.qqBuildinBrowser||t.qqBrowser)?e=!1:i[0]&&i[0]<13?(t.chrome>41||t.firefox>30||t.opera>25||t.safari>12)&&(e=!0):(t.chrome>41||t.firefox>30||t.opera>25||t.safari>11.3)&&(e=!0)}else(t.chrome>38||t.edge>13||t.firefox>30||t.opera>25||t.safari>11)&&(e=!0);return e}function Sa(){return typeof window.XMLHttpRequest<"u"&&("withCredentials"in new XMLHttpRequest||typeof XDomainRequest<"u")}function Pi(e){if(!d(e)||!g(e.callbackName))return G.log("JSONP 请求缺少 callbackName"),!1;e.success=$(e.success)?e.success:function(){},e.error=$(e.error)?e.error:function(){},e.data=e.data||"";let t=document.createElement("script"),r=document.getElementsByTagName("head")[0],i=null,n=!1;r.appendChild(t),Le(e.timeout)&&(i=setTimeout(()=>{if(n)return!1;e.error("timeout"),window[e.callbackName]=function(){G.log("call jsonp error")},i=null,r.removeChild(t),n=!0},Math.min(e.timeout,3e4))),window[e.callbackName]=function(){clearTimeout(i),i=null,e.success.apply(null,arguments),window[e.callbackName]=function(){G.log("call jsonp error")},r.removeChild(t)};let a=encodeURIComponent(e.callbackName),l="";if(e.url.includes("?")?e.url+=`&callbackName=${a}`:e.url+=`?callbackName=${a}`,d(e.data)){let u=[];D(e.data,(p,b)=>{u.push(`${encodeURIComponent(b)}=${encodeURIComponent(p)}`)}),(l=u.join("&"))&&(e.url+=`&${l}`)}t.onerror=function(u){if(n)return!1;window[e.callbackName]=function(){G.log("call jsonp error")},clearTimeout(i),i=null,r.removeChild(t),e.error(u),n=!0},t.src=e.url}function Ai(e){({visibleHandler:$(e.visible)?e.visible:function(){},hiddenHandler:$(e.hidden)?e.hidden:function(){},visibilityChange:null,hidden:null,isSupport(){return typeof document[this.hidden]<"u"},init(){typeof document.hidden<"u"?(this.hidden="hidden",this.visibilityChange="visibilitychange"):typeof document.mozHidden<"u"?(this.hidden="mozHidden",this.visibilityChange="mozvisibilitychange"):typeof document.msHidden<"u"?(this.hidden="msHidden",this.visibilityChange="msvisibilitychange"):typeof document.webkitHidden<"u"&&(this.hidden="webkitHidden",this.visibilityChange="webkitvisibilitychange"),this.listen()},listen(){if(this.isSupport()){let t=this;at(document,this.visibilityChange,()=>{document[t.hidden]?t.hiddenHandler():t.visibleHandler()},1)}else at(window,"focus",this.visibleHandler),at(window,"blur",this.hiddenHandler)}}).init()}function Gt(e){e=P({success(){},error(){},appendCall(r){document.getElementsByTagName("head")[0].appendChild(r)}},e);let t=null;e.type==="css"&&((t=document.createElement("link")).rel="stylesheet",t.href=e.url),e.type==="js"&&((t=document.createElement("script")).async="async",t.setAttribute("charset","UTF-8"),t.src=e.url,t.type="text/javascript"),t.onload=t.onreadystatechange=function(){this.readyState&&this.readyState!=="loaded"&&this.readyState!=="complete"||(e.success(),t.onload=t.onreadystatechange=null)},t.onerror=function(){e.error(),t.onerror=null},e.appendCall(t)}function $a(e){if(typeof e!="string")return"";for(let t=/^\s*javascript/i;t.test(e);)e=e.replace(t,"");return e}function Bi(e,t){t=typeof t=="number"?t:13;for(var r=(e=String(e)).split(""),i=0;i<r.length;i++)r[i].charCodeAt(0)<126&&(r[i]=String.fromCharCode((r[i].charCodeAt(0)+t)%126));return r.join("")}function Ii(e){return Bi(e=String(e),113)}function Er(e){d(e)&&D(e,(t,r)=>{d(t)?Er(e[r]):Pt(t)&&(e[r]=br(t))})}let St={isSupport(){let e=!0,t="testIsSupportStorage";try{sessionStorage&&sessionStorage.setItem?(sessionStorage.setItem("__session_storage_support__",t),sessionStorage.removeItem("__session_storage_support__",t),e=!0):e=!1}catch{e=!1}return e}};function Qt(e){let t=document.createElement("style");t.type="text/css";try{t.appendChild(document.createTextNode(e))}catch{t.styleSheet.cssText=e}let r=document.getElementsByTagName("head")[0],i=document.getElementsByTagName("script")[0];r?r.children.length?r.insertBefore(t,r.children[0]):r.appendChild(t):i.parentNode.insertBefore(t,i)}function ka(e){if(typeof e!="string")return G.log("转换unicode错误",e),e;for(var t="",r=0;r<e.length;r++)t+=`\\${e.charCodeAt(r).toString(16)}`;return t}function Fa(e,t,r){let i,n,a,l=null,u=0;r||(r={});let p=function(){u=r.leading===!1?0:pe(),l=null,a=e.apply(i,n),l||(i=n=null)};return function(){let b=pe();u||r.leading!==!1||(u=b);let w=t-(b-u);return i=this,n=arguments,w<=0||w>t?(l&&(clearTimeout(l),l=null),u=b,a=e.apply(i,n),l||(i=n=null)):l||r.trailing===!1||(l=setTimeout(p,w)),a}}function ji(e){let t=[];return e==null||D(e,r=>{t[t.length]=r}),t}function Ca(e){return e?e.toArray?e.toArray():j(e)||Fi(e)?Array.prototype.slice.call(e):ji(e):[]}function er(e){for(var t,r=[],i={},n=0;n<e.length;n++)(t=e[n])in i||(i[t]=!0,r.push(t));return r}let Ea={"+":"-","/":"_","=":"."},Da={"-":"+",_:"/",".":"="},Pa={encode(e){return e.replace(/[+/=]/g,t=>Ea[t])},decode(e){return e.replace(/[-_.]/g,t=>Da[t])},trim(e){return e.replace(/[.=]{1,2}$/,"")},isBase64(e){return/^[A-Z0-9+/]*[=]{0,2}$/i.test(e)},isUrlSafeBase64(e){return/^[\w-]*\.{0,2}$/.test(e)}};function Dr(e,t,r){return r=r||0,e.substr(r,t.length)===t}function Pr(e){return e!=="__proto__"&&e!=="constructor"&&e!=="prototype"}let Aa={__proto__:null,noPrototypePollution:Pr,ConcurrentStorage:zt,EventEmitter:Ce,URL:qe,UUID:Ye,addEvent:at,addHashEvent:fi,ajax:hi,base64Decode:bt,base64Encode:Dt,bindReady:fa,cookie:st,coverExtend:yi,decodeURI:wt,decodeURIComponent:Me,dfmapping:_a,each:D,encodeDates:vi,extend:P,extend2Lev:bi,filter:wi,formatDate:br,formatJsonString:ha,getCookieTopLevelDomain:wr,getDomBySelector:Yt,getElementContent:Si,getHostname:Te,getIOSVersion:Sr,getQueryParam:Ke,getQueryParamsFromUrl:At,getRandom:ge,getRandomBasic:di,getScreenOrientation:ya,getUA:$r,getURL:oe,getURLPath:ot,getURLSearchParams:Xt,hasAttribute:kr,hasAttributes:Fr,hashCode:ki,hashCode53:Cr,indexOf:ie,inherit:va,isArguments:Fi,isArray:j,isBoolean:Ci,isDate:Pt,isElement:re,isEmptyObject:ne,isFunction:$,isHttpUrl:Ei,isIOS:Di,isJSONString:Zt,isNumber:Le,isObject:d,isString:g,isSupportBeaconSend:wa,isSupportCors:Sa,isUndefined:Oe,jsonp:Pi,listenPageState:Ai,loadScript:Gt,localStorage:I,logger:G,map:mi,mediaQueriesSupported:$i,now:pe,removeScriptProtocol:$a,rot13defs:Ii,rot13obfs:Bi,ry:fe,safeJSONParse:te,searchObjDate:Er,sessionStorage:St,setCssStyle:Qt,strToUnicode:ka,throttle:Fa,toArray:Ca,trim:we,unique:er,urlParse:vr,urlSafeBase64:Pa,values:ji,xhr:_i,startsWith:Dr},tr=[],lt={appendWriter(e){tr.push(e)},msg(){let e={module:"",level:"log",brand:"web-sdk",content:null};return e.content=Array.prototype.slice.call(arguments),{module(t){return g(t)&&(e.module=t),this},level(t){return g(t)&&(e.level=t),this},brand(t){return g(t)&&(e.brand=t),this},log(){if(e.content&&e.content.length){for(let t=0;t<tr.length;t++)if(typeof tr[t]=="function")try{tr[t].call(null,e)}catch{}}return this}}}};function xe(){lt.msg.apply(lt,arguments).log()}function k(){lt.msg.apply(lt,arguments).level("warn").log()}function A(){lt.msg.apply(lt,arguments).level("error").log()}let h={},rr={preset_properties:{search_keyword_baidu:!1,latest_utm:!0,latest_traffic_source_type:!0,latest_search_keyword:!0,latest_referrer:!0,latest_referrer_host:!1,latest_landing_page:!1,latest_wx_ad_click_id:void 0,url:!0,title:!0},encrypt_cookie:!1,enc_cookie:!1,img_use_crossorigin:!1,name:"sa",max_referrer_string_length:200,max_string_length:1024,max_id_length:255,max_key_length:100,cross_subdomain:!0,show_log:!1,is_debug:!1,source_channel:[],sdk_id:"",auto_init:!0,is_track_single_page:!1,is_single_page:!1,batch_send:!1,custom_server_url:"",source_type:{},callback_timeout:200,datasend_timeout:8e3,is_track_device_id:!1,ignore_oom:!0,app_js_bridge:!1,white_list:{}};rr.white_list[location.host]=qe(location.href).hostname;let Ni="utm_source utm_medium utm_campaign utm_content utm_term",ir="1.27.11",Oi="sensorsdata_domain_test",Bt={LOGIN:"$identity_login_id"};function Ar(e){let t=h.current_domain;switch(typeof t){case"function":var r=t();return r===""||we(r)===""?"url解析失败":r.includes(".")?r:"url解析失败";case"string":return t===""||we(t)===""?"url解析失败":t.includes(".")?t:"url解析失败";default:var i=wr(null,Oi,h.is_secure_cookie);return e===""||i===""?"url解析失败":i}}let Be={get(e){return st.get(e)},set(e,t,r,i){let n="";if(i=Oe(i)?h.cross_subdomain:i){let a=Ar(location.href);a==="url解析失败"&&(a=""),n=a?`; domain=${a}`:""}return st.set(e,t,r,h.set_cookie_samesite,h.is_secure_cookie,n)},remove(e,t){return t=Oe(t)?h.cross_subdomain:t,st.remove(e,t)},isSupport(e,t){return e=e||"sajssdk_2015_cookie_access_test",t=t||"1",st.isSupport(e,t,0,null,h.is_secure_cookie)}};function Ti(e,t){let r="";if(h.cross_subdomain===!1){try{if(!t){let i=location.host;Oe(s.para.white_list[i])||(r=s.para.white_list[i])}}catch(i){A(i)}r=typeof r=="string"&&r!==""?`sajssdk_2015_${h.sdk_id}${e}_${r.replace(/\./g,"_")}`:`sajssdk_2015_root_${h.sdk_id}${e}`}else r=`sajssdk_2015_cross_${h.sdk_id}${e}`;return r}function nr(){return Be.isSupport()?Be.get("sensorsdata_is_new_user")!==null||Be.get(Ti("new_user"))!==null:ar.get(ar.getNewUserFlagMemoryKey("new_user"))!==null}Be.getNewUser=nr;var ar={data:{},get(e){let t=this.data[e];return t===void 0?null:t._expirationTimestamp_!==void 0?new Date().getTime()>t._expirationTimestamp_?null:t.value:t},set(e,t,r){if(r){let i=new Date;t={value:t,_expirationTimestamp_:String(r).slice(-1)==="s"?i.getTime()+1e3*Number(String(r).slice(0,-1)):i.getTime()+24*r*60*60*1e3}}this.data[e]=t},getNewUserFlagMemoryKey(e){return`sajssdk_2015_${h.sdk_id}${e}`}};let It={checkIsAddSign(e){e.type==="track"&&(nr()?e.properties.$is_first_day=!0:e.properties.$is_first_day=!1)},is_first_visit_time:!1,is_page_first_visited:!1,checkIsFirstTime(e){e.type==="track"&&e.event==="$pageview"&&(this.is_first_visit_time?(e.properties.$is_first_time=!0,this.is_first_visit_time=!1):e.properties.$is_first_time=!1)},setDeviceId(){},storeInitCheck(){if(s.is_first_visitor){let e=new Date,t={h:23-e.getHours(),m:59-e.getMinutes(),s:59-e.getSeconds()};Be.isSupport()?Be.set(Ti("new_user"),"1",`${3600*t.h+60*t.m+t.s}s`):ar.set(ar.getNewUserFlagMemoryKey("new_user"),"1",`${3600*t.h+60*t.m+t.s}s`),this.is_first_visit_time=!0,this.is_page_first_visited=!0}else nr()||(this.checkIsAddSign=function(e){e.type==="track"&&(e.properties.$is_first_day=!1)}),this.checkIsFirstTime=function(e){e.type==="track"&&e.event==="$pageview"&&(e.properties.$is_first_time=!1)}}};function ut(e,t,r){let i=!(!d(h.heatmap)||!h.heatmap.useCapture);return d(h.heatmap)&&Oe(h.heatmap.useCapture)&&t==="click"&&(i=!0),at(e,t,r,i)}let Br=function(){this._events=[],this.pendingEvents=[]};function jt(){let e=document.referrer;if(!e)return!1;try{let t=qe(e).hostname;return t&&t.substring(t.length-9)==="baidu.com"}catch{return!1}}Br.prototype={emit(e){let t=[].slice.call(arguments,1);D(this._events,r=>{r.type===e&&r.callback.apply(r.context,t)}),this.pendingEvents.push({type:e,data:t}),this.pendingEvents.length>20&&this.pendingEvents.shift()},on(e,t,r,i){$(t)&&(this._events.push({type:e,callback:t,context:r||this}),i=i!==!1,this.pendingEvents.length>0&&i&&D(this.pendingEvents,n=>{n.type===e&&t.apply(r,n.data)}))},tempAdd(e,t){if(t&&e)return this.emit(e,t)},isReady(){}};let Nt={data:{},id(){return this.data.id?this.data.id:(this.data.id=xi(),this.data.id)},type(){return this.data.type?this.data.type:(this.data.type=Li(),this.data.type)}};function Li(){let e=At(document.referrer);if(ne(e)||!e.eqid){let t=At(location.href);return e.ck||t.utm_source?"baidu_sem_keyword_id":"baidu_other_keyword_id"}return"baidu_seo_keyword_id"}function xi(){let e=At(document.referrer);return ne(e)||!e.eqid?Ye().replace(/-/g,""):e.eqid}function Ze(e,t){return g(e=e||document.referrer)?((e=wt(e=we(e))).indexOf("https://www.baidu.com/")!==0||t||(e=e.split("?")[0]),g(e=e.slice(0,h.max_referrer_string_length))?e:""):`取值异常_referrer异常_${String(e)}`}function sr(e){if((e=e||document.referrer)==="")return!0;let t=wr(null,Oi,h.is_secure_cookie),r=Te(e);return!(r=`.${r}`).includes(t)&&t!==""}function Ot(e,t){e=e||document.referrer;let r=h.source_type.keyword;if(document&&g(e)){if(e.indexOf("http")===0){let i=Ui(e),n=At(e);if(ne(n))return h.preset_properties.search_keyword_baidu&&jt()?void 0:"未取到值";let a=null;for(let l in r)if(i===l&&d(n)){if(j(a=r[l]))for(l=0;l<a.length;l++){let u=n[a[l]];if(u)return t?{active:u}:u}else if(n[a])return t?{active:n[a]}:n[a]}return h.preset_properties.search_keyword_baidu&&jt()?void 0:"未取到值"}return e===""?"未取到值_直接打开":"未取到值_非http的url"}return`取值异常_referrer异常_${String(e)}`}function Ui(e){let t=Te(e);if(!t||t==="hostname解析异常")return"";let r={baidu:[/^.*\.baidu\.com$/],bing:[/^.*\.bing\.com$/],google:[/^www\.google\.com$/,/^www\.google\.com\.[a-z]{2}$/,/^www\.google\.[a-z]{2}$/],sm:[/^m\.sm\.cn$/],so:[/^.+\.so\.com$/],sogou:[/^.*\.sogou\.com$/],yahoo:[/^.*\.yahoo\.com$/]};for(let i in r)for(let n=r[i],a=0,l=n.length;a<l;a++)if(n[a].test(t))return i;return"未知搜索引擎"}let Ge={distinct_id(){},jssdkDebug(){},_sendDebug(e){},apph5(e){let t="app_h5打通失败-",r={1:`${t}use_app_track为false`,2:`${t}Android或者iOS，没有暴露相应方法`,3.1:`${t}Android校验server_url失败`,3.2:`${t}iOS校验server_url失败`,4.1:`${t}H5 校验 iOS server_url 失败`,4.2:`${t}H5 校验 Android server_url 失败`},i=e.output,n=e.step,a=e.data||"";i!=="all"&&i!=="console"||xe(r[n]),(i==="all"||i==="code")&&d(h.is_debug)&&h.is_debug.apph5&&(a.type&&a.type.slice(0,7)==="profile"||(a.properties._jssdk_debug_info=`apph5-${String(n)}`))},defineMode(e){let t={1:{title:"当前页面无法进行可视化全埋点",message:"App SDK 与 Web JS SDK 没有进行打通，请联系贵方技术人员修正 App SDK 的配置，详细信息请查看文档。",link_text:"",link_url:""},2:{title:"当前页面无法进行可视化全埋点",message:"App SDK 与 Web JS SDK 没有进行打通，请联系贵方技术人员修正 Web JS SDK 的配置，详细信息请查看文档。",link_text:"",link_url:""},3:{title:"当前页面无法进行可视化全埋点",message:"Web JS SDK 没有开启全埋点配置，请联系贵方工作人员修正 SDK 的配置，详细信息请查看文档。",link_text:"",link_url:""},4:{title:"当前页面无法进行可视化全埋点",message:"Web JS SDK 配置的数据校验地址与 App SDK 配置的数据校验地址不一致，请联系贵方工作人员修正 SDK 的配置，详细信息请查看文档。",link_text:"",link_url:""}};return!(!e||!t[e])&&t[e]},protocol:{protocolIsSame(e,t){try{if(qe(e).protocol!==qe(t).protocol)return!1}catch{return k("不支持 _.URL 方法"),!1}return!0},serverUrl(){g(h.server_url)&&h.server_url!==""&&!this.protocolIsSame(h.server_url,location.href)&&k(`SDK 检测到您的数据发送地址和当前页面地址的协议不一致，建议您修改成一致的协议。
因为：1、https 下面发送 http 的图片请求会失败。2、http 页面使用 https + ajax 方式发数据，在 ie9 及以下会丢失数据。`)},ajax(e){if(e===h.server_url)return!1;g(e)&&e!==""&&!this.protocolIsSame(e,location.href)&&k("SDK 检测到您的数据发送地址和当前页面地址的协议不一致，建议您修改成一致的协议。因为 http 页面使用 https + ajax 方式发数据，在 ie9 及以下会丢失数据。")}}};var T={initPage(){let e=Ze(),t=oe(),r=Ar(t);r||Ge.jssdkDebug(`url_domain异常_${t}_${r}`),this.pageProp={referrer:e,referrer_host:e?Te(e):"",url:t,url_host:Te(t,"url_host取值异常"),url_domain:r}},pageProp:{},campaignParams(){return s.kit.getUtmData()},campaignParamsStandard(e,t){e=e||"",t=t||"";let r=T.campaignParams(),i={},n={};return D(r,(a,l,u)=>{` ${Ni} `.includes(` ${l} `)?i[e+l]=u[l]:n[t+l]=u[l]}),{$utms:i,otherUtms:n}},properties(){let e=window.innerHeight||document.documentElement.clientHeight||document.body&&document.body.clientHeight||0,t=window.innerWidth||document.documentElement.clientWidth||document.body&&document.body.clientWidth||0;return{$timezone_offset:new Date().getTimezoneOffset(),$screen_height:Number(screen.height)||0,$screen_width:Number(screen.width)||0,$viewport_height:e,$viewport_width:t,$lib:"js",$lib_version:ir}},currentProps:{},register(e){P(T.currentProps,e)}};function Ir(){function e(l,u){for(let p=0;p<l.length;p++)if(u.split("?")[0].includes(l[p]))return!0}let t=`(${h.source_type.utm.join("|")})\\=[^&]+`,r=h.source_type.search,i=h.source_type.social,n=document.referrer||"",a=T.pageProp.url;if(a){let l=a.match(new RegExp(t));return l&&l[0]?"付费广告流量":e(r,n)?"自然搜索流量":e(i,n)?"社交网站流量":n===""?"直接流量":"引荐流量"}return"获取url异常"}function Ri(e){let t=Ke(e,"gdt_vid"),r=Ke(e,"hash_key"),i=Ke(e,"callbacks"),n={click_id:"",hash_key:"",callbacks:""};return g(t)&&t.length&&(n.click_id=t.length==16||t.length==18?t:"参数解析不合法",g(r)&&r.length&&(n.hash_key=r),g(i)&&i.length&&(n.callbacks=i)),n}function Hi(e){let t=e.properties,r=JSON.parse(JSON.stringify(e));d(t)&&D(t,(i,n)=>{if($(i))try{t[n]=i(r),$(t[n])&&(k(`您的属性- ${n} 格式不满足要求，我们已经将其删除`),delete t[n])}catch{delete t[n],k(`您的属性- ${n} 抛出了异常，我们已经将其删除`)}})}function Ji(e){if(d(e)&&e.$option){let t=e.$option;return delete e.$option,t}return{}}function Mi(e){let t={};return D(e,(r,i)=>{r!=null&&(t[i]=r)}),t}function Ba(e){let t=!e.type||e.type.slice(0,7)!=="profile";d(e.properties)&&t&&("$referrer"in e.properties&&(e.properties.$referrer_host=e.properties.$referrer===""?"":Te(e.properties.$referrer,"取值异常")),h.preset_properties.latest_referrer&&h.preset_properties.latest_referrer_host&&(e.properties.$latest_referrer_host=e.properties.$latest_referrer===""?"":Te(e.properties.$latest_referrer,"取值异常")))}function Ia(e){let t=!e.type||e.type.slice(0,7)!=="profile",r=h.preset_properties&&t;r&&h.preset_properties.url&&Oe(e.properties.$url)&&(e.properties.$url=oe()),r&&h.preset_properties.title&&Oe(e.properties.$title)&&(e.properties.$title=document.title)}function qi(e){if(!re(e.target))return!1;let t=e.target,r=g(t.tagName)?t.tagName.toLowerCase():"unknown",i={};return i.$element_type=r,i.$element_name=t.getAttribute("name"),i.$element_id=t.getAttribute("id"),i.$element_class_name=g(t.className)?t.className:null,i.$element_target_url=t.getAttribute("href"),i.$element_content=or(t,r),(i=Mi(i)).$url=oe(),i.$url_path=ot(),i.$title=document.title,i}function ja(e){let t=h.heatmap&&$(h.heatmap.collect_input)&&h.heatmap.collect_input(e);return(e.type==="button"||e.type==="submit"||t)&&e.value||""}function or(e,t){return g(t)&&t.toLowerCase()==="input"?ja(e):Si(e,t)}function jr(e){return Ge.protocol.ajax(e.url),hi(e)}function Ki(e,t){if(typeof e=="string"&&(e=we(e))&&(e.slice(0,3)==="://"?e=location.protocol.slice(0,-1)+e:e.slice(0,2)==="//"?e=location.protocol+e:e.slice(0,4)!=="http"&&(e="")),j(e)&&e.length)for(let r=0;r<e.length;r++)/sa\.gif[^/]*$/.test(e[r])||(e[r]=e[r].replace(/\/sa$/,"/sa.gif").replace(/(\/sa)(\?[^/]+)$/,"/sa.gif$2"));else/sa\.gif[^/]*$/.test(e)||typeof e!="string"||(e=e.replace(/\/sa$/,"/sa.gif").replace(/(\/sa)(\?[^/]+)$/,"/sa.gif$2"));return t&&typeof t=="string"&&(e=t),e}function Vi(e){g(e)||(e=JSON.stringify(e));let t=Dt(e),r=`crc=${ki(t)}`;return`data=${encodeURIComponent(t)}&ext=${encodeURIComponent(r)}`}function Na(e){let t,r=location.href,i=window.history.pushState,n=window.history.replaceState;$(window.history.pushState)&&(window.history.pushState=function(){i.apply(window.history,arguments),e(r),r=location.href}),$(window.history.replaceState)&&(window.history.replaceState=function(){n.apply(window.history,arguments),e(r),r=location.href}),t=window.document.documentMode?"hashchange":i?"popstate":"hashchange",at(window,t,()=>{e(r),r=location.href})}let W={},Nr=new Ce;function Wi(e,t){let r=[];typeof e=="string"&&e in W.EVENT_LIST&&(r=W.EVENT_LIST[e],W[r[0]].on(r[1],t))}W.spa=Nr,W.sdk=new Ce,W.data=new Ce,W.initSystemEvent=function(){Na(e=>{Nr.emit("switch",e)})},W.EVENT_LIST={spaSwitch:["spa","switch"],sdkBeforeInit:["sdk","beforeInit"],sdkInitPara:["sdk","initPara"],sdkAfterInitPara:["sdk","afterInitPara"],sdkInitAPI:["sdk","initAPI"],sdkAfterInitAPI:["sdk","afterInitAPI"],sdkAfterInit:["sdk","afterInit"],sdkReady:["sdk","ready"],dataSendSuccess:["data","sendSuccess"],dataSendFail:["data","sendFail"]};let Or=function(e){this.callback=e.callback,this.server_url=e.server_url,this.data=e.data,this.origin_data=e.origin_data};Or.prototype.start=function(){let e=this,t=new Date;jr({url:this.server_url,type:"POST",data:e.data,credentials:!1,timeout:h.datasend_timeout,cors:!0,success(r,i){W.data.emit("sendSuccess",{status:String(i),resText:r,type:"ajax_single",timeout_config:h.datasend_timeout,request_timeout:new Date-t,data:e.origin_data}),e.end()},error(r,i){W.data.emit("sendFail",{status:String(i),resText:r,type:"ajax_single",timeout_config:h.datasend_timeout,request_timeout:new Date-t,data:e.origin_data}),e.end()}})},Or.prototype.end=function(){if(this.callback){if(xe("warning: sdk callback is deprecated."),!$(this.callback))return void xe("error: sdk callback must be function.");this.callback()}};let zi="sawebjssdk-",Tr="tab-sawebjssdk-";function Xi(){this.sendTimeStamp=0,this.timer=null,this.serverUrl="",this.hasTabStorage=!1}Xi.prototype={batchInterval(){this.serverUrl===""&&this.getServerUrl(),this.hasTabStorage||(this.generateTabStorage(),this.hasTabStorage=!0);let e=this;e.timer=setTimeout(()=>{e.updateExpireTime(),e.recycle(),e.send(),clearTimeout(e.timer),e.batchInterval()},h.batch_send.send_interval)},getServerUrl(){if(!(g(h.server_url)&&h.server_url!==""||j(h.server_url)&&h.server_url.length))return A("当前 server_url 为空或不正确，只在控制台打印日志，network 中不会发数据，请配置正确的 server_url！");this.serverUrl=j(h.server_url)?h.server_url[0]:h.server_url},send(){if(this.sendTimeStamp&&pe()-this.sendTimeStamp<h.batch_send.send_interval)return!1;let e=I.get(this.tabKey);if(e){this.sendTimeStamp=pe();let i=er((e=te(e)||this.generateTabStorageVal()).data);if(i.length){for(var t=[],r=0;r<i.length;r++){let n=s.store.readObjectVal(i[r]);n&&(n._flush_time=new Date().getTime(),t.push(n))}t.length&&this.request(t,e.data)}}},updateExpireTime(){let e=I.get(this.tabKey);e&&((e=te(e)||this.generateTabStorageVal()).expireTime=pe()+2*h.batch_send.send_interval,e.serverUrl=this.serverUrl,I.set(this.tabKey,JSON.stringify(e)))},request(e,t){let r=this,i=new Date;jr({url:this.serverUrl,type:"POST",data:`data_list=${encodeURIComponent(Dt(JSON.stringify(e)))}`,credentials:!1,timeout:h.batch_send.datasend_timeout,cors:!0,success(n,a){W.data.emit("sendSuccess",{status:String(a),resText:n,type:"ajax_batch",timeout_config:h.batch_send.datasend_timeout,request_timeout:new Date-i,data:e}),r.remove(t),r.sendTimeStamp=0},error(n,a){W.data.emit("sendFail",{status:String(a),resText:n,type:"ajax_batch",timeout_config:h.batch_send.datasend_timeout,request_timeout:new Date-i,data:e}),r.sendTimeStamp=0}})},remove(e){let t=I.get(this.tabKey);if(t){for(var r=(te(t)||this.generateTabStorageVal()).data,i=0;i<e.length;i++){let n=ie(r,e[i]);n>-1&&r.splice(n,1),I.remove(e[i])}r=er(r),I.set(this.tabKey,JSON.stringify(this.generateTabStorageVal(r)))}},add(e){let t=zi+String(ge()),r=I.get(this.tabKey);r===null?(this.tabKey=Tr+String(ge()),r=this.generateTabStorageVal()):r=te(r)||this.generateTabStorageVal(),r.data.push(t),r.expireTime=pe()+2*h.batch_send.send_interval,I.set(this.tabKey,JSON.stringify(r)),s.store.saveObjectVal(t,e),e.type!=="track_signup"&&e.event!=="$pageview"||this.sendImmediately()},generateTabStorage(){this.tabKey=Tr+String(ge()),I.set(this.tabKey,JSON.stringify(this.generateTabStorageVal()))},generateTabStorageVal(e){return{data:e=e||[],expireTime:pe()+2*h.batch_send.send_interval,serverUrl:this.serverUrl}},sendImmediately(){this.send()},recycle(){for(var e={},t=0;t<localStorage.length;t++){let a=localStorage.key(t);var r=this;if(a.indexOf(Tr)===0){for(var i=te(I.get(a))||this.generateTabStorageVal(),n=0;n<i.data.length;n++)e[i.data[n]]=!0;a!==r.tabKey&&pe()>i.expireTime&&this.serverUrl===i.serverUrl&&new zt("sajssdk-lock-get-").get(a,1e4,1e3,l=>{if(l){I.get(r.tabKey)===null&&r.generateTabStorage();let u=te(l)||r.generateTabStorageVal(),p=te(I.get(r.tabKey))||r.generateTabStorageVal();p.data=er(p.data.concat(u.data)),I.set(r.tabKey,JSON.stringify(p))}})}else if(a.indexOf("sajssdk-lock-get-")===0){let l=te(I.get(a))||{expireTime:0};pe()-l.expireTime>1e4&&I.remove(a)}}for(let a=0;a<localStorage.length;a++){let l=localStorage.key(a);l.indexOf(zi)!==0||e[l]||I.remove(l)}}};let Lr=function(e){this.callback=e.callback,this.server_url=e.server_url,this.data=e.data};Lr.prototype.start=function(){let e=this;typeof navigator=="object"&&typeof navigator.sendBeacon=="function"&&navigator.sendBeacon(this.server_url,this.data),setTimeout(()=>{e.end()},40)},Lr.prototype.end=function(){if(this.callback){if(xe("warning: sdk callback is deprecated."),!$(this.callback))return void xe("error: sdk callback must be function.");this.callback()}};let lr=function(e){this.callback=e.callback,this.img=document.createElement("img"),this.img.width=1,this.img.height=1,h.img_use_crossorigin&&(this.img.crossOrigin="anonymous"),this.server_url=e.data};lr.prototype.start=function(){let e=this;h.ignore_oom&&(this.img.onload=function(){this.onload=null,this.onerror=null,this.onabort=null,e.end()},this.img.onerror=function(){this.onload=null,this.onerror=null,this.onabort=null,e.end()},this.img.onabort=function(){this.onload=null,this.onerror=null,this.onabort=null,e.end()}),this.img.src=this.server_url},lr.prototype.lastClear=function(){$r().ie!==void 0?this.img.src="about:blank":this.img.src=""},lr.prototype.end=function(){if(this.callback){if(xe("warning: sdk callback is deprecated."),!$(this.callback))return void xe("error: sdk callback must be function.");this.callback()}self.lastClear&&self.lastClear()};let Oa={__proto__:null,addEvent:ut,EventEmitterSa:Br,cookie:Be,info:T,getReferrer:Ze,getCurrentDomain:Ar,isBaiduTraffic:jt,getReferrerEqid:xi,getReferrerEqidType:Li,getBaiduKeyword:Nt,isReferralTraffic:sr,getKeywordFromReferrer:Ot,getReferSearchEngine:Ui,getSourceFromReferrer:Ir,getWxAdIdFromUrl:Ri,parseSuperProperties:Hi,searchConfigData:Ji,strip_empty_properties:Mi,getEleInfo:qi,getElementContent:or,ajax:jr,optimizeServerUrl:Ki,encodeTrackData:Vi,AjaxSend:Or,BatchSend:Xi,BeaconSend:Lr,ImageSend:lr},Yi=new Br;var c={requests:[],_sessionState:{},_state:{distinct_id:"",first_id:"",props:{},identities:{}},getProps(){return this._state.props||{}},getSessionProps(){},getOriginDistinctId(){return this._state._distinct_id||this._state.distinct_id},getOriginUnionId(e){let t={},r=(e=e||this._state)._first_id||e.first_id,i=e._distinct_id||e.distinct_id;return r&&i?(t.login_id=i,t.anonymous_id=r):t.anonymous_id=i,t},getIdentities(){let e=JSON.parse(JSON.stringify(this._state.identities));return e.$identity_anonymous_id=this.getAnonymousId(),e},getAnonymousId(){return c._state._first_id||c._state.first_id||c._state._distinct_id||c._state.distinct_id},getDistinctId(){let e=this.getUnionId();return e.login_id||e.anonymous_id},getUnionId(e){let t=this.getOriginUnionId(e);return t.login_id&&this._state.history_login_id&&this._state.history_login_id.name&&this._state.history_login_id.name!==Bt.LOGIN&&(t.login_id=`${this._state.history_login_id.name}+${t.login_id}`),t},getFirstId(){return this._state._first_id||this._state.first_id},initSessionState(){},setOnce(e,t){e in this._state||this.set(e,t)},set(e,t){this._state=this._state||{};let r=this._state.distinct_id;this._state[e]=t,e==="first_id"?delete this._state._first_id:e==="distinct_id"&&delete this._state._distinct_id,this.save(),e==="distinct_id"&&r&&Yi.tempAdd("changeDistinctId",t)},change(e,t){this._state[`_${e}`]=t},setSessionProps(){s.log("initSessionState 方法已经弃用，请不要使用该功能，如有需求联系技术顾问")},setSessionPropsOnce(){s.log("initSessionState 方法已经弃用，请不要使用该功能，如有需求联系技术顾问")},setProps(e,t){let r={};for(let i in r=t?e:P(this._state.props||{},e))typeof r[i]=="string"&&(r[i]=r[i].slice(0,s.para.max_referrer_string_length));this.set("props",r)},setPropsOnce(e){let t=this._state.props||{};yi(t,e),this.set("props",t)},clearAllProps(e){let t;if(j(e)&&e.length>0)for(t=0;t<e.length;t++)g(e[t])&&!e[t].includes("latest_")&&d(this._state.props)&&e[t]in this._state.props&&delete this._state.props[e[t]];else if(d(this._state.props))for(t in this._state.props)t.indexOf("latest_")!==1&&delete this._state.props[t];this.sessionSave({}),this.save()},sessionSave(){s.log("initSessionState 方法已经弃用，请不要使用该功能，如有需求联系技术顾问")},save(){let e=JSON.parse(JSON.stringify(this._state));delete e._first_id,delete e._distinct_id,e.identities&&(e.identities=Dt(JSON.stringify(e.identities)));let t=JSON.stringify(e);s.para.encrypt_cookie&&(t=s.kit.userEncrypt(t)),Be.set(this.getCookieName(),t,360,s.para.cross_subdomain)},getCookieName(){let e="";if(s.para.cross_subdomain===!1){try{let t=location.host;Oe(s.para.white_list[t])||(e=s.para.white_list[t])}catch(t){k(t)}e=typeof e=="string"&&e!==""?`sa_jssdk_2015_${s.para.sdk_id}${e.replace(/\./g,"_")}`:`sa_jssdk_2015_root${s.para.sdk_id}`}else e=`sensorsdata2015jssdkcross${s.para.sdk_id}`;return e},init(){this.initSessionState();let e,t,r=Ye();Be.isSupport()&&(e=Be.get(this.getCookieName()),t=te(e=s.kit.userDecryptIfNeeded(e))),Be.isSupport()&&e!==null&&Zt(e)&&d(t)&&(!d(t)||t.distinct_id)?(c._state=P(function(i){let n;i.identities&&(i.identities.indexOf(`
/`)===0?i.identities=te(Ii(i.identities)):i.identities=te(bt(i.identities)));let a=c.getOriginUnionId(i);i.identities&&d(i.identities)&&!ne(i.identities)||(i.identities={},i.identities.$identity_cookie_id=Ye()),i.history_login_id=i.history_login_id||{};let l=i.history_login_id.name;if(a.login_id)if(l&&i.identities.hasOwnProperty(l)){if(i.identities[l]!==a.login_id){for(n in i.identities[l]=a.login_id,i.identities)i.identities.hasOwnProperty(n)&&n!=="$identity_cookie_id"&&n!==l&&delete i.identities[n];i.history_login_id.value=a.login_id}}else{let u=l||Bt.LOGIN;for(n in i.identities[u]=a.login_id,i.identities)i.identities.hasOwnProperty(n)&&n!=="$identity_cookie_id"&&n!==u&&delete i.identities[n];i.history_login_id={name:u,value:a.login_id}}else{if(i.identities.hasOwnProperty("$identity_login_id")||i.identities.hasOwnProperty(l))for(n in i.identities)i.identities.hasOwnProperty(n)&&n!=="$identity_cookie_id"&&n!=="$identity_anonymous_id"&&delete i.identities[n];i.history_login_id={name:"",value:""}}return i}(t)),c.save()):(s.is_first_visitor=!0,function(i){c.set("distinct_id",i),c.set("identities",{$identity_cookie_id:i}),c.set("history_login_id",{name:"",value:""})}(r)),It.setDeviceId(r,this),It.storeInitCheck()},saveObjectVal(e,t){g(t)||(t=JSON.stringify(t)),s.para.encrypt_cookie==1&&(t=s.kit.userEncrypt(t)),I.set(e,t)},readObjectVal(e){let t=I.get(e);return t?te(t=s.kit.userDecryptIfNeeded(t)):null}};let V={string(e){k(`${e} must be string`)},emptyString(e){k(`${e}'s is empty`)},regexTest(e){k(`${e} is invalid`)},idLength(e){k(`${e} length is longer than ${h.max_id_length}`)},keyLength(e){k(`${e} length is longer than ${h.max_key_length}`)},stringLength(e){k(`${e} length is longer than ${h.max_string_length}`)},voidZero(e){k(`${e}'s is undefined`)},reservedLoginId(e){k(`${e} is invalid`)},reservedBind(e){k(`${e} is invalid`)},reservedUnbind(e){k(`${e} is invalid`)}},Zi={regName:/^((?!^distinct_id$|^original_id$|^time$|^properties$|^id$|^first_id$|^second_id$|^users$|^events$|^event$|^user_id$|^date$|^datetime$|^user_tag.*|^user_group.*)[a-z_$][\w$]*)$/i,loginIDReservedNames:["$identity_anonymous_id","$identity_cookie_id"],bindReservedNames:["$identity_login_id","$identity_anonymous_id","$identity_cookie_id"],unbindReservedNames:["$identity_anonymous_id",Bt.LOGIN],string(e){return!!g(e)},emptyString(e){return!(!g(e)||we(e).length===0)},regexTest(e){return!(!g(e)||!this.regName.test(e))},idLength(e){return!(!g(e)||e.length>h.max_id_length)},keyLength(e){return!(!g(e)||e.length>h.max_key_length)},stringLength(e){return!(!g(e)||e.length>h.max_string_length)},voidZero(e){return e!==void 0},reservedLoginId(e){return!(ie(this.loginIDReservedNames,e)>-1)},reservedUnbind(e){return!(ie(this.unbindReservedNames,e)>-1)},reservedBind(e){let t=c._state.history_login_id;return(!t||!t.name||t.name!==e)&&!(ie(this.bindReservedNames,e)>-1)}},Ta={distinct_id:{rules:["string","emptyString","idLength"],onComplete(e,t,r){return!e&&(r==="emptyString"&&(t="Id"),$(V[r])&&V[r](t),r==="idLength")||e}},event:{rules:["string","emptyString","keyLength","regexTest"],onComplete(e,t,r){return e||(r==="emptyString"&&(t="eventName"),$(V[r])&&V[r](t)),!0}},propertyKey:{rules:["string","emptyString","keyLength","regexTest"],onComplete(e,t,r){return e||(r==="emptyString"&&(t="Property key"),$(V[r])&&V[r](t)),!0}},propertyValue:{rules:["voidZero"],onComplete(e,t,r){return e||$(V[r])&&V[r]("Property Value"),!0}},properties(e){return d(e)?D(e,(t,r)=>{J({propertyKey:r}),J({propertyValue:t},(i,n,a)=>(i||(n=`${r}'s Value`,$(V[a])&&V[a](n)),!0))}):Zi.voidZero(e)&&k("properties可以没有，但有的话必须是对象"),!0},propertiesMust(e){return e!==void 0&&d(e)&&!ne(e)?this.properties.call(this,e):k("properties必须是对象"),!0},item_type:{rules:["string","emptyString","keyLength","regexTest"],onComplete(e,t,r){return e||(r==="emptyString"&&(t="item_type"),$(V[r])&&V[r](t)),!0}},item_id:{rules:["string","emptyString","stringLength"],onComplete(e,t,r){return e||(r==="emptyString"&&(t="item_id"),$(V[r])&&V[r](t)),!0}},loginIdKey:{rules:["string","emptyString","keyLength","regexTest","reservedLoginId"],onComplete(e,t,r){return!e&&(r==="emptyString"&&(t="login_id_key"),$(V[r])&&V[r](t),r==="keyLength")||e}},bindKey:{rules:["string","emptyString","keyLength","regexTest","reservedBind"],onComplete(e,t,r){return!e&&(r==="emptyString"&&(t="Key"),$(V[r])&&V[r](t),r==="keyLength")||e}},unbindKey:{rules:["string","emptyString","keyLength","regexTest","reservedUnbind"],onComplete(e,t,r){return!e&&(r==="emptyString"&&(t="Key"),$(V[r])&&V[r](t),r==="keyLength")||e}},bindValue:{rules:["string","emptyString","idLength"],onComplete(e,t,r){return!e&&(r==="emptyString"&&(t="Value"),$(V[r])&&V[r](t),r==="idLength")||e}},check(e,t,r){let i=this[e];if($(i))return i.call(this,t);if(!i)return!1;for(let n=0;n<i.rules.length;n++){let a=i.rules[n],l=Zi[a](t),u=$(r)?r(l,t,a):i.onComplete(l,t,a);if(!l)return u}return!0}};function J(e,t){for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&!Ta.check(r,e[r],t))return!1;return!0}function La(e,t){return d(e)&&D(e,(r,i)=>{if(j(r)){let a=[];D(r,l=>{if(g(l))a.push(l);else if(Oe(l))a.push("null");else try{a.push(JSON.stringify(l))}catch{k("您的数据-",i,r,"数组里值有错误,已将其删除")}}),e[i]=a}let n=ie([],i)>-1;if(d(r)&&i!=="$option"&&!n)try{e[i]=JSON.stringify(r)}catch{delete e[i],k("您的数据-",i,r,"数据值有错误，已将其删除")}else g(r)||Le(r)||Pt(r)||Ci(r)||j(r)||$(r)||i==="$option"||n||(k("您的数据-",i,r,"-格式不满足要求，我们已经将其删除"),delete e[i])}),e}function xa(e,t){return Le(t)&&e.length>t?(k(`字符串长度超过限制，已经做截取--${e}`),e.slice(0,t)):e}function Ua(e,t){d(e)&&D(["distinct_id","user_id","id","date","datetime","event","events","first_id","original_id","device_id","properties","second_id","time","users"],(r,i)=>{r in e&&(ie([],r)>-1||(i<3?(delete e[r],k(`您的属性- ${r}是保留字段，我们已经将其删除`)):k(`您的属性- ${r}是保留字段，请避免其作为属性名`)))})}function Gi(e){let t=["$element_selector","$element_path"],r=["sensorsdata_app_visual_properties"];d(e)&&D(e,(i,n)=>{if(d(i))Gi(e[n]);else if(g(i)){if(ie(r,n)>-1)return;e[n]=xa(i,ie(t,n)>-1?1024:h.max_string_length)}})}function Ra(e){typeof e.properties.$project<"u"&&(e.project=e.properties.$project,delete e.properties.$project),typeof e.properties.$token<"u"&&(e.token=e.properties.$token,delete e.properties.$token)}function Ha(e){"item_type"in e&&J({item_type:e.item_type},t=>(t||delete e.item_type,!0)),"item_id"in e&&J({item_id:e.item_id},(t,r,i)=>(t||i!=="string"||delete e.item_id,!0))}function Ja(e,t){D(e,(r,i)=>{ie([],i)===-1&&J({propertyKey:i},(n,a,l)=>(n||l==="keyLength"||delete e[i],!0))})}function Ma(e){let t=e.properties;Er(e),d(t)?(La(t),Ua(t),Ra(e),Ja(t),Gi(t)):"properties"in e&&(e.properties={}),Ha(e)}function qa(e,t){let r=t.sensors;return e._track_id=Number(String(ge()).slice(2,5)+String(ge()).slice(2,4)+String(new Date().getTime()).slice(-4)),e._flush_time=new Date().getTime(),r.events.tempAdd("send",e),e}var Y={initUrl(){let e,t,r={server_url:{project:"",host:""},page_url:{host:"",pathname:""}};if(!Ei(s.para.server_url))return A("----vcollect---server_url必须为有效 URL 字符串"),!1;try{e=qe(s.para.server_url),r.server_url.project=e.searchParams.get("project")||"default",r.server_url.host=e.host}catch(i){return A("----vcollect---server_url解析异常",i),!1}try{t=qe(location.href),r.page_url.host=t.hostname,r.page_url.pathname=t.pathname}catch(i){return A("----vcollect---页面地址解析异常",i),!1}return r},isDiv(e){return!(e.element_path&&we(e.element_path.split(">").pop()).slice(0,3)!=="div")},configIsMatchNew(e,t){if(g(e.$element_selector)&&g(t.element_selector)){if(t.element_field==="element_selector"&&t.function==="equal")return e.$element_selector===t.element_selector;if(t.element_field==="element_selector"&&t.function==="contain")return e.$element_selector.includes(t.element_selector)}if(g(e.$element_path)&&g(t.element_path)){if(t.element_field==="element_path"&&t.function==="equal")return e.$element_path===t.element_path;if(t.element_field==="element_path"&&t.function==="contain")return e.$element_path.includes(t.element_path)}return!1},configIsMatch(e,t){return(!t.limit_element_content||t.element_content===e.$element_content)&&(!t.limit_element_position||t.element_position===String(e.$element_position))&&(t.element_field&&t.function?Y.configIsMatchNew(e,t):Y.configIsMatchOldVersion(e,t))},configIsMatchOldVersion(e,t){if(!t.element_path)return!1;if(e.$element_position!==void 0){if(t.element_path!==e.$element_path)return!1}else if(Y.isDiv({element_path:t.element_path})){if(!e.$element_path.includes(t.element_path))return!1}else if(t.element_path!==e.$element_path)return!1;return!0},filterConfig(e,t,r){let i=[];if(!r){let n=Y.initUrl();if(!n)return[];r=n.page_url}return e.event==="$WebClick"&&D(t,n=>{d(n)&&(n.event_type==="webclick"||n.event_type==="appclick")&&d(n.event)&&n.event.url_host===r.host&&n.event.url_path===r.pathname&&Y.configIsMatch(e.properties,n.event)&&i.push(n)}),i},getPropElInLi(e,t){if(!(e&&re(e)&&g(t))||e.tagName.toLowerCase()!=="li")return null;let r=s.heatmap.getDomSelector(e);return r?Yt(r+t)||null:(k("----custom---获取同级属性元素失败，selector信息异常",r,t),null)},getProp(e,t){if(!d(e))return!1;if(!(g(e.name)&&e.name.length>0))return k("----vcustom----属性名不合法,属性抛弃",e.name),!1;let r,i,n={};if(e.method==="content"){let a;if(g(e.element_selector)&&e.element_selector.length>0)a=Yt(e.element_selector);else{if(!t||!g(e.list_selector))return k("----vcustom----属性配置异常，属性抛弃",e.name),!1;let l=Yt(t.properties.$element_selector);if(!l)return k("----vcustom----点击元素获取异常，属性抛弃",e.name),!1;let u=s.heatmap.getClosestLi(l);a=Y.getPropElInLi(u,e.list_selector)}if(!a||!re(a))return k("----vcustom----属性元素获取失败，属性抛弃",e.name),!1;if(a.tagName.toLowerCase()==="input")r=a.value||"";else if(a.tagName.toLowerCase()==="select"){let l=a.selectedIndex;Le(l)&&re(a[l])&&(r=or(a[l],"select"))}else r=or(a,a.tagName.toLowerCase());if(e.regular){try{i=new RegExp(e.regular).exec(r)}catch{return k("----vcustom----正则处理失败，属性抛弃",e.name),!1}if(i===null)return k("----vcustom----属性规则处理，未匹配到结果,属性抛弃",e.name),!1;if(!j(i)||!g(i[0]))return k("----vcustom----正则处理异常，属性抛弃",e.name,i),!1;r=i[0]}if(e.type==="STRING")n[e.name]=r;else if(e.type==="NUMBER"){if(r.length<1)return k("----vcustom----未获取到数字内容，属性抛弃",e.name,r),!1;if(isNaN(Number(r)))return k("----vcustom----数字类型属性转换失败，属性抛弃",e.name,r),!1;n[e.name]=Number(r)}return n}return A("----vcustom----属性不支持此获取方式",e.name,e.method),!1},getAssignConfigs(e,t){let r=Y.initUrl();if(!r||!r.page_url)return[];if(!d(t))return[];let i=[];return t.events=t.events||t.eventList,j(t.events)&&t.events.length>0?(D(t.events,n=>{d(n)&&d(n.event)&&n.event.url_host===r.page_url.host&&n.event.url_path===r.page_url.pathname&&e(n)&&i.push(n)}),i):[]}};let Ka={events:[],getAssignConfigs:Y.getAssignConfigs,filterConfig:Y.filterConfig,getProp:Y.getProp,initUrl:Y.initUrl,updateEvents(e){j(e)&&(this.events=e)},init(){this.initAppGetPropsBridge()},geth5Props(e){let t={},r=[],i=this;if(!this.events.length)return{};if(e.event==="$WebClick"){let n=this.filterConfig(e,this.events);if(!n.length)return{};D(n,a=>{d(a)&&(j(a.properties)&&a.properties.length>0&&D(a.properties,l=>{if(d(l))if(l.h5===!1)j(t.sensorsdata_app_visual_properties)||(t.sensorsdata_app_visual_properties=[]),t.sensorsdata_app_visual_properties.push(l);else{let u=i.getProp(l,e);d(u)&&(t=P(t,u))}}),g(a.event_name)&&r.push(a.event_name))}),s.bridge.hasVisualModeBridge()&&(t.sensorsdata_web_visual_eventName=r)}return t.sensorsdata_app_visual_properties&&(t.sensorsdata_app_visual_properties=Dt(JSON.stringify(t.sensorsdata_app_visual_properties))),t},initAppGetPropsBridge(){let e=this,t=new s.SDKJSBridge("getJSVisualProperties");return t.onAppNotify(r=>{let i={};try{r=JSON.parse(bt(r))}catch{A("getJSVisualProperties data parse error!")}if(d(r)){let n=r.sensorsdata_js_visual_properties,a=e.initUrl();a&&(a=a.page_url,j(n)&&n.length>0&&D(n,l=>{if(d(l)&&l.url_host===a.host&&l.url_path===a.pathname&&l.h5){let u=e.getProp(l);d(u)&&(i=P(i,u))}}))}return s.bridge.bridge_info.platform==="android"&&t.notifyApp({data:i},r.message_id),i}),t}},xr={events:[],customProp:Ka,getAssignConfigs:Y.getAssignConfigs,initUrl:Y.initUrl,init(){if(this.initUrl()){let e=this.getConfigFromApp();e&&this.updateConfigs(e),this.customProp.init(),this.initAppUpdateConfigBridge()}},initAppUpdateConfigBridge(){let e=this;return new s.SDKJSBridge("updateH5VisualConfig").onAppNotify(t=>{if(t){try{t=JSON.parse(bt(t))}catch{return void A("updateH5VisualConfig result parse error！")}e.updateConfigs(t)}})},getConfigFromApp(){let e=new s.SDKJSBridge("sensorsdata_get_app_visual_config").notifyApp();if(e)try{e=JSON.parse(bt(e))}catch{e=null,A("getAppVisualConfig result parse error！")}return e},updateConfigs(e){this.events=this.filterConfigs(e),this.customProp.updateEvents(this.events)},filterConfigs(e){return this.getAssignConfigs(t=>!(!d(t)||t.h5===!1),e)}},ur={events:[],init(e){this.filterWebClickEvents(e)},filterWebClickEvents(e){this.events=Qe.getAssignConfigs(t=>!(!d(t)||t.event.unlimited_div!==!0||t.event_type!=="webclick"),e)},isTargetEle(e){let t=s.heatmap.getEleDetail(e);if(!d(t)||!g(t.$element_path))return!1;for(let r=0;r<this.events.length;r++)if(d(this.events[r])&&d(this.events[r].event)&&Qe.configIsMatch(t,this.events[r].event))return!0;return!1}},Qi={events:[],configSwitch:!1,collectAble(){return this.configSwitch&&d(s.para.heatmap)&&s.para.heatmap.get_vtrack_config},updateEvents(e){this.events=Qe.getAssignConfigs(t=>!!(d(t)&&j(t.properties)&&t.properties.length>0),e),this.events.length?this.configSwitch=!0:this.configSwitch=!1},getVtrackProps(e){let t={};return this.collectAble()?(e.event==="$WebClick"&&(t=this.clickCustomPropMaker(e,this.events)),t):{}},clickCustomPropMaker(e,t,r){let i=this;r=r||this.filterConfig(e,t,Qe.url_info.page_url);let n={};return r.length?(D(r,a=>{j(a.properties)&&a.properties.length>0&&D(a.properties,l=>{let u=i.getProp(l,e);d(u)&&P(n,u)})}),n):{}},getProp:Y.getProp,getPropElInLi:Y.getPropElInLi,filterConfig:Y.filterConfig};var Qe={unlimitedDiv:ur,config:{},storageEnable:!0,storage_name:"webjssdkvtrackcollect",para:{session_time:18e5,timeout:5e3,update_interval:18e5},url_info:{},timer:null,update_time:null,customProp:Qi,initUrl(){let e=Y.initUrl();if(e){let t;try{(t=new vr(s.para.server_url))._values.Path="/config/visualized/Web.conf",e.api_url=t.getUrl()}catch(r){return A("----vtrackcollect---API地址解析异常",r),!1}this.url_info=e}return e},init(){if(!d(s.para.heatmap)||!s.para.heatmap.get_vtrack_config)return!1;if(I.isSupport()||(this.storageEnable=!1),!this.initUrl())return A("----vtrackcustom----初始化失败，url信息解析失败"),!1;if(this.storageEnable){let e=c.readObjectVal(this.storage_name);if(d(e)&&d(e.data))if(this.serverUrlIsSame(e.serverUrl)){this.config=e.data,this.update_time=e.updateTime,this.updateConfig(e.data);let t=new Date().getTime()-this.update_time;if(Le(t)&&t>0&&t<this.para.session_time){let r=this.para.update_interval-t;this.setNextFetch(r)}else this.getConfigFromServer()}else this.getConfigFromServer();else this.getConfigFromServer()}else this.getConfigFromServer();this.pageStateListenner()},serverUrlIsSame(e){return!!d(e)&&e.host===this.url_info.server_url.host&&e.project===this.url_info.server_url.project},getConfigFromServer(){let e=this;this.sendRequest((t,r)=>{e.update_time=new Date().getTime();let i={};t===200?r&&d(r)&&r.os==="Web"&&(i=r,e.updateConfig(i)):t===205?e.updateConfig(i):t===304?i=e.config:(A("----vtrackcustom----数据异常",t),e.updateConfig(i)),e.updateStorage(i),e.setNextFetch()},t=>{e.update_time=new Date().getTime(),A("----vtrackcustom----配置拉取失败",t),e.setNextFetch()})},setNextFetch(e){let t=this;this.timer&&(clearTimeout(this.timer),this.timer=null),e=e||this.para.update_interval,this.timer=setTimeout(()=>{t.getConfigFromServer()},e)},pageStateListenner(){let e=this;Ai({visible(){let t=new Date().getTime()-e.update_time;if(Le(t)&&t>0&&t<e.para.update_interval){let r=e.para.update_interval-t;e.setNextFetch(r)}else e.getConfigFromServer()},hidden(){e.timer&&(clearTimeout(e.timer),e.timer=null)}})},updateConfig(e){if(!d(e))return!1;this.config=e,this.customProp.updateEvents(e),this.unlimitedDiv.init(e)},updateStorage(e){if(!this.storageEnable||!d(e))return!1;let t;if(this.url_info.server_url)t=this.url_info.server_url;else{let i=Qe.initUrl();if(!i)return!1;t=i.server_url}let r={updateTime:new Date().getTime(),data:e,serverUrl:t};c.saveObjectVal(this.storage_name,r)},sendRequest(e,t){let r={app_id:this.url_info.page_url.host};this.config.version&&(r.v=this.config.version),Pi({url:this.url_info.api_url,callbackName:"saJSSDKVtrackCollectConfig",data:r,timeout:this.para.timeout,success(i,n){e(i,n)},error(i){t(i)}})},getAssignConfigs:Y.getAssignConfigs,configIsMatch:Y.configIsMatch};function Va(e,t){try{let r=t.sensors,i={};d(e)&&d(e.identities)&&!ne(e.identities)?P(i,e.identities):P(i,c.getIdentities());let n={identities:i,distinct_id:c.getDistinctId(),lib:{$lib:"js",$lib_method:"code",$lib_version:String(r.lib_version)},properties:{}};return d(e)&&d(e.properties)&&!ne(e.properties)&&(e.properties.$lib_detail&&(n.lib.$lib_detail=e.properties.$lib_detail,delete e.properties.$lib_detail),e.properties.$lib_method&&(n.lib.$lib_method=e.properties.$lib_method,delete e.properties.$lib_method)),bi(n,c.getUnionId(),e),d(e.properties)&&!ne(e.properties)&&P(n.properties,e.properties),n.event==="$UnbindID"&&(n.login_id&&delete n.login_id,n.anonymous_id&&delete n.anonymous_id),e.type&&e.type.slice(0,7)==="profile"||(r.para.properties_priority&&r.para.properties_priority===3?n.properties=P({},T.properties(),c.getSessionProps(),T.currentProps,c.getProps(),n.properties):n.properties=P({},T.properties(),c.getProps(),c.getSessionProps(),T.currentProps,n.properties),r.para.preset_properties.latest_referrer&&!g(n.properties.$latest_referrer)&&(n.properties.$latest_referrer="取值异常"),r.para.preset_properties.latest_search_keyword&&!g(n.properties.$latest_search_keyword)&&(r.para.preset_properties.search_keyword_baidu&&g(n.properties.$search_keyword_id)&&Le(n.properties.$search_keyword_id_hash)&&g(n.properties.$search_keyword_id_type)||(n.properties.$latest_search_keyword="取值异常")),r.para.preset_properties.latest_traffic_source_type&&!g(n.properties.$latest_traffic_source_type)&&(n.properties.$latest_traffic_source_type="取值异常"),r.para.preset_properties.latest_landing_page&&!g(n.properties.$latest_landing_page)&&(n.properties.$latest_landing_page="取值异常"),r.para.preset_properties.latest_wx_ad_click_id==="not_collect"?(delete n.properties._latest_wx_ad_click_id,delete n.properties._latest_wx_ad_hash_key,delete n.properties._latest_wx_ad_callbacks):r.para.preset_properties.latest_wx_ad_click_id&&!g(n.properties._latest_wx_ad_click_id)&&(n.properties._latest_wx_ad_click_id="取值异常",n.properties._latest_wx_ad_hash_key="取值异常",n.properties._latest_wx_ad_callbacks="取值异常"),g(n.properties._latest_wx_ad_click_id)&&(n.properties.$url=oe())),n.properties.$time&&Pt(n.properties.$time)?(n.time=1*n.properties.$time,delete n.properties.$time):n.time=1*new Date,function(a){if(r.bridge&&r.bridge.bridge_info.verify_success==="success"){let u=xr.customProp.geth5Props(JSON.parse(JSON.stringify(a)));d(u)&&!ne(u)&&(a.properties=P(a.properties,u))}let l=Qe.customProp.getVtrackProps(JSON.parse(JSON.stringify(a)));d(l)&&!ne(l)&&(a.properties=P(a.properties,l))}(n),Hi(n),It.checkIsAddSign(n),It.checkIsFirstTime(n),Ba(n),Ia(n),n}catch(r){return{_debug_web_msg:String(r)}}}let Ur={stage:null,init(e){this.stage=e},interceptor:{basicProps:{priority:0,entry:Va},formatData:{priority:0,entry:Ma},finalAdjustData:{priority:0,entry:qa}}};function Wa(e){return Ur.stage.process("basicProps",e)}function za(e){return Ur.stage.process("formatData",e)}let le={};function en(e,t,r,i){let n=null;if((e=e||{}).ele&&(n=e.ele),e.event&&(n=e.target?e.target:e.event.target),r=r||{},!n||typeof n!="object")return!1;if(!n.href||n.href.startsWith("javascript")||n.target||n.download||n.onclick)return i(t,r),!1;function a(l){l.stopPropagation(),l.preventDefault();let u=!1;function p(){u||(u=!0,location.href=n.href)}setTimeout(p,1e3),i(t,r,p)}e.event&&a(e.event),e.ele&&ut(e.ele,"click",l=>{a(l)})}function tn(){let e=location.protocol;return e==="http:"||e==="https:"?e:"http:"}le.check=J,le.sendItem=function(e){let t={lib:{$lib:"js",$lib_method:"code",$lib_version:String(s.lib_version)},time:1*new Date};P(t,e),za(t),s.kit.sendData(t)},le.send=function(e,t){let r=s.kit.buildData(e);s.kit.sendData(r,t)};let Rr={stage:null,init(e){this.stage=e}};function Xa(e){return Rr.stage.process("webClickEvent",e)}function Ya(e){return Rr.stage.process("webStayEvent",e)}let Hr={label:!1,li:!1,a:!0,button:!0};var Ee={otherTags:[],initUnlimitedTags(){D(Ee.otherTags,e=>{e in Hr&&(Hr[e]=!0)})},isUnlimitedTag(e){if(!e||e.nodeType!==1)return!1;let t=e.nodeName.toLowerCase();return Hr[t]||Fr(e,s.para.heatmap.track_attr)},getTargetElement(e,t){let r=this,i=e;if(typeof i!="object"||typeof i.tagName!="string")return null;let n=i.tagName.toLowerCase();if(n.toLowerCase()==="body"||n.toLowerCase()==="html"||!i||!i.parentNode||!i.parentNode.children)return null;let a=i.parentNode,l=r.otherTags;if(n==="a"||n==="button"||n==="input"||n==="textarea"||ie(l,n)>-1)return i;if(n==="area"&&a.tagName.toLowerCase()==="map"&&fe(a).prev().tagName&&fe(a).prev().tagName.toLowerCase()==="img")return fe(a).prev();if(n==="div"&&s.para.heatmap.collect_tags.div&&r.isDivLevelValid(i)&&((s.para.heatmap&&s.para.heatmap.collect_tags&&s.para.heatmap.collect_tags.div&&s.para.heatmap.collect_tags.div.max_level||1)>1||r.isCollectableDiv(i)))return i;if(r.isStyleTag(n)&&s.para.heatmap.collect_tags.div){let u=r.getCollectableParent(i);if(u&&r.isDivLevelValid(u))return u}return r.hasElement({event:t&&t.originalEvent||t,element:e},u=>r.isUnlimitedTag(u))||null},getDivLevels(e,t){let r=Ee.getElementPath(e,!0,t).split(" > "),i=0;return D(r,n=>{n==="div"&&i++}),i},isDivLevelValid(e){for(let t=s.para.heatmap&&s.para.heatmap.collect_tags&&s.para.heatmap.collect_tags.div&&s.para.heatmap.collect_tags.div.max_level||1,r=e.getElementsByTagName("div"),i=r.length-1;i>=0;i--)if(Ee.getDivLevels(r[i],e)>t)return!1;return!0},getElementPath(e,t,r){for(var i=[];e.parentNode&&re(e);){if(!g(e.tagName))return"unknown";if(e.id&&!t&&/^[A-Z][-\w:.]*$/i.test(e.id)){i.unshift(`${e.tagName.toLowerCase()}#${e.id}`);break}if(r&&e===r){i.unshift(e.tagName.toLowerCase());break}if(e===document.body){i.unshift("body");break}i.unshift(e.tagName.toLowerCase()),e=e.parentNode}return i.join(" > ")},getClosestLi(e){return function(t,r){for(;t&&t!==document&&t.nodeType===1;t=t.parentNode)if(t.tagName&&g(t.tagName)&&t.tagName.toLowerCase()===r)return t;return null}(e,"li")},getElementPosition(e,t,r){let i=s.heatmap.getClosestLi(e);if(!i||!re(e)||!g(e.tagName))return null;let n=e.tagName.toLowerCase(),a=i.getElementsByTagName(n),l=a.length,u=[];if(l>1){for(let p=0;p<l;p++)s.heatmap.getElementPath(a[p],r)===t&&u.push(a[p]);if(u.length>1)return ie(u,e)}return function(p){if(!p.parentNode)return"";if(fe(p).getSameTypeSiblings().length===1)return 0;for(var b=0,w=p;fe(w).previousElementSibling().ele;w=fe(w).previousElementSibling().ele,b++);return b}(i)},setNotice(e){s.is_heatmap_render_mode=!0,s.para.heatmap||(s.errorMsg="您 SDK 没有配置开启点击图 ！"),e&&e.slice(0,5)==="http:"&&location.protocol==="https:"&&(s.errorMsg="您的当前页面是 https 的地址，神策分析环境也必须是 https ！"),s.para.heatmap_url||(s.para.heatmap_url=`${tn()}//static.sensorsdata.cn/sdk/${s.lib_version}/heatmap.min.js`)},getDomIndex(e){if(!e.parentNode)return-1;for(let t=0,r=e.tagName,i=e.parentNode.children,n=0;n<i.length;n++)if(i[n].tagName===r){if(e===i[n])return t;t++}return-1},selector(e,t){if(!e||!re(e)||!g(e.tagName))return"";let r=e.parentNode&&e.parentNode.nodeType==9?-1:this.getDomIndex(e);return e.getAttribute&&e.getAttribute("id")&&/^[A-Z][-\w:.]*$/i.test(e.getAttribute("id"))&&(!s.para.heatmap||s.para.heatmap&&s.para.heatmap.element_selector!=="not_use_id")&&!t?`#${e.getAttribute("id")}`:e.tagName.toLowerCase()+(~r?`:nth-of-type(${r+1})`:"")},getDomSelector(e,t,r){if(!(e&&e.parentNode&&e.parentNode.children&&g(e.tagName)))return"unknown";t=t&&t.join?t:[];let i=e.nodeName.toLowerCase();return e&&i!=="body"&&e.nodeType==1?(t.unshift(this.selector(e,r)),e.getAttribute&&e.getAttribute("id")&&/^[A-Z][-\w:.]*$/i.test(e.getAttribute("id"))&&s.para.heatmap&&s.para.heatmap.element_selector!=="not_use_id"&&!r?t.join(" > "):this.getDomSelector(e.parentNode,t,r)):(t.unshift("body"),t.join(" > "))},na(){let e=document.documentElement.scrollLeft||window.pageXOffset;return Number.parseInt(isNaN(e)?0:e,10)},i(){let e=0;try{e=o.documentElement&&o.documentElement.scrollTop||m.pageYOffset,e=isNaN(e)?0:e}catch{e=0}return Number.parseInt(e,10)},getBrowserWidth(){let e=window.innerWidth||document.body.clientWidth;return isNaN(e)?0:Number.parseInt(e,10)},getBrowserHeight(){let e=window.innerHeight||document.body.clientHeight;return isNaN(e)?0:Number.parseInt(e,10)},getScrollWidth(){let e=Number.parseInt(document.body.scrollWidth,10);return isNaN(e)?0:e},getEleDetail(e){let t=this.getDomSelector(e),r=qi({target:e});r.$element_selector=t||"",r.$element_path=s.heatmap.getElementPath(e,s.para.heatmap&&s.para.heatmap.element_selector==="not_use_id");let i=s.heatmap.getElementPosition(e,r.$element_path,s.para.heatmap&&s.para.heatmap.element_selector==="not_use_id");return Le(i)&&(r.$element_position=i),r},getPointerEventProp(e,t){if(!e)return{};function r(){return{scrollLeft:document.body.scrollLeft||document.documentElement.scrollLeft||0,scrollTop:document.body.scrollTop||document.documentElement.scrollTop||0}}function i(a){if(document.documentElement.getBoundingClientRect){let l=a.getBoundingClientRect();return{targetEleX:l.left+r().scrollLeft||0,targetEleY:l.top+r().scrollTop||0}}}function n(a){return Number(Number(a).toFixed(3))}return function(a){let l=a.pageX||a.clientX+r().scrollLeft||a.offsetX+i(t).targetEleX||0,u=a.pageY||a.clientY+r().scrollTop||a.offsetY+i(t).targetEleY||0;return{$page_x:n(l),$page_y:n(u)}}(e)},start(e,t,r,i,n){if(d(s.para.heatmap)&&$(s.para.heatmap.collect_element)&&!s.para.heatmap.collect_element(t))return!1;Xa(Ee.getBasicEleInfo(e,t,r,i,n))},getBasicEleInfo(e,t,r,i,n){let a=d(i)?i:{},l=$(n)?n:$(i)?i:void 0,u=this.getEleDetail(t);if(s.para.heatmap&&s.para.heatmap.custom_property){let p=s.para.heatmap.custom_property(t);d(p)&&(u=P(u,p))}return{event:e,target:t,props:u=P(u,this.getPointerEventProp(e,t),a),tagName:r,callback:l}},hasElement(e,t){let r;if(e.event){let i=e.event;r=i.path||i._getPath&&i._getPath()}else e.element&&(r=fe(e.element).getParents());if(r&&j(r)&&r.length>0){for(let i=0;i<r.length;i++)if(typeof r[i]=="object"&&r[i].nodeType===1&&t(r[i]))return r[i]}},isStyleTag(e,t){return!(ie(["a","div","input","button","textarea"],e)>-1)&&(!t||s.para.heatmap&&s.para.heatmap.collect_tags&&s.para.heatmap.collect_tags.div?!!(d(s.para.heatmap)&&d(s.para.heatmap.collect_tags)&&d(s.para.heatmap.collect_tags.div)&&j(s.para.heatmap.collect_tags.div.ignore_tags)&&ie(s.para.heatmap.collect_tags.div.ignore_tags,e)>-1):ie(["mark","/mark","strong","b","em","i","u","abbr","ins","del","s","sup"],e)>-1)},isCollectableDiv(e,t){try{if(e.children.length===0)return!0;for(let r=0;r<e.children.length;r++)if(e.children[r].nodeType===1){let i=g(e.children[r].tagName)?e.children[r].tagName.toLowerCase():"unknown",n=s.para&&s.para.heatmap&&s.para.heatmap.collect_tags&&s.para.heatmap.collect_tags.div&&s.para.heatmap.collect_tags.div.max_level;if(!(i==="div"&&n>1||this.isStyleTag(i,t))||!this.isCollectableDiv(e.children[r],t))return!1}return!0}catch(r){A(`isCollectableDiv:${r}`)}return!1},getCollectableParent(e,t){try{let r=e.parentNode,i=r?r.tagName.toLowerCase():"";if(i==="body")return!1;let n=s.para&&s.para.heatmap&&s.para.heatmap.collect_tags&&s.para.heatmap.collect_tags.div&&s.para.heatmap.collect_tags.div.max_level;if(i&&i==="div"&&(n>1||this.isCollectableDiv(r,t)))return r;if(r&&this.isStyleTag(i,t))return this.getCollectableParent(r,t)}catch(r){A(`getCollectableParent:${r}`)}return!1},listenUrlChange(e){e(),s.ee.spa.on("switch",()=>{e()})},initScrollmap(){if(!d(s.para.heatmap)||s.para.heatmap.scroll_notice_map!=="default")return!1;let e=!0;s.para.scrollmap&&$(s.para.scrollmap.collect_url)&&this.listenUrlChange(()=>{e=!!s.para.scrollmap.collect_url()});let t=function(r){let i={};return i.timeout=r.timeout||1e3,i.func=r.func,i.hasInit=!1,i.inter=null,i.main=function(n,a){this.func(n,a),this.inter=null},i.go=function(n){let a={};this.inter||(a.$viewport_position=document.documentElement&&document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop||0,a.$viewport_position=Math.round(a.$viewport_position)||0,n?i.main(a,!0):this.inter=setTimeout(()=>{i.main(a)},this.timeout))},i}({timeout:1e3,func(r,i){let n=document.documentElement&&document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop||0,a=new Date,l=a-this.current_time;(l>s.para.heatmap.scroll_delay_time&&n-r.$viewport_position!=0||i)&&(r.$url=oe(),r.$title=document.title,r.$url_path=ot(),r.event_duration=Math.min(s.para.heatmap.scroll_event_duration,Number.parseInt(l)/1e3),r.event_duration=r.event_duration<0?0:r.event_duration,Ya(r)),this.current_time=a}});t.current_time=new Date,ut(window,"scroll",()=>{if(!e)return!1;t.go()}),ut(window,"beforeunload",()=>{if(!e)return!1;t.go("notime")})},initHeatmap(){let e=this,t=!0;if(!d(s.para.heatmap)||s.para.heatmap.clickmap!=="default")return!1;$(s.para.heatmap.collect_url)&&this.listenUrlChange(()=>{t=!!s.para.heatmap.collect_url()}),s.para.heatmap.collect_elements==="all"?s.para.heatmap.collect_elements="all":s.para.heatmap.collect_elements="interact",s.para.heatmap.collect_elements==="all"?ut(document,"click",r=>{if(!t)return!1;let i=r||window.event;if(!i)return!1;let n=i.target||i.srcElement;if(typeof n!="object"||typeof n.tagName!="string")return!1;let a=n.tagName.toLowerCase();if(a==="body"||a==="html"||!n||!n.parentNode||!n.parentNode.children)return!1;let l=g(n.parentNode.tagName)?n.parentNode.tagName.toLowerCase():"unknown";l==="a"||l==="button"?e.start(i,n.parentNode,l):e.start(i,n,a)}):ut(document,"click",r=>{if(!t)return!1;let i=r||window.event;if(!i)return!1;let n=i.target||i.srcElement,a=s.heatmap.getTargetElement(n,r);if(!re(a)&&!g(n.tagName))return!1;re(a)&&g(a.tagName)?e.start(i,a,a.tagName.toLowerCase()):re(n)&&n.tagName.toLowerCase()==="div"&&d(s.para.heatmap)&&s.para.heatmap.get_vtrack_config&&ur.events.length>0&&ur.isTargetEle(n)&&e.start(i,n,n.tagName.toLowerCase(),{$lib_method:"vtrack"})})}};function Jr(){let e=T.campaignParams(),t={};return D(e,(r,i,n)=>{` ${s.source_channel_standard} `.includes(` ${i} `)?t[`$${i}`]=n[i]:t[i]=n[i]}),t}function rn(e,t,r){if(s.is_first_visitor&&r){let i={};s.para.preset_properties.search_keyword_baidu&&sr(document.referrer)&&jt()&&(i.$search_keyword_id=Nt.id(),i.$search_keyword_id_type=Nt.type(),i.$search_keyword_id_hash=Cr(i.$search_keyword_id));let n=document.characterSet||document.charset,a=Ze(null,t);e(P({$first_visit_time:new Date,$first_referrer:a,$first_referrer_host:a?Te(a,"取值异常"):"",$first_browser_language:g(navigator.language)?navigator.language.toLowerCase():"取值异常",$first_browser_charset:g(n)?n.toUpperCase():"取值异常",$first_traffic_source_type:Ir(),$first_search_keyword:Ot(),$timezone_offset:new Date().getTimezoneOffset()},Jr(),i)),s.is_first_visitor=!1}}let cr={autoTrackIsUsed:!1,isReady(e){$(e)?e():s.log("error: isReady callback must be function")},getUtm(){return T.campaignParams()},getStayTime(){return(new Date-s._t)/1e3},setProfileLocal(e){if(!I.isSupport())return s.setProfile(e),!1;if(!d(e)||ne(e))return!1;let t=c.readObjectVal("sensorsdata_2015_jssdk_profile"),r=!1;if(d(t)&&!ne(t)){for(let i in e)!(i in t&&t[i]!==e[i])&&i in t||(t[i]=e[i],r=!0);r&&(c.saveObjectVal("sensorsdata_2015_jssdk_profile",t),s.setProfile(e))}else c.saveObjectVal("sensorsdata_2015_jssdk_profile",e),s.setProfile(e)},setInitReferrer(){let e=Ze();s.setOnceProfile({_init_referrer:e,_init_referrer_host:T.pageProp.referrer_host})},setSessionReferrer(){let e=Ze();c.setSessionPropsOnce({_session_referrer:e,_session_referrer_host:T.pageProp.referrer_host})},setDefaultAttr(){T.register({_current_url:location.href,_referrer:Ze(),_referring_host:T.pageProp.referrer_host})},trackHeatMap(e,t,r){if(typeof e=="object"&&e.tagName&&re(e.parentNode)){let i=e.tagName.toLowerCase(),n=e.parentNode.tagName.toLowerCase(),a=s.para.heatmap&&s.para.heatmap.track_attr?s.para.heatmap.track_attr:["data-sensors-click"];i==="button"||i==="a"||n==="a"||n==="button"||i==="input"||i==="textarea"||Fr(e,a)||Ee.start(null,e,i,t,r)}},trackAllHeatMap(e,t,r){if(typeof e=="object"&&e.tagName){let i=e.tagName.toLowerCase();Ee.start(null,e,i,t,r)}},autoTrackSinglePage(e,t){let r;r=this.autoTrackIsUsed?T.pageProp.url:T.pageProp.referrer;let i=!(e=d(e)?e:{}).not_set_profile;function n(a,l){s.track("$pageview",P({$referrer:r,$url:oe(),$url_path:ot(),$title:document.title},a,Jr()),l),r=oe()}e.not_set_profile&&delete e.not_set_profile,n(e,t),this.autoTrackSinglePage=n,rn(s.setOnceProfile,!1,i)},autoTrackWithoutProfile(e,t){e=d(e)?e:{},this.autoTrack(P(e,{not_set_profile:!0}),t)},autoTrack(e,t){e=d(e)?e:{};let r=Jr(),i=!e.not_set_profile;e.not_set_profile&&delete e.not_set_profile;let n=location.href;s.para.is_single_page&&fi(()=>{let a=Ze(n,!0);s.track("$pageview",P({$referrer:a,$url:oe(),$url_path:ot(),$title:document.title},r,e),t),n=oe()}),s.track("$pageview",P({$referrer:Ze(null,!0),$url:oe(),$url_path:ot(),$title:document.title},r,e),t),rn(s.setOnceProfile,!0,i),this.autoTrackIsUsed=!0},getAnonymousID(){return ne(c._state)?"SDK is not initialized.":c.getAnonymousId()},setPlugin(e){if(!d(e))return!1;D(e,(t,r)=>{$(t)&&(d(window.SensorsDataWebJSSDKPlugin)&&window.SensorsDataWebJSSDKPlugin[r]?t(window.SensorsDataWebJSSDKPlugin[r]):d(s.modules)&&s.modules[r]?t(s.modules[r]):k(`${r}is not found,please check sensorsdata documents.`))})},useModulePlugin(){s.use.apply(s,arguments)},useAppPlugin(){this.setPlugin.apply(this,arguments)}};function nn(e,t){let r=e.id,i=e.callback,n=e.name,a=c.getFirstId(),l=c.getOriginDistinctId();if(!J({distinct_id:r}))return A("login id is invalid"),!1;if(r===c.getOriginDistinctId()&&!a)return A("login id is equal to distinct_id"),!1;if(d(c._state.identities)&&c._state.identities.hasOwnProperty(n)&&r===c._state.first_id)return!1;if(c._state.history_login_id.name!==n||r!==c._state.history_login_id.value){c._state.identities[n]=r,c.set("history_login_id",{name:n,value:r}),a||c.set("first_id",l),t(r,"$SignUp",{},i);let u={$identity_cookie_id:c._state.identities.$identity_cookie_id};return u[n]=r,an(u),!0}return!1}function an(e){let t={};for(let r in e)t[r]=e[r];c._state.identities=t,c.save()}function Za(e,t){if(!J({unbindKey:e,bindValue:t}))return!1;if(d(c._state.identities)&&c._state.identities.hasOwnProperty(e)&&c._state.identities[e]===t){let i=c.getUnionId().login_id;i&&`${e}+${t}`===i&&(c._state.distinct_id=c._state.first_id,c._state.first_id="",c.set("history_login_id",{name:"",value:""})),e!=="$identity_cookie_id"&&(delete c._state.identities[e],c.save())}let r={};return r[e]=t,r}function Ga(){s._t=s._t||1*new Date,s.is_first_visitor=!1,s.source_channel_standard=Ni}function Qa(e){P(h,e||s.para||{}),s.para=h;let t,r={};if(d(s.para.is_track_latest))for(let p in s.para.is_track_latest)r[`latest_${p}`]=s.para.is_track_latest[p];for(t in s.para.preset_properties=P({},rr.preset_properties,r,s.para.preset_properties||{}),rr)s.para[t]===void 0&&(s.para[t]=rr[t]);typeof s.para.web_url!="string"||s.para.web_url.slice(0,3)!=="://"&&s.para.web_url.slice(0,2)!=="//"||(s.para.web_url.slice(0,3)==="://"?s.para.web_url=location.protocol.slice(0,-1)+s.para.web_url:s.para.web_url=location.protocol+s.para.web_url),Ge.protocol.serverUrl(),s.bridge&&s.bridge.initPara();let i=["utm_source","utm_medium","utm_campaign","utm_content","utm_term"],n=["www.baidu.","m.baidu.","m.sm.cn","so.com","sogou.com","youdao.com","google.","yahoo.com/","bing.com/","ask.com/"],a=["weibo.com","renren.com","kaixin001.com","douban.com","qzone.qq.com","zhihu.com","tieba.baidu.com","weixin.qq.com"],l={baidu:["wd","word","kw","keyword"],google:"q",bing:"q",yahoo:"p",sogou:["query","keyword"],so:"q",sm:"q"};typeof s.para.source_type=="object"&&(s.para.source_type.utm=j(s.para.source_type.utm)?s.para.source_type.utm.concat(i):i,s.para.source_type.search=j(s.para.source_type.search)?s.para.source_type.search.concat(n):n,s.para.source_type.social=j(s.para.source_type.social)?s.para.source_type.social.concat(a):a,s.para.source_type.keyword=d(s.para.source_type.keyword)?P(l,s.para.source_type.keyword):l);let u=["mark","/mark","strong","b","em","i","u","abbr","ins","del","s","sup"];if(s.para.heatmap&&!d(s.para.heatmap)&&(s.para.heatmap={}),d(s.para.heatmap)){s.para.heatmap.clickmap=s.para.heatmap.clickmap||"default",s.para.heatmap.scroll_notice_map=s.para.heatmap.scroll_notice_map||"default",s.para.heatmap.scroll_delay_time=s.para.heatmap.scroll_delay_time||4e3,s.para.heatmap.scroll_event_duration=s.para.heatmap.scroll_event_duration||18e3,s.para.heatmap.renderRefreshTime=s.para.heatmap.renderRefreshTime||1e3,s.para.heatmap.loadTimeout=s.para.heatmap.loadTimeout||1e3,s.para.heatmap.request_timeout=s.para.heatmap.request_timeout||1e4,s.para.heatmap.get_vtrack_config!==!0&&(s.para.heatmap.get_vtrack_config=!1);let p=j(s.para.heatmap.track_attr)?wi(s.para.heatmap.track_attr,b=>b&&typeof b=="string"):[];p.push("data-sensors-click"),s.para.heatmap.track_attr=p,d(s.para.heatmap.collect_tags)?s.para.heatmap.collect_tags.div===!0?s.para.heatmap.collect_tags.div={ignore_tags:u,max_level:1}:d(s.para.heatmap.collect_tags.div)?(s.para.heatmap.collect_tags.div.ignore_tags?j(s.para.heatmap.collect_tags.div.ignore_tags)||(k("ignore_tags 参数必须是数组格式"),s.para.heatmap.collect_tags.div.ignore_tags=u):s.para.heatmap.collect_tags.div.ignore_tags=u,s.para.heatmap.collect_tags.div.max_level&&ie([1,2,3],s.para.heatmap.collect_tags.div.max_level)===-1&&(s.para.heatmap.collect_tags.div.max_level=1)):s.para.heatmap.collect_tags.div=!1:s.para.heatmap.collect_tags={div:!1}}s.para.server_url=Ki(s.para.server_url,s.para.custom_server_url),s.para.noCache===!0?s.para.noCache=`?${new Date().getTime()}`:s.para.noCache="",s.para.callback_timeout>s.para.datasend_timeout&&(s.para.datasend_timeout=s.para.callback_timeout),s.para.heatmap&&s.para.heatmap.collect_tags&&d(s.para.heatmap.collect_tags)&&D(s.para.heatmap.collect_tags,(p,b)=>{b!=="div"&&p&&s.heatmap.otherTags.push(b)}),s.para.heatmap&&s.para.heatmap.clickmap==="default"&&s.heatmap.initUnlimitedTags()}let es={state:0,historyState:[],stateType:{1:"1-init未开始",2:"2-init开始",3:"3-store完成"},getState(){return this.historyState.join(`
`)},setState(e){String(e)in this.stateType&&(this.state=e),this.historyState.push(this.stateType[e])}};function ts(){let e=Array.prototype.slice.call(arguments),t=e[0],r=e.slice(1);if(typeof t=="string"&&cr[t])return cr[t].apply(cr,r);typeof t=="function"?t.apply(s,r):k(`quick方法中没有这个功能${e[0]}`)}let rs=1;function sn(e,t){if(g(e)||d(e)){let r;if(d(e)){let i=s.modules&&s.modules[e.plugin_name];i&&i!==e&&k(`${e.name} is conflict with builtin plugin, and sdk uses builtin plugin.`),r=i||e}return g(e)&&(d(s.modules)&&d(s.modules[e])?r=s.modules[e]:d(window.SensorsDataWebJSSDKPlugin)&&d(window.SensorsDataWebJSSDKPlugin[e])?r=window.SensorsDataWebJSSDKPlugin[e]:window.sensorsDataAnalytic201505&&window.sensorsDataAnalytic201505.modules[e]&&(r=window.sensorsDataAnalytic201505.modules[e])),r&&$(r.init)?(r.plugin_is_init||(r.plugin_name||k("warning: invalid plugin, plugin_name required."),r.plugin_version?r.plugin_version!==s.lib_version&&k("warning: plugin version not match SDK version. plugin may not work correctly. "):k("warning: invalid plugin, plugin version required."),!r.plugin_is_init&&r.init(s,t),r.plugin_is_init=!0,s.modules=s.modules||{},s.modules[r.plugin_name||`unnamed_${rs++}`]=r),r):(k(`${e.plugin_name||e} is not found or it's not a standard plugin. Please check sensorsdata official documents.`),r)}A("use's first arguments must be string or object.")}function is(e,t,r){J({event:e,properties:t})&&le.send({type:"track",event:e,properties:t},r)}function ns(e,t){if(!J({bindKey:e,bindValue:t}))return!1;c._state.identities[e]=t,c.save(),le.send({type:"track_id_bind",event:"$BindID",properties:{}})}function as(e,t){let r=Za(e,t);r&&le.send({identities:r,type:"track_id_unbind",event:"$UnbindID",properties:{}})}function ss(e,t,r){typeof e=="object"&&e.tagName?en({ele:e},t,r,s.track):typeof e=="object"&&e.target&&e.event&&en(e,t,r,s.track)}function os(e,t,r){return r=r||{},!(!e||typeof e!="object")&&!(!e.href||e.href.startsWith("javascript")||e.target)&&void ut(e,"click",i=>{i.preventDefault();let n=!1;function a(){n||(n=!0,location.href=e.href)}setTimeout(a,1e3),s.track(t,r,a)})}function ls(e,t,r){J({item_type:e,item_id:t,properties:r})&&le.sendItem({type:"item_set",item_type:e,item_id:t,properties:r||{}})}function us(e,t){J({item_type:e,item_id:t})&&le.sendItem({type:"item_delete",item_type:e,item_id:t})}function cs(e,t){J({propertiesMust:e})&&le.send({type:"profile_set",properties:e},t)}function ds(e,t){J({propertiesMust:e})&&le.send({type:"profile_set_once",properties:e},t)}function ps(e,t){J({propertiesMust:e})&&(D(e,(r,i)=>{g(r)&&Pr(i)?e[i]=[r]:j(r)&&Pr(i)?e[i]=r:(delete e[i],k("appendProfile属性的值必须是字符串或者数组"))}),ne(e)||le.send({type:"profile_append",properties:e},t))}function gs(e,t){let r=e;g(e)&&((e={})[r]=1),J({propertiesMust:e})&&(function(i){for(let n in i)if(Object.prototype.hasOwnProperty.call(i,n)&&!/-*\d+/.test(String(i[n])))return!1;return!0}(e)?le.send({type:"profile_increment",properties:e},t):A("profile_increment的值只能是数字"))}function fs(e){le.send({type:"profile_delete"},e),c.set("distinct_id",Ye()),c.set("first_id","")}function _s(e,t){let r=e,i={};g(e)&&(e=[]).push(r),j(e)?(D(e,n=>{g(n)?i[n]=!0:k("profile_unset给的数组里面的值必须时string,已经过滤掉",n)}),le.send({type:"profile_unset",properties:i},t)):A("profile_unset的参数必须是数组")}function hs(e){typeof e=="number"&&(e=String(e));let t=c.getFirstId();if(e===void 0){let r=Ye();t?c.set("first_id",r):c.set("distinct_id",r)}else J({distinct_id:e})&&(t?c.set("first_id",e):c.set("distinct_id",e))}function ms(e){if(c.getFirstId())return A("resetAnonymousIdentity must be used in a logout state ！"),!1;if(typeof e=="number"&&(e=String(e)),e===void 0){let t=Ye();c._state.identities.$identity_cookie_id=t,c.set("distinct_id",t)}else J({distinct_id:e})&&(c._state.identities.$identity_cookie_id=e,c.set("distinct_id",e))}function Mr(e,t,r,i){let n=c.getFirstId()||c.getDistinctId();c.set("distinct_id",e),le.send({original_id:n,distinct_id:c.getDistinctId(),type:"track_signup",event:t,properties:r},i)}function ys(e,t,r,i){typeof e=="number"&&(e=String(e)),J({distinct_id:e,event:t,properties:r})&&Mr(e,t,r,i)}function vs(e){J({properties:e})?P(T.currentProps,e):A("register输入的参数有误")}function bs(e){c.clearAllProps(e)}function ws(e){let t;if(j(e)&&e.length>0)for(t=0;t<e.length;t++)g(e[t])&&e[t]in T.currentProps&&delete T.currentProps[e[t]];else if(e===!0)for(t in T.currentProps)delete T.currentProps[t]}function on(e){J({properties:e})?c.setProps(e):A("register输入的参数有误")}function Ss(e){J({properties:e})?c.setPropsOnce(e):A("registerOnce输入的参数有误")}function $s(e){s.log("registerSession 方法已经弃用，有问题联系技术顾问"),J({properties:e})?c.setSessionProps(e):A("registerSession输入的参数有误")}function ks(e){s.log("registerSessionOnce 方法已经弃用，有问题联系技术顾问"),J({properties:e})?c.setSessionPropsOnce(e):A("registerSessionOnce输入的参数有误")}function ln(e,t){typeof e=="number"&&(e=String(e)),!nn({id:e,callback:t,name:Bt.LOGIN},Mr)&&$(t)&&t()}function Fs(e,t){return k("loginWithKey is deprecated !!!"),typeof t=="number"&&(t=String(t)),typeof e=="number"&&(e=String(e)),!!J({loginIdKey:e})&&(Bt.LOGIN===e?(ln(t),!1):void nn({id:t,callback:null,name:e},Mr))}function Cs(e){let t=c.getFirstId();if(t)if(c.set("first_id",""),e===!0){let r=Ye();c.set("distinct_id",r)}else c.set("distinct_id",t);an({$identity_cookie_id:c._state.identities.$identity_cookie_id}),c.set("history_login_id",{name:"",value:""})}function Es(){let e,t,r={$is_first_day:nr(),$is_first_time:It.is_page_first_visited,$referrer:T.pageProp.referrer||"",$referrer_host:T.pageProp.referrer?Te(T.pageProp.referrer):"",$url:oe(),$url_path:ot(),$title:document.title||"",_distinct_id:c.getDistinctId(),identities:c.getIdentities()},i=P({},T.properties(),c.getProps(),(e=T.campaignParams(),t={},D(e,(n,a,l)=>{` ${s.source_channel_standard} `.includes(` ${a} `)?t[`$${a}`]=l[a]:t[a]=l[a]}),t),r);return s.para.preset_properties.latest_referrer&&s.para.preset_properties.latest_referrer_host&&(i.$latest_referrer_host=i.$latest_referrer===""?"":Te(i.$latest_referrer)),i}let Ds={__proto__:null,setInitVar:Ga,initPara:Qa,quick:ts,use:sn,track:is,bind:ns,unbind:as,trackLink:ss,trackLinks:os,setItem:ls,deleteItem:us,setProfile:cs,setOnceProfile:ds,appendProfile:ps,incrementProfile:gs,deleteProfile:fs,unsetProfile:_s,identify:hs,resetAnonymousIdentity:ms,trackSignup:ys,registerPage:vs,clearAllRegister:bs,clearPageRegister:ws,register:on,registerOnce:Ss,registerSession:$s,registerSessionOnce:ks,login:ln,loginWithKey:Fs,logout:Cs,getPresetProperties:Es,readyState:es,debug:Ge,on:Wi,log:xe};G.setup(xe);let un=P({},Aa,Oa);function Ps(){let e="",t=" { cursor: pointer; -webkit-tap-highlight-color: rgba(0,0,0,0); }";s.heatmap&&j(s.heatmap.otherTags)&&D(s.heatmap.otherTags,r=>{e+=r+t}),Di()&&Sr()&&Sr()<13&&(s.para.heatmap&&s.para.heatmap.collect_tags&&s.para.heatmap.collect_tags.div&&Qt(`div, [data-sensors-click]${t}`),s.para.heatmap&&s.para.heatmap.track_attr&&Qt(`[${s.para.heatmap.track_attr.join("], [")}]${t}`),e!==""&&Qt(e))}let As={bridge_info:{touch_app_bridge:!1,verify_success:!1,platform:"",support_two_way_call:!1},is_verify_success:!1,initPara(){let e={is_send:s.para.use_app_track_is_send!==!1&&s.para.use_app_track!=="only",white_list:[],is_mui:s.para.use_app_track==="mui"};typeof s.para.app_js_bridge=="object"?s.para.app_js_bridge=P({},e,s.para.app_js_bridge):s.para.use_app_track!==!0&&s.para.app_js_bridge!==!0&&s.para.use_app_track!=="only"&&s.para.use_app_track!=="mui"||(s.para.app_js_bridge=P({},e)),s.para.app_js_bridge.is_send===!1&&k("设置了 is_send:false,如果打通失败，数据将被丢弃!")},app_js_bridge_v1(){let e=null,t=null;window.sensorsdata_app_js_bridge_call_js=function(r){(function(i){Zt(e=i)&&(e=JSON.parse(e)),t&&(t(e),t=null,e=null)})(r)},s.getAppStatus=function(r){if(function(){if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){let i=document.createElement("iframe");i.setAttribute("src","sensorsanalytics://getAppInfo"),document.documentElement.appendChild(i),i.parentNode.removeChild(i),i=null}}(),typeof window.SensorsData_APP_JS_Bridge=="object"&&window.SensorsData_APP_JS_Bridge.sensorsdata_call_app&&Zt(e=window.SensorsData_APP_JS_Bridge.sensorsdata_call_app())&&(e=JSON.parse(e)),!r)return e;e===null?t=r:(r(e),e=null)}},hasVisualModeBridge(){let e=window.SensorsData_App_Visual_Bridge,t="sensorsdata_visualized_mode";return d(e)&&e[t]&&(e[t]===!0||e[t]())},validateAppUrl:Bs};function Tt(e){let t=this;this.type=e,this.resultCbs={},this.timeoutCbs={},this.timerId=null,this.appCallJsCallback=null,window.sensorsdata_app_call_js||(window.sensorsdata_app_call_js=function(r,i){if(r in window.sensorsdata_app_call_js.modules)return window.sensorsdata_app_call_js.modules[r](i)}),window.sensorsdata_app_call_js.modules=window.sensorsdata_app_call_js.modules||{},window.sensorsdata_app_call_js.modules[this.type]=function(r){try{let i=bt(r)||r;try{i=JSON.parse(i)}catch{}let n=i&&i.message_id;if(n&&t.resultCbs[n]){if(r=i,t.timeoutCbs[n]&&t.timeoutCbs[n].isTimeout)return void(t.resultCbs[n].callbacks.length=0);if(t.resultCbs[n])for(let a in t.resultCbs[n].result=r,clearTimeout(t.timerId),t.timeoutCbs[n].callbacks.length=0,t.resultCbs[n].callbacks)t.resultCbs[n].callbacks[a].call(null,r),t.resultCbs[n].callbacks.splice(a,1);return}return t.appCallJsCallback&&t.appCallJsCallback.call(null,r)}catch{A("app 回调 js 异常",r)}}}function cn(e){try{if(s.bridge.activeBridge&&$(s.bridge.activeBridge.handleCommand))return s.bridge.activeBridge.handleCommand(e)}catch(t){A(`Error: handle command exception:${t}`)}return A(`数据发往App失败，App没有暴露bridge,type:${e.callType}`),!1}function Bs(e){function t(n){let a={hostname:"",project:""};try{n=qe(n),a.hostname=n.hostname,a.project=n.searchParams.get("project")||"default"}catch(l){A(`validateAppUrl:${l}`)}return a}let r=t(e),i=t(s.para.server_url);if(r.hostname===i.hostname&&r.project===i.project)return!0;if(j(s.para.app_js_bridge.white_list))for(let n=0;n<s.para.app_js_bridge.white_list.length;n++){let a=t(s.para.app_js_bridge.white_list[n]);if(a.hostname===r.hostname&&a.project===r.project)return!0}return!1}function dn(e){this.bridge=new Tt(e.type)}function Is(){let e=T.pageProp.url_domain,t={};e===""&&(e="url解析失败");let r=Ot(document.referrer,!0);if(h.preset_properties.search_keyword_baidu?sr(document.referrer)&&(!jt()||d(r)&&r.active?c._state&&c._state.props&&(c._state.props.$search_keyword_id&&delete c._state.props.$search_keyword_id,c._state.props.$search_keyword_id_type&&delete c._state.props.$search_keyword_id_type,c._state.props.$search_keyword_id_hash&&delete c._state.props.$search_keyword_id_hash):(t.$search_keyword_id=Nt.id(),t.$search_keyword_id_type=Nt.type(),t.$search_keyword_id_hash=Cr(t.$search_keyword_id))):c._state&&c._state.props&&(c._state.props.$search_keyword_id&&delete c._state.props.$search_keyword_id,c._state.props.$search_keyword_id_type&&delete c._state.props.$search_keyword_id_type,c._state.props.$search_keyword_id_hash&&delete c._state.props.$search_keyword_id_hash),c.save(),D(h.preset_properties,(i,n)=>{if(!n.includes("latest_"))return!1;if(n=n.slice(7),i){if(n==="wx_ad_click_id"&&i==="not_collect")return!1;if(n!=="utm"&&e==="url解析失败")n==="wx_ad_click_id"?(t._latest_wx_ad_click_id="url的domain解析失败",t._latest_wx_ad_hash_key="url的domain解析失败",t._latest_wx_ad_callbacks="url的domain解析失败"):t[`$latest_${n}`]="url的domain解析失败";else if(sr(document.referrer))switch(n){case"traffic_source_type":t.$latest_traffic_source_type=Ir();break;case"referrer":t.$latest_referrer=T.pageProp.referrer;break;case"search_keyword":Ot()?t.$latest_search_keyword=Ot():d(c._state)&&d(c._state.props)&&c._state.props.$latest_search_keyword&&delete c._state.props.$latest_search_keyword;break;case"landing_page":t.$latest_landing_page=oe();break;case"wx_ad_click_id":var a=Ri(location.href);t._latest_wx_ad_click_id=a.click_id,t._latest_wx_ad_hash_key=a.hash_key,t._latest_wx_ad_callbacks=a.callbacks}}else if(n==="utm"&&c._state&&c._state.props)for(let l in c._state.props)(l.indexOf("$latest_utm")===0||l.indexOf("_latest_")===0&&!l.includes("_latest_wx_ad_"))&&delete c._state.props[l];else c._state&&c._state.props&&`$latest_${n}`in c._state.props?delete c._state.props[`$latest_${n}`]:n=="wx_ad_click_id"&&c._state&&c._state.props&&i===!1&&D(["_latest_wx_ad_click_id","_latest_wx_ad_hash_key","_latest_wx_ad_callbacks"],l=>{l in c._state.props&&delete c._state.props[l]})}),h.preset_properties.latest_utm){let i=T.campaignParamsStandard("$latest_","_latest_"),n=i.$utms,a=i.otherUtms;ne(n)||P(t,n),ne(a)||P(t,a)}on(t)}function pn(e){let t=null;try{let r=JSON.parse(window.name);t=r[e]?Me(r[e]):null}catch{t=null}return t===null&&(t=Ke(location.href,e)||null),t}Tt.prototype.call=function(e,t){let r=this,i=new Date().getTime().toString(16)+String(ge()).replace(".","").slice(1,8);this.resultCbs[i]=r.resultCbs[i]||{result:null,callbacks:[]},this.timeoutCbs[i]=r.timeoutCbs[i]||{isTimeout:!1,callbacks:[]},(e=e.data?e:{data:e}).data.message_id=i;let n=P({callType:this.type},e);return t&&(this.timerId=setTimeout(()=>{for(let a in r.timeoutCbs[i].isTimeout=!0,r.timeoutCbs[i].callbacks)r.timeoutCbs[i].callbacks[a].call(null),r.timeoutCbs[i].callbacks.splice(a,1)},t)),cn(n),{onResult(a){return r.resultCbs[i].result?(a(r.resultCbs[i].result),this):(!r.timeoutCbs[i].isTimeout&&r.resultCbs[i].callbacks.push(a),this)},onTimeout(a){return r.timeoutCbs[i].isTimeout?(a(),this):(!r.resultCbs[i].result&&r.timeoutCbs[i].callbacks.push(a),this)}}},Tt.prototype.onAppNotify=function(e){this.appCallJsCallback=e},Tt.prototype.notifyApp=function(e,t){let r=P({callType:this.type},e);return t&&(r.message_id=t),cn(r)},dn.prototype={double(){},getAppData(){},hasAppBridge(){return s.bridge.bridge_info.support_two_way_call},init(){},jsCallApp(){},requestToApp(e){this.bridge.call(e,e.timeout.time).onResult(t=>{$(e.callback)&&e.callback(t)}).onTimeout(()=>{$(e.timeout.callback)&&e.timeout.callback()})}};var et={isSeachHasKeyword(){return Ke(location.href,"sa-request-id")!==""&&(typeof sessionStorage.getItem("sensors-visual-mode")=="string"&&sessionStorage.removeItem("sensors-visual-mode"),!0)},hasKeywordHandle(){let e=location.href,t=Ke(e,"sa-request-id")||null,r=Ke(e,"sa-request-type")||null,i=Ke(e,"sa-request-url")||null;if(Ee.setNotice(i),St.isSupport())if(i!==null&&sessionStorage.setItem("sensors_heatmap_url",i),sessionStorage.setItem("sensors_heatmap_id",t),r!==null)r==="1"||r==="2"||r==="3"?sessionStorage.setItem("sensors_heatmap_type",r):r=null;else{let n=sessionStorage.getItem("sensors_heatmap_type");r=n!==null?n:null}this.isReady(t,r)},isReady(e,t,r){s.para.heatmap_url&&s.para.heatmap?Gt({success(){setTimeout(()=>{typeof sa_jssdk_heatmap_render<"u"&&(sa_jssdk_heatmap_render(s,e,t,r),typeof console=="object"&&typeof console.log=="function"&&(s.heatmap_version&&s.heatmap_version===s.lib_version||k("heatmap.js与sensorsdata.js版本号不一致，可能存在风险!")))},0)},error(){},type:"js",url:s.para.heatmap_url}):k("没有配置 heatmap 开启点击图，或者没有指定 heatmap_url 的路径")},isStorageHasKeyword(){return St.isSupport()&&typeof sessionStorage.getItem("sensors_heatmap_id")=="string"},storageHasKeywordHandle(){Ee.setNotice(),et.isReady(sessionStorage.getItem("sensors_heatmap_id"),sessionStorage.getItem("sensors_heatmap_type"),location.href)},isWindowNameHasKeyword(){try{let e=JSON.parse(window.name),t=g(e["sa-heatmap-src"])?Me(e["sa-heatmap-src"]):null;return e["sa-request-id"]&&g(e["sa-request-id"])&&t===location.href}catch{return!1}},windowNameHasKeywordHandle(){let e=JSON.parse(window.name);function t(l){let u=e[l];return g(u)?Me(u):null}let r=t("sa-request-id"),i=t("sa-request-type"),n=t("sa-request-url"),a=t("sa-request-language");Ee.setNotice(n),I.isSupport()&&g(a)&&I.set("web_sdk_heatmap_language",a),St.isSupport()&&(n!==null&&sessionStorage.setItem("sensors_heatmap_url",n),sessionStorage.setItem("sensors_heatmap_id",r),i!==null?i==="1"||i==="2"||i==="3"?sessionStorage.setItem("sensors_heatmap_type",i):i=null:i=sessionStorage.getItem("sensors_heatmap_type")!==null?sessionStorage.getItem("sensors_heatmap_type"):null),et.isReady(r,i)}},Ie={isStorageHasKeyword(){return St.isSupport()&&typeof sessionStorage.getItem("sensors-visual-mode")=="string"},isSearchHasKeyword(){return(pn("sa-visual-mode")===!0||pn("sa-visual-mode")==="true")&&(typeof sessionStorage.getItem("sensors_heatmap_id")=="string"&&sessionStorage.removeItem("sensors_heatmap_id"),!0)},loadVtrack(){Gt({success(){},error(){},type:"js",url:s.para.vtrack_url?s.para.vtrack_url:`${tn()}//static.sensorsdata.cn/sdk/${s.lib_version}/vtrack.min.js`})},messageListener(e){if(!e||!e.data||e.data.source!=="sa-fe")return!1;if(e.data.type==="v-track-mode"){if(e.data.data&&e.data.data.isVtrack)if(St.isSupport()&&sessionStorage.setItem("sensors-visual-mode","true"),e.data.data.userURL&&location.href.match(/sa-visual-mode=true/)){let t=e.data.data.userURL;g(t)&&(Dr(t,"http://")||Dr(t,"https://"))&&(window.location.href=encodeURI(t),setTimeout(()=>{window.location.reload(!0)},1e3))}else Ie.loadVtrack();window.removeEventListener("message",Ie.messageListener,!1)}},removeMessageHandle(){window.removeEventListener&&window.removeEventListener("message",Ie.messageListener,!1)},verifyVtrackMode(){window.addEventListener&&window.addEventListener("message",Ie.messageListener,!1),Ie.postMessage()},postMessage(){try{window.parent&&window.parent.postMessage&&window.parent.postMessage({source:"sa-web-sdk",type:"v-is-vtrack",data:{sdkversion:ir}},"*")}catch{A("浏览器版本过低，不支持 postMessage API")}},notifyUser(){let e=function(t){if(!t||!t.data||t.data.source!=="sa-fe")return!1;t.data.type==="v-track-mode"&&(t.data.data&&t.data.data.isVtrack&&alert("当前版本不支持，请升级部署神策数据治理"),window.removeEventListener("message",e,!1))};window.addEventListener&&window.addEventListener("message",e,!1),Ie.postMessage()}};function qr(e){let t=s.bridge.bridge_info;function r(){let i=[];t.touch_app_bridge||i.push(Ge.defineMode("1")),d(s.para.app_js_bridge)||(i.push(Ge.defineMode("2")),t.verify_success=!1),d(s.para.heatmap)&&s.para.heatmap.clickmap=="default"||i.push(Ge.defineMode("3")),t.verify_success==="fail"&&i.push(Ge.defineMode("4")),new s.SDKJSBridge("app_alert").notifyApp({data:i})}if(s.bridge.hasVisualModeBridge())if(d(s.para.heatmap)&&s.para.heatmap.clickmap=="default")if(d(s.para.app_js_bridge)&&t.verify_success==="success")if(e)window.sa_jssdk_app_define_mode(s,e);else{let i=location.protocol;Gt({success(){setTimeout(()=>{typeof sa_jssdk_app_define_mode<"u"&&window.sa_jssdk_app_define_mode(s,e)},0)},error(){},type:"js",url:`${i=ie(["http:","https:"],i)>-1?i:"https:"}//static.sensorsdata.cn/sdk/${s.lib_version}/vapph5define.min.js`})}else r();else r()}function js(e){s.para.is_track_single_page&&Nr.on("switch",t=>{let r=function(i){if(i=i||{},t!==location.href){T.pageProp.referrer=oe(t);let n=P({$url:oe(),$referrer:oe(t)},i);$(e)?e(n):s.quick&&s.quick("autoTrack",n)}};if(typeof s.para.is_track_single_page=="boolean")r();else if(typeof s.para.is_track_single_page=="function"){let i=s.para.is_track_single_page();d(i)?r(i):i===!0&&r()}})}function Ns(){s._q&&j(s._q)&&s._q.length>0&&D(s._q,e=>{s[e[0]].apply(s,Array.prototype.slice.call(e[1]))}),d(s.para.heatmap)&&(Ee.initHeatmap(),Ee.initScrollmap())}function Os(){s.readyState.setState(3),new s.SDKJSBridge("visualized").onAppNotify(()=>{qr(typeof sa_jssdk_app_define_mode<"u")}),qr(!1),s.bridge.app_js_bridge_v1(),T.initPage(),js(),c.init(),Is(),Ls(),s.readyState.setState(4),Ns()}function Ts(){et.isWindowNameHasKeyword()?et.windowNameHasKeywordHandle():et.isSeachHasKeyword()?et.hasKeywordHandle():window.parent!==self&&Ie.isSearchHasKeyword()?Ie.verifyVtrackMode():et.isStorageHasKeyword()?et.storageHasKeywordHandle():window.parent!==self&&Ie.isStorageHasKeyword()?Ie.verifyVtrackMode():(Os(),Ie.notifyUser())}function Ls(){Qe.init(),s.bridge.bridge_info.verify_success==="success"&&xr.init()}let xs=["setItem","deleteItem","getAppStatus","track","quick","register","registerPage","registerOnce","trackSignup","setProfile","setOnceProfile","appendProfile","incrementProfile","deleteProfile","unsetProfile","identify","resetAnonymousIdentity","login","logout","trackLink","clearAllRegister","clearPageRegister","bind","unbind","loginWithKey"];function gn(){D(xs,e=>{let t=s[e];s[e]=function(){if(s.readyState.state<3)return j(s._q)||(s._q=[]),k("calling sdk api before init is deprecated."),s._q.push([e,arguments]),!1;if(!$(s.getDisabled)||!s.getDisabled()){if(s.readyState.getState())return t.apply(s,arguments);A("请先初始化神策JS SDK")}}})}let Us={track(e,t,r){},quick(e,t,r,i){},register(e){},registerPage(e){},registerOnce(e){},clearAllRegister(e){},trackSignup(e,t,r,i){},setProfile(e,t){},setOnceProfile(e,t){},appendProfile(e,t){},incrementProfile(e,t){},deleteProfile(e){},unsetProfile(e,t){},identify(e,t){},resetAnonymousIdentity(e){},login(e,t){},logout(e){},trackLink(e,t,r){},deleteItem(e,t){},setItem(e,t,r){},getAppStatus(e){},clearPageRegister(e){},bind(e,t){},unbind(e,t){},registerPropertyPlugin(e){}};function Rs(e,t){this.cancel=function(){e=!0},this.getCanceled=function(){return e||!1},this.stop=function(){t=!0},this.getStopped=function(){return t||!1}}function Hs(e,t,r){let i=null;try{i=JSON.parse(JSON.stringify(e||null))}catch{}this.getOriginalData=function(){return i},this.getPosition=function(){return t},this.cancellationToken=new Rs,this.sensors=r}function ct(e){if(!d(e))throw"error: Stage constructor requires arguments.";this.processDef=e,this.registeredInterceptors={}}ct.prototype.process=function(e,t){if(e&&e in this.processDef){let r=this.registeredInterceptors[e];if(r&&j(r)&&r.length>0)for(let i={current:0,total:r.length},n=new Hs(t,i,s),a=0;a<r.length;a++)try{if(i.current=a+1,t=r[a].call(null,t,n)||t,n.cancellationToken.getCanceled())break;if(n.cancellationToken.getStopped())return}catch(l){A(`interceptor error:${l}`)}return this.processDef[e]&&this.processDef[e]in this.processDef&&(t=this.process(this.processDef[e],t)),t}A(`process [${e}] is not supported`)},ct.prototype.registerStageImplementation=function(e){e&&e.init&&$(e.init)&&(e.init(this),e.interceptor&&this.registerInterceptor(e.interceptor))},ct.prototype.registerInterceptor=function(e){if(e)for(let t in e){let r=e[t];if(r&&d(r)&&$(r.entry)){Le(r.priority)||(r.priority=Number.MAX_VALUE),this.registeredInterceptors[t]||(this.registeredInterceptors[t]=[]);let i=this.registeredInterceptors[t];r.entry.priority=r.priority,i.push(r.entry),i.sort((n,a)=>n.priority-a.priority)}}};let Js={basicProps:"extendProps",extendProps:"formatData",formatData:"finalAdjustData",finalAdjustData:null},fn=new ct(Js),Ms={send:null},_n=new ct(Ms),qs={getUtmData:null,callSchema:null},hn=new ct(qs),Ks={webClickEvent:null,webStayEvent:null},mn=new ct(Ks);function Kr(e){e&&e.buildDataStage&&fn.registerStageImplementation(e.buildDataStage),e&&e.businessStage&&hn.registerStageImplementation(e.businessStage),e&&e.sendDataStage&&_n.registerStageImplementation(e.sendDataStage),e&&e.viewStage&&mn.registerStageImplementation(e.viewStage)}let yn={buildDataStage(e){e&&fn.registerInterceptor(e)},businessStage(e){e&&hn.registerInterceptor(e)},sendDataStage(e){e&&_n.registerInterceptor(e)},viewStage(e){e&&mn.registerInterceptor(e)}};function Vr(e,t){yn[e]&&yn[e](t)}let Wr={stage:null,init(e){this.stage=e}};function Vs(){return Wr.stage&&Wr.stage.process("getUtmData")}let vn={stage:null,init(e){this.stage=e},interceptor:{send:{entry(e){return e}}}};function Ws(e){return vn.stage.process("send",e)}let Lt={};function zs(e){e.kit=Lt,e.saEvent=le,this.buildDataStage=Ur,this.sendDataStage=vn,this.businessStage=Wr}function Xs(e){e.heatmap=Ee,this.viewStage=Rr}Lt.buildData=function(e){return Wa(e)},Lt.sendData=function(e,t){let r=Ji(e.properties);Ws({origin_data:e,server_url:s.para.server_url,data:e,config:r||{},callback:t}),s.log(e)},Lt.encodeTrackData=function(e){return Vi(e)},Lt.getUtmData=function(){return Vs()};let Ys={webClickEvent:{entry(e,t){let r=t.sensors;e.tagName==="a"&&r.para.heatmap&&r.para.heatmap.isTrackLink===!0?r.trackLink({event:e.event,target:e.target},"$WebClick",e.props):r.track("$WebClick",e.props,e.callback)}},webStayEvent:{entry(e,t){t.sensors.track("$WebStay",e)}}};function Zs(e){$(e.properties)?!e.isMatchedWithFilter||$(e.isMatchedWithFilter)?Vr("buildDataStage",{finalAdjustData:{priority:100,entry(t){try{if($(e.isMatchedWithFilter))return e.isMatchedWithFilter(t)&&e.properties(t);e.properties(t)}catch(r){A(`execute registerPropertyPlugin callback error:${r}`)}}}}):A("registerPropertyPlugin arguments error, isMatchedWithFilter must be function"):A("registerPropertyPlugin arguments error, properties must be function")}let bn=window.sensors_data_pre_config,wn=!!un.isObject(bn)&&bn.is_compliance_enabled;function zr(e){e&&(s.events=Yi,s.bridge=As,s.SDKJSBridge=Tt,s.JSBridge=dn,s.store=c,s.unlimitedDiv=ur,s.customProp=Qi,s.vtrackcollect=Qe,s.vapph5collect=xr,s.detectMode=Ts,s.registerFeature=Kr,s.registerInterceptor=Vr,s.commonWays=cr,Kr(new zs(s)),Kr(new Xs(s)),Vr("viewStage",Ys));let t=e?Ds:Us;for(let r in t)s[r]=t[r];s.logger=lt,s.log=xe,s._=un,s.on=Wi,s.ee=W,s.use=sn,s.lib_version=ir,s.registerPropertyPlugin=Zs}s.init=function(e){if(W.sdk.emit("beforeInit"),s.readyState&&s.readyState.state&&s.readyState.state>=2)return!1;wn&&(zr(!0),gn()),W.initSystemEvent(),s.setInitVar(),s.readyState.setState(2),s.initPara(e),W.sdk.emit("initPara"),W.sdk.emit("afterInitPara"),W.sdk.emit("initAPI"),W.sdk.emit("afterInitAPI"),s.detectMode(),Ps(),W.sdk.emit("afterInit"),W.sdk.emit("ready")},wn?zr(!1):(zr(!0),gn());let Gs="1.27.11";function Qs(e,t,r){return e.plugin_version=Gs,e}let eo=Qs({init(e){let t=e._.isString,r=e._.rot13defs,i=e._.dfmapping,n="data:enc;";e.ee.sdk.on("afterInitPara",()=>{e.kit.userEncrypt=function(a){return`dfm-enc-${i(a)}`},e.kit.userDecrypt=function(a){return a.indexOf(n)===0?(a=a.substring(n.length),a=r(a)):a.indexOf("dfm-enc-")===0&&(a=a.substring(8),a=i(a)),a},e.kit.userDecryptIfNeeded=function(a){return!t(a)||a.indexOf(n)!==0&&a.indexOf("dfm-enc-")!==0||(a=e.kit.userDecrypt(a)),a}})},plugin_name:"UserEncryptDefault"}),to="1.27.11";function ro(e,t,r){if(e.plugin_name=t,e.init){let i=e.init;e.init=function(n,a){if(io(n,e,t),n.readyState&&n.readyState.state>=3||!n.on)return l();function l(){i.call(e,n,a)}n.on(r,l)}}return e}function io(e,t,r){function i(n,a){e.logger?e.logger.msg.apply(e.logger,a).module(`${r}`||"").level(n).log():e.log&&e.log.apply(e,a)}t.log=function(){i("log",arguments)},t.warn=function(){i("warn",arguments)},t.error=function(){i("error",arguments)}}function no(e,t,r){return ro(e,t,r),e.plugin_version=to,e}let ao=no({sd:null,init(e){if(this.sd||(this.sd=e,!this.sd||!this.sd._))return!1;let t=this.sd._.cookie.get("sensors_amp_id"),r=this.sd.store._state.distinct_id;if(t&&t.length>0){let i=t.slice(0,4)==="amp-";if(t!==r){if(!i)return!1;this.sd.store._state.first_id?(this.sd.identify(t,!0),this.sd.saEvent.send({original_id:t,distinct_id:r,type:"track_signup",event:"$SignUp",properties:{}},null),this.setAmpId(r)):this.sd.identify(t,!0)}}else this.setAmpId(r);this.addListener()},addListener(){let e=this;this.sd.events.on("changeDistinctId",t=>{e.setAmpId(t)}),this.sd.events.isReady()},setAmpId(e){this.sd._.cookie.set("sensors_amp_id",e)}},"Amp","sdkReady"),Ve=window.SensorsData_App_Visual_Bridge,so=Ve&&Ve.sensorsdata_visualized_mode,Sn=Ve&&Ve.sensorsdata_visualized_alert_info,$n=Ve&&Ve.sensorsdata_hover_web_nodes;function oo(e){return Sn&&Sn.call(Ve,JSON.stringify(e))}function kn(e){return so.call(Ve)&&$n&&$n.call(Ve,JSON.stringify(e))}function lo(e,t){return t&&typeof t[e.callType]=="function"&&t[e.callType]()}let je,dr,xt,M,Ut,dt,Fn={commands:{app_alert:oo,visualized_track:kn,page_info:kn,sensorsdata_get_app_visual_config:lo}},uo="1.27.11";function co(e,t,r){if(e.plugin_name=t,e.init){let i=e.init;e.init=function(n,a){if(po(n,e,t),n.readyState&&n.readyState.state>=3||!n.on)return l();function l(){i.call(e,n,a)}n.on(r,l)}}return e}function po(e,t,r){function i(n,a){e.logger?e.logger.msg.apply(e.logger,a).module(`${r}`||"").level(n).log():e.log&&e.log.apply(e,a)}t.log=function(){i("log",arguments)},t.warn=function(){i("warn",arguments)},t.error=function(){i("error",arguments)}}function go(e,t,r){return co(e,t,r),e.plugin_version=uo,e}let Cn={init(e){Ut=(M=e)&&M._,dt=M&&M.log||console&&console.log||function(){},fo()},handleCommand:ho};function fo(){je=window.SensorsData_APP_New_H5_Bridge,dr=je&&je.sensorsdata_track,xt=dr&&je.sensorsdata_get_server_url&&je.sensorsdata_get_server_url(),dt("---test---fail---",!M,M.bridge.activeBridge,!xt),M&&!M.bridge.activeBridge&&xt&&(M.bridge.activeBridge=Cn,M.para.app_js_bridge&&!M.para.app_js_bridge.is_mui&&(M.bridge.is_verify_success=xt&&M.bridge.validateAppUrl(xt),dt("---test---bridge-verify-",M.bridge.is_verify_success)),M.bridge.bridge_info={touch_app_bridge:!0,platform:"android",verify_success:M.bridge.is_verify_success?"success":"fail",support_two_way_call:!!je.sensorsdata_js_call_app},M.para.app_js_bridge?M.registerInterceptor("sendDataStage",{send:{priority:60,entry:_o}}):dt("---test---app_js_bridge is not configured, data will not be sent by android bridge."))}function _o(e,t){if(dt("---test---datasend-",M.bridge.is_verify_success),M.para.app_js_bridge.is_mui||e.data.type==="item_set"||e.data.type==="item_delete")return e;let r=e.callback;return M.bridge.is_verify_success?(dt("---test---bridge-verify-success---",e.data),dr&&dr.call(je,JSON.stringify(Ut.extend({server_url:M.para.server_url},e.data))),Ut.isFunction(r)&&r(),t.cancellationToken.cancel(),e):(dt("---test---bridge-verify-fail-----",M.bridge.is_verify_success),M.para.app_js_bridge.is_send?(M.debug.apph5({data:e.data,step:"4.2",output:"all"}),e):(Ut.isFunction(r)&&r(),t.cancellationToken.cancel(),e))}function ho(e){let t=e.callType;if(t in Fn.commands)return Fn.commands[t](e,je);je&&Ut.isFunction(je.sensorsdata_js_call_app)&&je.sensorsdata_js_call_app(JSON.stringify(e))}let En=go(Cn,"AndroidBridge","sdkAfterInitPara"),We=window.SensorsData_App_Visual_Bridge,mo=We&&We.sensorsdata_visualized_mode,Dn=We&&We.sensorsdata_visualized_alert_info,Pn=We&&We.sensorsdata_hover_web_nodes;function yo(e){return Dn&&Dn.call(We,JSON.stringify(e))}function An(e){return mo.call(We)&&Pn&&Pn.call(We,JSON.stringify(e))}function vo(e,t){return t&&typeof t[e.callType]=="function"&&t[e.callType]()}let _e,$t,pt,Rt,Q,gt,De,Xr={commands:{app_alert:yo,visualized_track:An,page_info:An,sensorsdata_get_app_visual_config:vo}},bo="1.27.11";function wo(e,t,r){if(e.plugin_name=t,e.init){let i=e.init;e.init=function(n,a){if(So(n,e,t),n.readyState&&n.readyState.state>=3||!n.on)return l();function l(){i.call(e,n,a)}n.on(r,l)}}return e}function So(e,t,r){function i(n,a){e.logger?e.logger.msg.apply(e.logger,a).module(`${r}`||"").level(n).log():e.log&&e.log.apply(e,a)}t.log=function(){i("log",arguments)},t.warn=function(){i("warn",arguments)},t.error=function(){i("error",arguments)}}function $o(e,t,r){return wo(e,t,r),e.plugin_version=bo,e}let Bn={init(e){gt=(Q=e)&&Q._,De=Q&&Q.log||console&&console.log||function(){},ko()},handleCommand:Co};function ko(){if(De("ObsoleteBridge---test---init---"),_e=window.SensorsData_APP_JS_Bridge,$t=_e&&_e.sensorsdata_track,pt=_e&&_e.sensorsdata_verify,Rt=_e&&_e.sensorsdata_visual_verify,De("ObsoleteBridge-",Q.bridge.activeBridge,pt,$t,Rt),Q&&!Q.bridge.activeBridge&&(pt||$t||Rt)){Q.bridge.activeBridge=Bn;let e=pt||$t;Rt&&(e=!!Rt.call(_e,JSON.stringify({server_url:Q.para.server_url})),De("ObsoleteBridge---called-return",e)),Q.bridge.bridge_info={touch_app_bridge:!0,platform:"android",verify_success:e?"success":"fail"},Q.para.app_js_bridge?(Q.registerInterceptor("sendDataStage",{send:{priority:80,entry:Fo}}),De("Android obsolete bridge inits succeed.")):De("app_js_bridge is not configured, data will not be sent by android obsolete bridge.")}}function Fo(e,t){if(De("ObsoleteBridge---senddata"),Q.para.app_js_bridge.is_mui||e.data.type==="item_set"||e.data.type==="item_delete")return e;let r=e.callback;if(pt){let i=pt&&pt.call(_e,JSON.stringify(gt.extend({server_url:Q.para.server_url},e.data)));return De("ObsoleteBridge---anVerify-success",i),i?(gt.isFunction(r)&&r(),t.cancellationToken.cancel(),e):Q.para.app_js_bridge.is_send?(Q.debug.apph5({data:e.data,step:"3.1",output:"all"}),e):(gt.isFunction(r)&&r(),t.cancellationToken.cancel(),e)}return De("ObsoleteBridge---is-send-old-way",Q.para.app_js_bridge.is_send),$t&&$t.call(_e,JSON.stringify(gt.extend({server_url:Q.para.server_url},e.data))),gt.isFunction(r)&&r(),t.cancellationToken.cancel(),e}function Co(e){De("ObsoleteBridge---handleCommadn");let t=e.callType;return t in Xr.commands?(De("ObsoleteBridge---",t,Xr.commands),Xr.commands[t](e,_e)):_e&&gt.isFunction(_e.sensorsdata_js_call_app)?(De("ObsoleteBridge---handleCommadn-abridge"),_e.sensorsdata_js_call_app(JSON.stringify(e))):void 0}let he,Se,Yr,Zr,In=$o(Bn,"AndroidObsoleteBridge","sdkAfterInitPara"),Eo="1.27.11";function Do(e,t,r){if(e.plugin_name=t,e.init){let i=e.init;e.init=function(n,a){if(Po(n,e,t),n.readyState&&n.readyState.state>=3||!n.on)return l();function l(){i.call(e,n,a)}n.on(r,l)}}return e}function Po(e,t,r){function i(n,a){e.logger?e.logger.msg.apply(e.logger,a).module(`${r}`||"").level(n).log():e.log&&e.log.apply(e,a)}t.log=function(){i("log",arguments)},t.warn=function(){i("warn",arguments)},t.error=function(){i("error",arguments)}}function Ao(e,t,r){return Do(e,t,r),e.plugin_version=Eo,e}let Ht;var $e={event_list:[],latest_event_initial_time:null,max_save_time:2592e6,init(e,t){if(Se||!e)return!1;Zr=(t=t||{}).cookie_name||"sensorsdata2015jssdkchannel",Se=e;let r=this;(function(){if(he=Se._,Yr=Se.store,!he.localStorage.isSupport())return!1;r.eventList.init(),r.addLatestChannelUrl(),r.addIsChannelCallbackEvent()})()},addIsChannelCallbackEvent(){Se.registerPage({$is_channel_callback_event(e){if(he.isObject(e)&&e.event&&e.event!=="$WebClick"&&e.event!=="$pageview"&&e.event!=="$WebStay"&&e.event!=="$SignUp")return!$e.eventList.hasEvent(e.event)&&($e.eventList.add(e.event),!0)}})},addLatestChannelUrl(){let e=this.getUrlDomain(),t=this.cookie.getChannel();if(e==="url解析失败")this.registerAndSave({_sa_channel_landing_url:"",_sa_channel_landing_url_error:"url的domain解析失败"});else if(he.isReferralTraffic(document.referrer)){let r=he.getQueryParam(location.href,"sat_cf");he.isString(r)&&r.length>0?(this.registerAndSave({_sa_channel_landing_url:location.href}),$e.channelLinkHandler()):this.registerAndSave({_sa_channel_landing_url:""})}else t?Se.registerPage(t):Se.registerPage({_sa_channel_landing_url:"",_sa_channel_landing_url_error:"取值异常"})},registerAndSave(e){Se.registerPage(e),this.cookie.saveChannel(e)},cookie:{getChannel(){let e=Se.kit.userDecryptIfNeeded(he.cookie.get(Zr));return e=he.safeJSONParse(e),!(!he.isObject(e)||!e.prop)&&e.prop},saveChannel(e){let r=JSON.stringify({prop:e});Se.para.encrypt_cookie&&(r=Se.kit.userEncrypt(r)),he.cookie.set(Zr,r)}},channelLinkHandler(){this.eventList.reset(),Se.track("$ChannelLinkReaching")},getUrlDomain(){let e=he.info.pageProp.url_domain;return e===""&&(e="url解析失败"),e},eventList:{init(){let e=this.get(),t=new Date().getTime();if(e&&he.isNumber(e.latest_event_initial_time)&&he.isArray(e.eventList)){let r=t-e.latest_event_initial_time;r>0&&r<$e.max_save_time?($e.event_list=e.eventList,$e.latest_event_initial_time=e.latest_event_initial_time):this.reset()}else this.reset()},get(){let e={};try{e=Yr.readObjectVal("sawebjssdkchannel")}catch(t){Se.log(t)}return e},add(e){$e.event_list.push(e),this.save()},save(){let e={latest_event_initial_time:$e.latest_event_initial_time,eventList:$e.event_list};Yr.saveObjectVal("sawebjssdkchannel",e)},reset(){$e.event_list=[],$e.latest_event_initial_time=new Date().getTime(),this.save()},hasEvent(e){let t=!1;return he.each($e.event_list,r=>{r===e&&(t=!0)}),t}}};let Bo=Ao($e,"SensorsChannel","sdkAfterInitAPI"),Io="1.27.11";function jo(e,t,r){if(e.init){let i=e.init;e.init=function(n,a){if(No(n,e,t),n.readyState&&n.readyState.state>=3||!n.on)return l();function l(){i.call(e,n,a)}n.on(r,l)}}return e}function No(e,t,r){function i(n,a){e.logger?e.logger.msg.apply(e.logger,a).module(`${r}`||"").level(n).log():e.log&&e.log.apply(e,a)}t.log=function(){i("log",arguments)},t.warn=function(){i("warn",arguments)},t.error=function(){i("error",arguments)}}function Oo(e,t,r){return jo(e,t,r),e.plugin_version=Io,e}let jn=function(){let e={};return typeof document.hidden<"u"?(e.hidden="hidden",e.visibilityChange="visibilitychange"):typeof document.msHidden<"u"?(e.hidden="msHidden",e.visibilityChange="msvisibilitychange"):typeof document.webkitHidden<"u"&&(e.hidden="webkitHidden",e.visibilityChange="webkitvisibilitychange"),e};function Nn(){return Ht!==void 0&&document[Ht]}Ht=jn().hidden;let Gr,ft,z,Jt,Qr,ei={android:/Android/i,iOS:/iPhone|iPad|iPod/i,harmony:/OpenHarmony/i},pr=function(){for(let e in ei)if(navigator.userAgent.match(ei[e]))return e;return""}(),To=function(){return ei.hasOwnProperty(pr)},gr=function(e){return e!=null&&Object.prototype.toString.call(e)=="[object Object]"},Lo=function(e){return e.match(/\/sd\/(\w+)\/(\w+)$/)},xo=function(e){let t=e._.URL(e.para.server_url);return{origin:t.origin,project:t.searchParams.get("project")||"default"}},On=function(e,t,r){e.log("尝试唤起 android app");let i=t;e.log(`唤起APP的地址：${i}`),window.location=i,e.timer=setTimeout(()=>{let n=Nn();if(e.log(`hide:${Ht}:${document[Ht]}`),n)return e.log("The page is hidden, stop navigating to download page"),!1;e.log("App可能未安装，跳转到下载地址"),window.location=r},e.timeout)},Uo=function(e,t,r){e.log(`尝试唤起 iOS app:${t}`),window.location.href=t,e.timer=setTimeout(()=>{if(Nn())return e.log("The page is hidden, stop navigating to download page"),!1;e.log("App可能未安装，跳转到下载地址"),window.location.href=r},e.timeout),e.log(`new timer:${e.timer}`)};var Mt={plugin_name:["deeplink","Deeplink"],key:null,timer:null,sd:null,data:null,timeout:2500,apiURL:"{origin}/sdk/deeplink/param?key={key}&system_type=JS&project={project}",init(e){if(this.sd)return this.logger("deeplink已经初始化"),!1;arguments[0]?gr(arguments[0])&&typeof arguments[0].timeout=="number"?this.sd=window.sensorsDataAnalytic201505:this.sd=e:this.sd=window.sensorsDataAnalytic201505;let t={};if(arguments.length>0&&(arguments.length===1&&gr(arguments[0])?t=arguments[0]:arguments.length>=2&&gr(arguments[1])&&(t=arguments[1])),!To())return this.logger("不支持当前系统，目前只支持Android和iOS"),!1;if(gr(t)&&this.sd._.isNumber(t.timeout)&&t.timeout>=2500&&(this.timeout=t.timeout),!this.sd.para.server_url)return this.logger("神策JS SDK配置项server_url未正确配置"),!1;let r=xo(this.sd);this.apiURL=this.apiURL.replace("{origin}",r.origin).replace("{project}",r.project);let i=this.sd._.getQueryParam(window.location.href,"deeplink");if(!i)return this.logger("当前页面缺少deeplink参数"),!1;i=window.decodeURIComponent(i);let n=Lo(i);if(!n)return this.logger("当前页面的deeplink参数无效"),!1;this.key=n[2],this.apiURL=this.apiURL.replace("{key}",window.encodeURIComponent(n[2])),this.sd._.ajax({url:this.apiURL,type:"GET",cors:!0,credentials:!1,success:(function(a){if(a.errorMsg)return Mt.logger(`API报错：${a.errorMsg}`),!1;Mt.data=a,Mt.logger(`API查询成功，数据：${JSON.stringify(a,null,"  ")}`),this.data.app_key&&(this.data.android_info&&this.data.android_info.url_schemes&&(this.data.android_info.url_schemes+=`://sensorsdata/sd/${this.data.app_key}/${this.key}`),this.data.ios_info&&this.data.ios_info.url_schemes&&(this.data.ios_info.url_schemes+=`://sensorsdata/sd/${this.data.app_key}/${this.key}`),this.data.harmony_info&&this.data.harmony_info.url_schemes&&(this.data.harmony_info.url_schemes+=`://sensorsdata/sd/${this.data.app_key}/${this.key}`))}).bind(this),error(){Mt.logger("API查询出错")}}),this.addListeners()},openDeepLink(){if(this.logger("openDeeplink()"),!this.data)return this.logger("没有Deep link数据!"),!1;if(pr==="iOS"){this.logger("当前系统是iOS");let e=this.sd&&this.sd._&&this.sd._.getIOSVersion()>=9&&this.data.ios_info.ios_wake_url?this.data.ios_info.ios_wake_url:this.data.ios_info.url_schemes;this.logger(`唤起APP的地址：${e}`),Uo(this,e,this.data.ios_info.download_url)}else if(pr==="android")this.logger("当前系统是 android"),On(this,this.data.android_info.url_schemes,this.data.android_info.download_url);else if(pr==="harmony"){let e=this.data.harmony_info.app_linking_url||this.data.harmony_info.url_schemes;this.logger("当前系统是 HarmonyOS"),On(this,e,this.data.harmony_info.download_url)}},logger(e){this.sd&&this.sd.log(e)},addListeners(){let e=jn().visibilityChange,t=this;e&&document.addEventListener(e,()=>{clearTimeout(t.timer),t.logger(`visibilitychange, clear timeout:${t.timer}`)},!1),window.addEventListener("pagehide",()=>{t.logger(`page hide, clear timeout:${t.timer}`),clearTimeout(t.timer)},!1)}};let Ro=Oo(Mt,null,"sdkReady"),Ho="1.27.11";function Jo(e,t,r){if(e.plugin_name=t,e.init){let i=e.init;e.init=function(n,a){if(Mo(n,e,t),n.readyState&&n.readyState.state>=3||!n.on)return l();function l(){i.call(e,n,a)}n.on(r,l)}}return e}function Mo(e,t,r){function i(n,a){e.logger?e.logger.msg.apply(e.logger,a).module(`${r}`||"").level(n).log():e.log&&e.log.apply(e,a)}t.log=function(){i("log",arguments)},t.warn=function(){i("warn",arguments)},t.error=function(){i("error",arguments)}}function qo(e,t,r){return Jo(e,t,r),e.plugin_version=Ho,e}let Tn={init(e){Jt=(z=e)&&z._,Qr=z&&z.log||console&&console.log||function(){},Ko()},handleCommand:Wo};function Ko(){Gr=window.SensorsData_iOS_JS_Bridge&&window.SensorsData_iOS_JS_Bridge.sensorsdata_app_server_url,ft=function(){return window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.sensorsdataNativeTracker},z&&!z.bridge.activeBridge&&ft()&&ft().postMessage&&(z.bridge.activeBridge=Tn,z.para.app_js_bridge&&!z.para.app_js_bridge.is_mui&&(z.bridge.is_verify_success=Gr&&z.bridge.validateAppUrl(Gr)),z.bridge.bridge_info={touch_app_bridge:!0,platform:"ios",verify_success:z.bridge.is_verify_success?"success":"fail",support_two_way_call:!0},z.para.app_js_bridge?(z.registerInterceptor("sendDataStage",{send:{priority:70,entry:Vo}}),Qr("IOS bridge inits succeed.")):Qr("app_js_bridge is not configured, data will not be sent by iOS bridge."))}function Vo(e,t){if(z.para.app_js_bridge.is_mui||e.data.type==="item_set"||e.data.type==="item_delete")return e;let r=e.callback;return z.bridge.is_verify_success?(ft()&&ft().postMessage(JSON.stringify({callType:"app_h5_track",data:Jt.extend({server_url:z.para.server_url},e.data)})),Jt.isFunction(r)&&r(),t.cancellationToken.cancel(),e):z.para.app_js_bridge.is_send?(z.debug.apph5({data:e.data,step:"4.1",output:"all"}),e):(Jt.isFunction(r)&&r(),t.cancellationToken.cancel(),e)}function Wo(e){let t=e.callType;return t!=="page_info"&&t!=="visualized_track"||z.bridge.hasVisualModeBridge()?t==="sensorsdata_get_app_visual_config"?Jt.isObject(window.SensorsData_APP_New_H5_Bridge)&&window.SensorsData_APP_New_H5_Bridge[t]:ft()&&ft().postMessage(JSON.stringify(e)):null}let ee,kt,ti,Ln=qo(Tn,"IOSBridge","sdkAfterInitPara"),zo="1.27.11";function Xo(e,t,r){if(e.plugin_name=t,e.init){let i=e.init;e.init=function(n,a){if(Yo(n,e,t),n.readyState&&n.readyState.state>=3||!n.on)return l();function l(){i.call(e,n,a)}n.on(r,l)}}return e}function Yo(e,t,r){function i(n,a){e.logger?e.logger.msg.apply(e.logger,a).module(`${r}`||"").level(n).log():e.log&&e.log.apply(e,a)}t.log=function(){i("log",arguments)},t.warn=function(){i("warn",arguments)},t.error=function(){i("error",arguments)}}function Zo(e,t,r){return Xo(e,t,r),e.plugin_version=zo,e}let xn={init(e){kt=(ee=e)&&ee._,ti=ee&&ee.log||console&&console.log||function(){},Go()}};function Go(){ee&&!ee.bridge.activeBridge&&Qo()&&(ee.bridge.activeBridge=xn,ee.bridge.bridge_info={touch_app_bridge:!0,platform:"ios",verify_success:el()?"success":"fail"},ee.para.app_js_bridge?(ee.registerInterceptor("sendDataStage",{send:{priority:90,entry:tl}}),ti("IOS obsolete bridge inits succeed.")):ti("app_js_bridge is not configured, data will not be sent by iOS obsolete bridge."))}function Qo(){return(/sensors-verify/.test(navigator.userAgent)||/sa-sdk-ios/.test(navigator.userAgent))&&!window.MSStream}function el(){if(/sensors-verify/.test(navigator.userAgent)){let e=navigator.userAgent.match(/sensors-verify\/(\S+)/);if(e&&e[0]&&typeof e[1]=="string"&&e[1].split("?").length===2){e=e[1].split("?");let t=null,r=null;try{t=kt.URL(ee.para.server_url).hostname,r=kt.URL(ee.para.server_url).searchParams.get("project")||"default"}catch(i){ee.log(i)}return!(!t||t!==e[0]||!r||r!==e[1])}return!1}return!!/sa-sdk-ios/.test(navigator.userAgent)}function tl(e,t){if(ee.para.app_js_bridge.is_mui||e.data.type==="item_set"||e.data.type==="item_delete")return e;let r,i,n=e.callback;if(ee.bridge.bridge_info.verify_success){let a=document.createElement("iframe"),l=(r=e.data,i=(i=JSON.stringify(kt.extend({server_url:ee.para.server_url},r))).replace(/\r\n/g,""),`sensorsanalytics://trackEvent?event=${i=encodeURIComponent(i)}`);return a.setAttribute("src",l),document.documentElement.appendChild(a),a.parentNode.removeChild(a),a=null,kt.isFunction(n)&&n(),t.cancellationToken.cancel(),!0}return ee.para.app_js_bridge.is_send?(ee.debug.apph5({data:e.data,step:"3.2",output:"all"}),e):(kt.isFunction(n)&&n(),t.cancellationToken.cancel(),e)}let Un=Zo(xn,"IOSObsoleteBridge","sdkAfterInitPara"),rl="1.27.11";function il(e,t,r){if(e.plugin_name=t,e.init){let i=e.init;e.init=function(n,a){if(nl(n,e,t),n.readyState&&n.readyState.state>=3||!n.on)return l();function l(){i.call(e,n,a)}n.on(r,l)}}return e}function nl(e,t,r){function i(n,a){e.logger?e.logger.msg.apply(e.logger,a).module(`${r}`||"").level(n).log():e.log&&e.log.apply(e,a)}t.log=function(){i("log",arguments)},t.warn=function(){i("warn",arguments)},t.error=function(){i("error",arguments)}}function al(e,t,r){return il(e,t,r),e.plugin_version=rl,e}let sl=5e3,ol=432e3;function X(){this.sd=null,this.start_time=+new Date,this.page_show_status=!0,this.page_hidden_status=!1,this._={},this.timer=null,this.current_page_url=document.referrer,this.url=location.href,this.title=document.title||"",this.option={},this.heartbeat_interval_time=5e3,this.heartbeat_interval_timer=null,this.page_id=null,this.storage_name="sawebjssdkpageleave",this.max_duration=ol}X.prototype.init=function(e,t){if(e){if(this.sd=e,this._=this.sd._,t){this.option=t;let r=t.heartbeat_interval_time;r&&(this._.isNumber(r)||this._.isNumber(1*r))&&1*r>0&&(this.heartbeat_interval_time=1e3*r);let i=t.max_duration;i&&(this._.isNumber(i)||this._.isNumber(1*i))&&1*i>0&&(this.max_duration=i)}this.page_id=Number(String(this._.getRandom()).slice(2,5)+String(this._.getRandom()).slice(2,4)+String(new Date().getTime()).slice(-4)),this.addEventListener(),document.hidden===!0?this.page_show_status=!1:this.addHeartBeatInterval(),this.log("PageLeave初始化完毕")}else this.log("神策JS SDK未成功引入")},X.prototype.log=function(e){this.sd&&this.sd.log(e)},X.prototype.refreshPageEndTimer=function(){let e=this;this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(()=>{e.page_hidden_status=!1},sl)},X.prototype.hiddenStatusHandler=function(){clearTimeout(this.timer),this.timer=null,this.page_hidden_status=!1},X.prototype.pageStartHandler=function(){let e=this.getPageLeaveProperties();this.start_time=+new Date,document.hidden?this.page_show_status=!1:this.page_show_status=!0,this.url=location.href,delete e[this.option.event_duration],this.isCollectUrl(this.url)&&this.sd.track(this.option.event_name_view,Object.assign(e,this.option.urlPropertyMap(this.url))),this.title=document.title},X.prototype.pageEndHandler=function(){if(this.page_hidden_status!==!0){let e=this.getPageLeaveProperties();this.page_show_status===!1&&delete e[this.option.event_duration],this.page_show_status=!1,this.page_hidden_status=!0,this.isCollectUrl(this.url)&&this.sd.track(this.option.event_name_leave,Object.assign(e,this.option.urlPropertyMap(this.url))),this.refreshPageEndTimer(),this.delHeartBeatData()}},X.prototype.addEventListener=function(){this.addPageStartListener(),this.addPageSwitchListener(),this.addSinglePageListener(),this.addPageEndListener()},X.prototype.addPageStartListener=function(){let e=this;"onpageshow"in window&&this._.addEvent(window,"pageshow",()=>{e.pageStartHandler(),e.hiddenStatusHandler()})},X.prototype.isCollectUrl=function(e){return typeof this.option.isCollectUrl!="function"||typeof e!="string"||e===""||this.option.isCollectUrl(e)},X.prototype.addSinglePageListener=function(){let e=this;this.sd.ee&&this.sd.ee.spa.prepend("switch",t=>{t!==location.href&&(e.url=t,e.pageEndHandler(),e.stopHeartBeatInterval(),e.current_page_url=e.url,e.pageStartHandler(),e.hiddenStatusHandler(),e.addHeartBeatInterval())})},X.prototype.addPageEndListener=function(){let e=this;this._.each(["pagehide","beforeunload","unload"],t=>{`on${t}`in window&&e._.addEvent(window,t,()=>{e.pageEndHandler(),e.stopHeartBeatInterval()})})},X.prototype.addPageSwitchListener=function(){let e=this;this._.listenPageState({visible(){e.pageStartHandler(),e.hiddenStatusHandler(),e.addHeartBeatInterval()},hidden(){e.url=location.href,e.title=document.title,e.pageEndHandler(),e.stopHeartBeatInterval()}})},X.prototype.addHeartBeatInterval=function(){this._.localStorage.isSupport()&&this.startHeartBeatInterval()},X.prototype.startHeartBeatInterval=function(){let e=this;this.heartbeat_interval_timer&&this.stopHeartBeatInterval();let t=!0;this.isCollectUrl(this.url)||(t=!1),this.heartbeat_interval_timer=setInterval(()=>{t&&e.saveHeartBeatData()},this.heartbeat_interval_time),t&&this.saveHeartBeatData("is_first_heartbeat"),this.reissueHeartBeatData()},X.prototype.stopHeartBeatInterval=function(){clearInterval(this.heartbeat_interval_timer),this.heartbeat_interval_timer=null},X.prototype.saveHeartBeatData=function(e){let t=this.getPageLeaveProperties(),r=new Date;t.$time=r,e==="is_first_heartbeat"&&(t[this.option.event_duration]=3.14);let i=this.sd.kit.buildData({type:"track",event:this.option.event_name_leave,properties:t});i.heartbeat_interval_time=this.heartbeat_interval_time,this.sd.store.saveObjectVal(`${this.storage_name}-${this.page_id}`,i)},X.prototype.delHeartBeatData=function(e){this._.localStorage.isSupport()&&this._.localStorage.remove(e||`${this.storage_name}-${this.page_id}`)},X.prototype.reissueHeartBeatData=function(){for(let e=window.localStorage.length-1;e>=0;e--){let t=window.localStorage.key(e);if(t&&t!==`${this.storage_name}-${this.page_id}`&&t.indexOf(`${this.storage_name}-`)===0){let r=this.sd.store.readObjectVal(t);this._.isObject(r)&&1*new Date-r.time>r.heartbeat_interval_time+5e3&&(delete r.heartbeat_interval_time,r._flush_time=new Date().getTime(),this.sd.kit.sendData(r),this.delHeartBeatData(t))}}},X.prototype.getPageLeaveProperties=function(){let e=(+new Date-this.start_time)/1e3;(isNaN(e)||e<0||e>this.max_duration)&&(e=0),e=Number(e.toFixed(3));let t=this._.getReferrer(this.current_page_url),r=document.documentElement&&document.documentElement.scrollTop||window.pageYOffset||document.body&&document.body.scrollTop||0;r=Math.round(r)||0;let i=this.sd.getPresetProperties(),n={$title:this.title,$url:this._.getURL(this.url),$url_path:this._.getURLPath(this._.URL(this.url).pathname),$referrer_host:t?this._.getHostname(t):"",$referrer:t,$viewport_position:r,$utm_source:i.$utm_source,$utm_medium:i.$utm_medium,$utm_term:i.$utm_term,$utm_content:i.$utm_content,$utm_campaign:i.$utm_campaign,$latest_utm_source:i.$latest_utm_source,$latest_utm_medium:i.$latest_utm_medium,$latest_utm_term:i.$latest_utm_term,$latest_utm_content:i.$latest_utm_content,$latest_utm_campaign:i.$latest_utm_campaign};return e!==0&&(n[this.option.event_duration]=e),n=this._.extend(n,this.option.custom_props)};let ll=new X,ul=al(ll,"PageLeave","sdkReady"),cl="1.27.11";function dl(e,t,r){if(e.plugin_name=t,e.init){let i=e.init;e.init=function(n,a){if(pl(n,e,t),n.readyState&&n.readyState.state>=3||!n.on)return l();function l(){i.call(e,n,a)}n.on(r,l)}}return e}function pl(e,t,r){function i(n,a){e.logger?e.logger.msg.apply(e.logger,a).module(`${r}`||"").level(n).log():e.log&&e.log.apply(e,a)}t.log=function(){i("log",arguments)},t.warn=function(){i("warn",arguments)},t.error=function(){i("error",arguments)}}function gl(e,t,r){return dl(e,t,r),e.plugin_version=cl,e}let Rn=!1,fl=gl({init(e,t){function r(){let i=0,n=window.performance||window.webkitPerformance||window.msPerformance||window.mozPerformance,a={$url:e._.getURL(),$title:document.title,$url_path:e._.getURLPath(),$referrer:e._.getReferrer(null,!0)};if(n?(i=function(l){let u=0;return e._.isFunction(l.getEntriesByType)&&(u=((l.getEntriesByType("navigation")||[{}])[0]||{}).domContentLoadedEventEnd||0),u}(n)||function(l){let u=0;if(l.timing){let p=l.timing;p.fetchStart!==0&&e._.isNumber(p.fetchStart)&&p.domContentLoadedEventEnd!==0&&e._.isNumber(p.domContentLoadedEventEnd)?u=p.domContentLoadedEventEnd-p.fetchStart:e.log("performance 数据获取异常")}return u}(n),function(l,u){if(l.getEntries&&typeof l.getEntries=="function"){for(var p=l.getEntries(),b=null,w=0;w<p.length;w++)"transferSize"in p[w]&&(b+=p[w].transferSize);e._.isNumber(b)&&b>=0&&b<10737418240&&(u.$page_resource_size=Number((b/1024).toFixed(3)))}}(n,a)):e.log("浏览器未支持 performance API."),i>0){let l=e._.isObject(t)&&t.max_duration||1800;i=Number((i/1e3).toFixed(3)),(!e._.isNumber(l)||l<=0||i<=l)&&(a.event_duration=i)}Rn||(e.track("$WebPageLoad",a),Rn=!0),window.removeEventListener?window.removeEventListener("load",r):window.detachEvent&&window.detachEvent("onload",r)}document.readyState=="complete"?r():window.addEventListener?window.addEventListener("load",r):window.attachEvent&&window.attachEvent("onload",r)}},"PageLoad","sdkReady");function _l(e,t){if(e.type!=="track")return e;let r=t.sd,i=r._,n=r.saEvent.check,a=i.extend2Lev({properties:{}},e),l=t.customRegister,u=a.properties,p=a.event,b={};return i.each(l,w=>{if(i.isObject(w))i.includes(w.events,p)&&n({properties:w.properties})&&(b=i.extend(b,w.properties));else if(i.isFunction(w)){let L=w({event:p,properties:u,data:a});i.isObject(L)&&!i.isEmptyObject(L)&&n({properties:L})&&(b=i.extend(b,L))}}),e.properties=i.extend(u,b),e}function qt(){this.sd=null,this.log=window.console&&window.console.log||function(){},this.customRegister=[]}qt.prototype.init=function(e){if(e){this.sd=e,this._=e._,this.log=e.log;let t=this;e.registerInterceptor("buildDataStage",{extendProps:{priority:0,entry(r){return _l(r,t)}}})}else this.log("神策JS SDK未成功引入")},qt.prototype.register=function(e){this.sd?this._.isObject(e)&&this._.isArray(e.events)&&e.events.length>0&&this._.isObject(e.properties)&&!this._.isEmptyObject(e.properties)?this.customRegister.push(e):this.log("RegisterProperties: register 参数错误"):this.log("神策JS SDK未成功引入")},qt.prototype.hookRegister=function(e){this.sd?this._.isFunction(e)?this.customRegister.push(e):this.log("RegisterProperties: hookRegister 参数错误"):this.log("神策JS SDK未成功引入")};let hl="1.27.11";function ml(e,t,r){return e.plugin_version=hl,e}qt.prototype.plugin_name="RegisterProperties";let yl=new qt,vl=ml(yl),bl="1.27.11";function wl(e,t,r){if(e.plugin_name=t,e.init){let i=e.init;e.init=function(n,a){if(Sl(n,e,t),n.readyState&&n.readyState.state>=3||!n.on)return l();function l(){i.call(e,n,a)}n.on(r,l)}}return e}function Sl(e,t,r){function i(n,a){e.logger?e.logger.msg.apply(e.logger,a).module(`${r}`||"").level(n).log():e.log&&e.log.apply(e,a)}t.log=function(){i("log",arguments)},t.warn=function(){i("warn",arguments)},t.error=function(){i("error",arguments)}}function $l(e,t,r){return wl(e,t,r),e.plugin_version=bl,e}let Ft,Hn,Kt=window.console&&window.console.log||function(){};function kl(e){try{if(e.event!=="$pageview"&&(!e.type||e.type.slice(0,7)!=="profile")){let t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0,r=document.documentElement.scrollHeight||0,i={$page_height:Math.max(t,r)||0};e.properties=Ft._.extend(e.properties||{},i)}}catch{Kt("页面高度获取异常。")}return Hn.call(Ft.kit,e)}let Fl=$l({init(e){Kt=(Ft=e)&&Ft.log||Kt,e&&e.kit&&e.kit.buildData?(Hn=Ft.kit.buildData,Ft.kit.buildData=kl,Kt("RegisterPropertyPageHeight 插件初始化完成")):Kt("RegisterPropertyPageHeight 插件初始化失败,当前主sdk不支持 RegisterPropertyPageHeight 插件，请升级主sdk")}},"RegisterPropertyPageHeight","sdkReady"),Cl="1.27.11";function El(e,t,r){if(e.plugin_name=t,e.init){let i=e.init;e.init=function(n,a){if(Dl(n,e,t),n.readyState&&n.readyState.state>=3||!n.on)return l();function l(){i.call(e,n,a)}n.on(r,l)}}return e}function Dl(e,t,r){function i(n,a){e.logger?e.logger.msg.apply(e.logger,a).module(`${r}`||"").level(n).log():e.log&&e.log.apply(e,a)}t.log=function(){i("log",arguments)},t.warn=function(){i("warn",arguments)},t.error=function(){i("error",arguments)}}function Pl(e,t,r){return El(e,t,r),e.plugin_version=Cl,e}let ze,Al=Pl({getPart(e){let t=this.option.length;if(t){for(let r=0;r<t;r++)if(e.includes(this.option[r].part_url))return!0}return!1},getPartHash(e){let t=this.option.length;if(t){for(let r=0;r<t;r++)if(e.includes(this.option[r].part_url))return this.option[r].after_hash}return!1},getCurrenId(){let e=this.store.getDistinctId()||"",t=this.store.getFirstId()||"";return this._.urlSafeBase64&&this._.urlSafeBase64.encode?e=e?this._.urlSafeBase64.trim(this._.urlSafeBase64.encode(this._.base64Encode(e))):"":this._.rot13obfs&&(e=e?this._.rot13obfs(e):""),encodeURIComponent(t?`f${e}`:`d${e}`)},rewriteUrl(e,t){let r=this,i=/([^?#]+)(\?[^#]*)?(#.*)?/.exec(e),n="";if(i){let a,l=i[1]||"",u=i[2]||"",p=i[3]||"",b=`_sasdk=${this.getCurrenId()}`,w=function(L){let B=L.split("&"),ke=[];return r._.each(B,q=>{q.includes("_sasdk=")?ke.push(b):ke.push(q)}),ke.join("&")};return this.getPartHash(e)?(a=p.indexOf("_sasdk"),n=p.includes("?")?a>-1?`${l+u}#${p.substring(1,a)}${w(p.substring(a,p.length))}`:`${l+u+p}&${b}`:`${l+u}#${p.substring(1)}?${b}`):(a=u.indexOf("_sasdk"),n=/^\?(\w)+/.test(u)?a>-1?`${l}?${w(u.substring(1))}${p}`:`${l+u}&${b}${p}`:`${l}?${b}${p}`),t&&(t.href=n),n}},getUrlId(){let e=location.href.match(/_sasdk=([aufd][^?#&=]+)/);if(this._.isArray(e)&&e[1]){let t=decodeURIComponent(e[1]);return!t||t.substring(0,1)!=="f"&&t.substring(0,1)!=="d"||(this._.urlSafeBase64&&this._.urlSafeBase64.isUrlSafeBase64&&this._.urlSafeBase64.isUrlSafeBase64(t)?t=t.substring(0,1)+this._.base64Decode(this._.urlSafeBase64.decode(t.substring(1))):this._.rot13defs&&(t=t.substring(0,1)+this._.rot13defs(t.substring(1)))),t}return""},setRefferId(e){let t=this.store.getDistinctId(),r=this.getUrlId();if(r&&r!==""){let i=r.substring(0,1)==="a"||r.substring(0,1)==="d";(r=r.substring(1))!==t&&(i?(this.sd.identify(r,!0),this.store.getFirstId()&&this.sd.saEvent.send({original_id:r,distinct_id:t,type:"track_signup",event:"$SignUp",properties:{}},null)):this.store.getFirstId()&&!e.re_login||this.sd.login(r))}},addListen(){let e=this,t=function(r){let i,n,a=r.target,l=a.tagName.toLowerCase(),u=a.parentNode;if(l==="a"&&a.href||u&&u.tagName&&u.tagName.toLowerCase()==="a"&&u.href){l==="a"&&a.href?(i=a.href,n=a):(i=u.href,n=u);let p=e._.URL(i).protocol;p!=="http:"&&p!=="https:"||e.getPart(i)&&e.rewriteUrl(i,n)}};e._.addEvent(document,"mousedown",t),window.PointerEvent&&"maxTouchPoints"in window.navigator&&window.navigator.maxTouchPoints>=0&&e._.addEvent(document,"pointerdown",t)},init(e,t){this.sd=e,this._=e._,this.store=e.store,this.para=e.para,this._.isObject(t)&&this._.isArray(t.linker)&&t.linker.length>0?(this.setRefferId(t),this.addListen(),this.option=t.linker,this.option=function(r){for(var i=r.length,n=[],a=0;a<i;a++)/[A-Z0-9]+\./i.test(r[a].part_url)&&Object.prototype.toString.call(r[a].after_hash)=="[object Boolean]"?n.push(r[a]):e.log(`linker 配置的第 ${a+1} 项格式不正确，请检查参数格式！`);return n}(this.option)):e.log("请配置打通域名参数！")}},"SiteLinker","sdkReady"),Bl="utm_source utm_medium utm_campaign utm_content utm_term",Il="1.27.11";function jl(e,t,r){if(e.plugin_name=t,e.init){let i=e.init;e.init=function(n,a){if(Nl(n,e,t),n.readyState&&n.readyState.state>=3||!n.on)return l();function l(){i.call(e,n,a)}n.on(r,l)}}return e}function Nl(e,t,r){function i(n,a){e.logger?e.logger.msg.apply(e.logger,a).module(`${r}`||"").level(n).log():e.log&&e.log.apply(e,a)}t.log=function(){i("log",arguments)},t.warn=function(){i("warn",arguments)},t.error=function(){i("error",arguments)}}function Ol(e,t,r){return jl(e,t,r),e.plugin_version=Il,e}let Jn=Ol({init(e){e&&!ze&&(ze=e).registerInterceptor("businessStage",{getUtmData:{priority:0,entry(){return function(){let t=Bl.split(" "),r="",i={};return ze._.isArray(ze.para.source_channel)&&ze.para.source_channel.length>0&&(t=t.concat(ze.para.source_channel),t=ze._.unique(t)),ze._.each(t,n=>{(r=ze._.getQueryParam(location.href,n)).length&&(i[n]=r)}),i}()}}})}},"Utm","sdkAfterInitPara"),Tl="1.27.11";function Ll(e,t,r){if(e.plugin_name=t,e.init){let i=e.init;e.init=function(n,a){if(xl(n,e,t),n.readyState&&n.readyState.state>=3||!n.on)return l();function l(){i.call(e,n,a)}n.on(r,l)}}return e}function xl(e,t,r){function i(n,a){e.logger?e.logger.msg.apply(e.logger,a).module(`${r}`||"").level(n).log():e.log&&e.log.apply(e,a)}t.log=function(){i("log",arguments)},t.warn=function(){i("warn",arguments)},t.error=function(){i("error",arguments)}}function Ul(e,t,r){return Ll(e,t,r),e.plugin_version=Tl,e}let ri=!1,ii=null,Rl={init(e){(ii=e).disableSDK=Hl,ii.enableSDK=Jl,ii.getDisabled=Ml}};function Hl(){ri=!0}function Jl(){ri=!1}function Ml(){return ri}let K,_t,Mn=Ul(Rl,"DisableSDK","sdkInitAPI"),ql="1.27.11";function Kl(e,t,r){return e.plugin_version=ql,e}function Vl(e){let t=e,r="";r=K.para.debug_mode_url.includes("?")?`${K.para.debug_mode_url}&${K.kit.encodeTrackData(e)}`:`${K.para.debug_mode_url}?${K.kit.encodeTrackData(e)}`,_t.ajax({url:r,type:"GET",cors:!0,header:{"Dry-Run":String(K.para.debug_mode_upload)},success(i){_t.isEmptyObject(i)===!0?alert(`debug数据发送成功${t}`):alert(`debug失败 错误原因${JSON.stringify(i)}`)}})}function Wl(e,t){if(K.para.debug_mode===!0){let r=e.data;e.callback,Vl(JSON.stringify(r)),t.cancellationToken.stop()}return e}function zl(){K.para.debug_mode===!0&&(K.para.debug_mode_upload=K.para.debug_mode_upload||!1,_t.isString(K.para.debug_mode_url)||(_t.isString(K.para.server_url)?K.para.debug_mode_url=K.para.server_url.replace("sa.gif","debug"):_t.isArray(K.para.server_url)&&_t.isString(K.para.server_url[0])?K.para.debug_mode_url=K.para.server_url[0].replace("sa.gif","debug"):K.para.debug_mode=!1))}function Xl(){K.on("sdkInitPara",()=>{zl()}),K.on("sdkAfterInitPara",()=>{K.registerInterceptor("sendDataStage",{send:{priority:30,entry:Wl}})})}let ue,ht,qn=Kl({plugin_name:"DebugSender",init(e){_t=(K=e)._,Xl()}}),Yl="1.27.11";function Zl(e,t,r){return e.plugin_version=Yl,e}function Gl(e,t){if(ht.isObject(ue.para.jsapp)&&!ue.para.jsapp.isOnline&&typeof ue.para.jsapp.setData=="function"){let r=e;delete r.callback,r=JSON.stringify(r),ue.para.jsapp.setData(r),t.cancellationToken.stop()}return e}function Ql(){ue.on("sdkAfterInitAPI",()=>{ht.isObject(ue.commonWays)&&(ue.commonWays.setOnlineState=eu),ue.registerInterceptor("sendDataStage",{send:{priority:40,entry:Gl}})})}function eu(e){if(e===!0&&ht.isObject(ue.para.jsapp)&&typeof ue.para.jsapp.getData=="function"){ue.para.jsapp.isOnline=!0;let t=ue.para.jsapp.getData();ht.isArray(t)&&t.length>0&&ht.each(t,r=>{ht.isJSONString(r)&&ue.kit.sendData(JSON.parse(r))})}else ue.para.jsapp.isOnline=!1}let ce,tt,Kn=Zl({plugin_name:"JsappSender",init(e){ht=(ue=e)._,Ql()}}),tu="1.27.11";function ru(e,t,r){return e.plugin_version=tu,e}let fr=null;function iu(e,t){return!ce.para.app_js_bridge&&ce.para.batch_send&&tt.localStorage.isSupport()&&localStorage.length<ce.para.batch_send.storage_length&&(fr.add(e.data),t.cancellationToken.stop()),e}function nu(){let e={datasend_timeout:6e3,send_interval:6e3,storage_length:200};tt.localStorage.isSupport()&&tt.isSupportCors()&&typeof localStorage=="object"?ce.para.batch_send===!0?ce.para.batch_send=tt.extend({},e):typeof ce.para.batch_send=="object"&&(ce.para.batch_send=tt.extend({},e,ce.para.batch_send)):ce.para.batch_send=!1}function au(){ce.on("sdkInitPara",()=>{nu()}),ce.on("sdkAfterInitPara",()=>{!ce.para.app_js_bridge&&ce.para.batch_send&&tt.localStorage.isSupport()&&(fr||(fr=new tt.BatchSend),fr.batchInterval(),ce.registerInterceptor("sendDataStage",{send:{priority:100,entry:iu}}))})}let Ue,rt,Vn=ru({plugin_name:"BatchSender",init(e){tt=(ce=e)._,au()}}),su="1.27.11";function ou(e,t,r){return e.plugin_version=su,e}function Wn(e){new rt.BeaconSend(e).start()}function lu(e,t){let r=null,i=null;if(rt.isObject(e.config)&&(r=e.config.send_type,i=rt.optimizeServerUrl(e.config.server_url)),(r==="beacon"||!r&&Ue.para.send_type==="beacon")&&rt.isSupportBeaconSend()){let n=i||e.server_url;e.server_url=n,e.data=Ue.kit.encodeTrackData(e.data),rt.isArray(n)&&n.length?rt.each(n,a=>{e.callback=null,e.server_url=a,Wn(e)}):typeof n=="string"&&n!==""?Wn(e):Ue.log("当前 server_url 为空或不正确，只在控制台打印日志，network 中不会发数据，请配置正确的 server_url！"),t.cancellationToken.stop()}return e}function uu(){Ue.para.send_type!=="beacon"||rt.isSupportBeaconSend()||(Ue.para.send_type=Ue.DEFAULT_SEND_TYPE)}function cu(){Ue.on("sdkInitPara",()=>{uu()}),Ue.on("sdkAfterInitPara",()=>{Ue.registerInterceptor("sendDataStage",{send:{priority:110,entry:lu}})})}let Re,it,zn=ou({plugin_name:"BeaconSender",init(e){rt=(Ue=e)._,cu()}}),du="1.27.11";function pu(e,t,r){return e.plugin_version=du,e}function Xn(e){new it.AjaxSend(e).start()}function gu(e,t){let r=null,i=null;if(it.isObject(e.config)&&(r=e.config.send_type,i=it.optimizeServerUrl(e.config.server_url)),(r==="ajax"||!r&&Re.para.send_type==="ajax")&&it.isSupportCors()){let n=i||e.server_url;e.server_url=n,e.data=Re.kit.encodeTrackData(e.data),it.isArray(n)&&n.length?it.each(n,a=>{e.callback=null,e.server_url=a,Xn(e)}):typeof n=="string"&&n!==""?Xn(e):Re.log("当前 server_url 为空或不正确，只在控制台打印日志，network 中不会发数据，请配置正确的 server_url！"),t.cancellationToken.stop()}return e}function fu(){Re.para.send_type!=="ajax"||it.isSupportCors()||(Re.para.send_type=Re.DEFAULT_SEND_TYPE)}function _u(){Re.on("sdkInitPara",()=>{fu()}),Re.on("sdkAfterInitPara",()=>{Re.registerInterceptor("sendDataStage",{send:{priority:120,entry:gu}})})}let Ne,Ct,Yn=pu({plugin_name:"AjaxSender",init(e){it=(Re=e)._,_u()}}),hu="1.27.11";function mu(e,t,r){return e.plugin_version=hu,e}function Zn(e,t){let r=Ne.kit.encodeTrackData(t);return e.includes("?")?`${e}&${r}`:`${e}?${r}`}function Gn(e){new Ct.ImageSend(e).start()}function yu(e,t){let r=null;Ct.isObject(e.config)&&(r=Ct.optimizeServerUrl(e.config.server_url));let i=r||e.server_url,n=e.data;e.server_url=i,Ct.isArray(i)&&i.length?Ct.each(i,a=>{a&&(e.data=Zn(a,n),e.callback=null,e.server_url=a,Gn(e))}):typeof i=="string"&&i!==""?(e.data=Zn(i,n),Gn(e)):Ne.logger&&Ne.logger.msg("当前 server_url 为空或不正确，只在控制台打印日志，network 中不会发数据，请配置正确的 server_url！").level("warn").log(),t.cancellationToken.stop()}function vu(){Ne.para.send_type!=="image"&&Ne.para.send_type!=="ajax"&&Ne.para.send_type!=="beacon"&&(Ne.para.send_type="image")}function bu(){Ne.on("sdkInitPara",()=>{vu()}),Ne.on("sdkAfterInitPara",()=>{Ne.registerInterceptor("sendDataStage",{send:{priority:130,entry:yu}})})}let Qn=mu({plugin_name:"ImageSender",init(e){Ct=(Ne=e)._,bu()}});function wu(e,t,r){return e.plugin_name=t,e}function Su(e,t,r){return wu(e,t,r),e.plugin_version=ir,e}let ae=null,me=null,Vt=[],ea=Su({init(e){e&&(me=(ae=e)._,ae.logger&&ae.logger.appendWriter($u),ae.on&&ae.on("sdkAfterInitPara",()=>{for(let t=0;t<Vt.length;t++)ta(Vt[t]);Vt=null}),ae.on&&ae.on("sdkInitAPI",()=>{ae.enableLocalLog=Eu,ae.disableLocalLog=Du}))}},"ConsoleLogger");function $u(e){Vt!==null?Vt.push(e):ta(e)}function ta(e){try{if(e.level==="log"&&ra()||e.level==="warn"&&ku()||e.level==="error"&&Fu())return void ni(e)}catch{}}function ra(){return!!si()||ae.para.show_log===!0||me.isObject(ae.para.show_log)&&ae.para.show_log.level==="log"}function ku(){return!!si()||ra()||me.isObject(ae.para.show_log)&&ae.para.show_log.level==="warn"}function Fu(){return!!si()||!me.isObject(ae.para.show_log)||ae.para.show_log.level!=="none"}function ni(e){let t=e.content,r=me.isObject(t[0])?me.formatJsonString(t[0]):t[0],i=Cu(e);t[0]=i+(i.length>0?": ":"")+r;try{console&&(me.isFunction(console[e.level])?console[e.level].apply(console,t):me.isObject(console[e.level])&&console[e.level](t[0]))}catch{}}function Cu(e){let t="",r="",i=ae.para.show_log;return me.isObject(i)&&i.show_brand===!1||(t+=e.brand),me.isObject(i)&&i.show_level===!1||(t+=(t.length>0?"-":"")+e.level),t.length>0&&(t=`[${t}]`),me.isObject(i)&&i.show_module===!1||(r=e.module),t+r}let ai="sensorsdata_jssdk_debug";function Eu(){me.sessionStorage.isSupport()&&sessionStorage.setItem(ai,"true")}function Du(){me.sessionStorage.isSupport()&&sessionStorage.removeItem(ai)}function si(){return me.sessionStorage.isSupport()&&sessionStorage.getItem(ai)==="true"}s.modules=s.modules||{};for(var ia=[ea,ao,En,In,Bo,Ro,Ln,Un,ul,fl,vl,Fl,Al,Jn,Mn,qn,Kn,Vn,zn,Yn,Qn],na=[ea,eo,Jn,Mn,Kn,qn,En,Ln,In,Un,Vn,zn,Yn,Qn],mt=0;mt<ia.length;mt++){var Et=ia[mt];s._.isString(Et.plugin_name)?s.modules[Et.plugin_name]=Et:s._.isArray(Et.plugin_name)&&s._.each(Et.plugin_name,e=>{s.modules[e]=Et})}for(mt=0;mt<na.length;mt++)s.use(na[mt]);let aa=s;try{typeof window.sensorsDataAnalytic201505=="string"?(s.para=window[sensorsDataAnalytic201505].para,s._q=window[sensorsDataAnalytic201505]._q,window[sensorsDataAnalytic201505]=s,window.sensorsDataAnalytic201505=s,s.init()):typeof window.sensorsDataAnalytic201505>"u"?window.sensorsDataAnalytic201505=s:aa=window.sensorsDataAnalytic201505}catch(e){A(e)}let sa=aa;sa.DEFAULT_SEND_TYPE="image";const Pu={mounted(e,t){const r=Array.isArray(t.value)?t.value:[t.value],i=la(),n=[];r.forEach(({event:a,params:l,trigger:u})=>{if(a&&(u=u||"click",u==="click"||!u)){const p=()=>{i.track(a,l||{})};e.addEventListener("click",p,!0),n.push(()=>e.removeEventListener("click",p,!0))}}),e.__trackHandlers__=n},unmounted(e){const t=e.__trackHandlers__;t&&(t.forEach(r=>r()),delete e.__trackHandlers__)}},oi=sa;function oa(e,t){return Object.fromEntries(Object.entries(e).map(([r,i])=>[`${t}${r}`,i]))}class Au{constructor(t,r){return this.sensors=t,this.options=r,new Proxy(this,{get:(i,n,a)=>{if(Reflect.has(i,n))return Reflect.get(i,n,a);if(Reflect.has(i.sensors,n)){const l=i.sensors[n];return typeof l=="function"?l.bind(i.sensors):l}}})}track(t,r){this.sensors.track(`${this.options.project}_${t}`,r||{})}registerPage(t){this.sensors.registerPage(oa(t||{},`${this.options.project}_`))}setProfile(t){this.sensors.setProfile(oa(t||{},`${this.options.project}_`))}}let _r=null;function Bu(e){return oi.use("PageLeave",{event_duration:"page_duration",event_name_view:`${e.project}_page_view`,event_name_leave:`${e.project}_page_leave`,urlPropertyMap:e.pageLeave.urlPropertyMap,isCollectUrl:e.pageLeave.isCollectUrl}),oi.init({...e.sensorsConfig}),_r=new Au(oi,e),_r}function la(){if(!_r)throw new Error("Analytics not initialized");return _r}Xe.getAnalytics=la,Xe.initAnalytics=Bu,Xe.vAnalytics=Pu,Object.defineProperty(Xe,Symbol.toStringTag,{value:"Module"})});
