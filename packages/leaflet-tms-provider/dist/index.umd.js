(function(p,c){typeof exports=="object"&&typeof module<"u"?c(exports):typeof define=="function"&&define.amd?define(["exports"],c):(p=typeof globalThis<"u"?globalThis:p||self,c(p.TmsProvider={}))})(this,function(p){"use strict";const c=(t,n)=>{var i=-100+2*t+3*n+.2*n*n+.1*t*n+.2*Math.sqrt(Math.abs(t));return i+=(20*Math.sin(6*t*pi)+20*Math.sin(2*t*pi))*2/3,i+=(20*Math.sin(n*pi)+40*Math.sin(n/3*pi))*2/3,i+=(160*Math.sin(n/12*pi)+320*Math.sin(n*pi/30))*2/3,i},y=(t,n)=>{var i=300+t+2*n+.1*t*t+.1*t*n+.1*Math.sqrt(Math.abs(t));return i+=(20*Math.sin(6*t*pi)+20*Math.sin(2*t*pi))*2/3,i+=(20*Math.sin(t*pi)+40*Math.sin(t/3*pi))*2/3,i+=(150*Math.sin(t/12*pi)+300*Math.sin(t/30*pi))*2/3,i},h=(t,n)=>{var i=c(t-105,n-35),e=y(t-105,n-35),r=n/180*pi,s=Math.sin(r);s=1-ee*s*s;var o=Math.sqrt(s);i=i*180/(a*(1-ee)/(s*o)*pi),e=e*180/(a/o*Math.cos(r)*pi);var l=n+i,m=t+e,d={lng:m,lat:l};return d},M=(t,n)=>{var i=t-.0065,e=n-.006,r=Math.sqrt(i*i+e*e)-2e-5*Math.sin(e*x_pi),s=Math.atan2(e,i)-3e-6*Math.cos(i*x_pi),o=r*Math.cos(s),l=r*Math.sin(s),m={lng:o,lat:l};return m},T=function(t,n){var i=Math.sqrt(t*t+n*n)+2e-5*Math.sin(n*x_pi),e=Math.atan2(n,t)+3e-6*Math.cos(t*x_pi),r=i*Math.cos(e)+.0065,s=i*Math.sin(e)+.006,o={lng:r,lat:s};return o},v=(t,n)=>{var i=c(t-105,n-35),e=y(t-105,n-35),r=n/180*pi,s=Math.sin(r);s=1-ee*s*s;var o=Math.sqrt(s);i=i*180/(a*(1-ee)/(s*o)*pi),e=e*180/(a/o*Math.cos(r)*pi);var l=n+i,m=t+e,d={lng:m,lat:l};return d},u=(t,n)=>{var i=h(t,n),e=t*2-i.lng,r=n*2-i.lat,s={lng:e,lat:r};return s},b=()=>{var t=M(lng,lat),n=u(t.lng,t.lat);return n},g=(t,n)=>{var i=v(t,n),e=T(i.lng,i.lat);return e};function f(t,n){return t.GridLayer.include({_setZoomTransform:function(i,e,r){var s=e;s!=null&&this.options&&(this.options.corrdType=="gcj02"?s=v(e.lng,e.lat):this.options.corrdType=="bd09"&&(s=g(e.lng,e.lat)));var o=this._map.getZoomScale(r,i.zoom),l=i.origin.multiplyBy(o).subtract(this._map._getNewPixelOrigin(s,r)).round();t.Browser.any3d?t.DomUtil.setTransform(i.el,l,o):t.DomUtil.setPosition(i.el,l)},_getTiledPixelBounds:function(i){var e=i;e!=null&&this.options&&(this.options.corrdType=="gcj02"?e=v(i.lng,i.lat):this.options.corrdType=="bd09"&&(e=g(i.lng,i.lat)));var r=this._map,s=r._animatingZoom?Math.max(r._animateToZoom,r.getZoom()):r.getZoom(),o=r.getZoomScale(s,this._tileZoom),l=r.project(e,this._tileZoom).floor(),m=r.getSize().divideBy(o*2);return new t.Bounds(l.subtract(m),l.add(m))}}),t.Proj&&(t.CRS.Baidu=new t.Proj.CRS("EPSG:900913","+proj=merc +a=6378206 +b=6356584.314245179 +lat_ts=0.0 +lon_0=0.0 +x_0=0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs",{resolutions:function(){var i=19,e=[];e[0]=Math.pow(2,18);for(var r=1;r<i;r++)e[r]=Math.pow(2,18-r);return e}(),origin:[0,0],bounds:t.bounds([20037508342789244e-9,0],[0,20037508342789244e-9])})),t.TileLayer.TmsProvider=t.TileLayer.extend({initialize:function(i,e){var r=t.TileLayer.TmsProvider.providers;e=e||{};var s=i.split("."),o=s[0],l=s[1],m=s[2],d=r[o][l][m];e.subdomains=r[o].Subdomains,e.key=e.key||r[o].key,"tms"in r[o]&&(e.tms=r[o].tms),t.TileLayer.prototype.initialize.call(this,d,e)},getTileUrl:function(i){var e={s:this._getSubdomain(i),x:i.x,y:i.y,z:this._getZoomForUrl(),l:n.locale};if(this._map&&!this._map.options.crs.infinite){var r=this._globalTileRange.max.y-i.y;this.options.tms&&(e.y=r),e["-y"]=r}return e.sx=e.x>>4,e.sy=(1<<e.z)-e.y>>4,t.Util.template(this._url,t.Util.extend(e,this.options))}}),t.TileLayer.TmsProvider.providers={TianDiTu:{Normal:{Map:"//t{s}.tianditu.gov.cn/DataServer?T=vec_w&X={x}&Y={y}&L={z}&tk={key}",Annotion:"//t{s}.tianditu.gov.cn/DataServer?T=cva_w&X={x}&Y={y}&L={z}&tk={key}"},Satellite:{Map:"//t{s}.tianditu.gov.cn/DataServer?T=img_w&X={x}&Y={y}&L={z}&tk={key}",Annotion:"//t{s}.tianditu.gov.cn/DataServer?T=cia_w&X={x}&Y={y}&L={z}&tk={key}"},Terrain:{Map:"//t{s}.tianditu.gov.cn/DataServer?T=ter_w&X={x}&Y={y}&L={z}&tk={key}",Annotion:"//t{s}.tianditu.gov.cn/DataServer?T=cta_w&X={x}&Y={y}&L={z}&tk={key}"},Subdomains:["0","1","2","3","4","5","6","7"],key:"174705aebfe31b79b3587279e211cb9a"},GaoDe:{Normal:{Map:"//webrd0{s}.is.autonavi.com/appmaptile?lang={l}&size=1&scale=1&style=8&x={x}&y={y}&z={z}"},Satellite:{Map:"//webst0{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",Annotion:"//webst0{s}.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}"},Subdomains:["1","2","3","4"]},Google:{Normal:{Map:"//www.google.cn/maps/vt?lyrs=m@189&gl=cn&x={x}&y={y}&z={z}"},Satellite:{Map:"//www.google.cn/maps/vt?lyrs=s@189&gl=cn&x={x}&y={y}&z={z}",Annotion:"//www.google.cn/maps/vt?lyrs=y@189&gl=cn&x={x}&y={y}&z={z}"},Subdomains:[]},Geoq:{Normal:{Map:"//map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}",PurplishBlue:"//map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}",Gray:"//map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetGray/MapServer/tile/{z}/{y}/{x}",Warm:"//map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetWarm/MapServer/tile/{z}/{y}/{x}"},Theme:{Hydro:"//thematic.geoq.cn/arcgis/rest/services/ThematicMaps/WorldHydroMap/MapServer/tile/{z}/{y}/{x}"},Subdomains:[]},OSM:{Normal:{Map:"//{s}.tile.osm.org/{z}/{x}/{y}.png"},Subdomains:["a","b","c"]},Baidu:{Normal:{Map:"//online{s}.map.bdimg.com/onlinelabel/?qt=tile&x={x}&y={y}&z={z}&styles=pl&scaler=1&p=1"},Satellite:{Map:"//shangetu{s}.map.bdimg.com/it/u=x={x};y={y};z={z};v=009;type=sate&fm=46",Annotion:"//online{s}.map.bdimg.com/tile/?qt=tile&x={x}&y={y}&z={z}&styles=sl&v=020"},Subdomains:"0123456789",tms:!0},Tencent:{Normal:{Map:"//rt{s}.map.gtimg.com/tile?z={z}&x={x}&y={-y}&type=vector&styleid=3"},Satellite:{Map:"//p{s}.map.gtimg.com/sateTiles/{z}/{sx}/{sy}/{x}_{-y}.jpg"},Terrain:{Map:"//p{s}.map.gtimg.com/demTiles/{z}/{sx}/{sy}/{x}_{-y}.jpg"},Subdomains:"0123"}},t.tileLayer.tmsProvider=function(i,e){return e=e||{},e.corrdType=r(i),new t.TileLayer.TmsProvider(i,e);function r(s){var o=s.split("."),l=o[0],m="wgs84";switch(l){case"Geoq":case"GaoDe":case"Google":m="gcj02";break;case"Baidu":m="bd09";break;case"OSM":case"TianDiTu":m="wgs84";break}return m}},t}p.bd09ToGps84=b,p.gcj02ToGps84=u,p.gps84ToBd09=g,p.gps84ToGcj02=v,p.withTmsProvider=f,Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});
